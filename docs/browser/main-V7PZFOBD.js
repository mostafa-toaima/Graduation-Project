import{a as ve,b as Ce,c as Re,d as Pe,e as _e,f as Ne,g as ke,h as Eh,i as Th,j as Ih,k as bh,l as bt,m as Sh,n as Ah,o as Ch,p as an,q as Rh,r as Ph,s as Nh,t as Jn,u as jh}from"./chunk-PK3IKBOY.js";import{a as kh}from"./chunk-ON7ZB4BZ.js";import{c as eh,d as th,e as nh,f as rh,g as ih,i as sh,k as oh,l as ah,m as en,n as lh,o as ch,p as uh}from"./chunk-DTMYNW3Q.js";import{a as Dh,b as zr,c as xh,d as Oh,g as Mh,j as Fh,k as Lh,o as Vh,q as Uh}from"./chunk-PYYZ3IAR.js";import{D as qh,E as $h,e as Co,k as W,l as St,o as Bh,p as Ro,v as Zn,w as Po,x as Ki}from"./chunk-R6VO5AO4.js";import{$ as Oe,$a as zu,A as vo,Ab as O,Ba as lt,Bb as z,Ca as Eo,Cb as qi,Db as $i,Dc as ji,Fa as Bu,Fb as $n,Gc as Zu,H as Mu,Hb as Te,Ib as Ie,Ic as Gn,K as Fu,Kc as Kn,Lc as Wn,N as Lu,Q as Vu,R as wo,Rb as V,Sb as Lr,Tb as Vr,U as J,Ua as qu,Vb as Wu,W as Mt,Wa as $u,Wb as Hu,Xa as re,Xb as Qu,Yb as Yu,Z as we,Zb as Ur,_a as ju,aa as Ft,ba as K,ca as Ee,dc as jn,ec as zn,gb as Zt,ia as Lt,ja as Vt,kb as vt,kc as Xu,o as Fr,oa as me,pb as Gu,qb as ge,s as yo,sa as Uu,sb as qn,ta as ce,tb as Ku,u as Ou,xc as Ju,zb as D}from"./chunk-C2UJ27Q3.js";import{a as zh}from"./chunk-ZT4VD254.js";import{$ as $e,A as mh,B as gh,C as Tt,D as yn,E as So,F as qr,G as rn,H as _h,K as yh,M as vh,N as wh,O as $r,P as jr,Q as ye,R as Se,S as sn,T as It,U as Ao,V as Gi,W as Ae,X as Me,Y as Ut,Z as on,a as k,b as Hn,ba as B,c as hh,d as dh,f as fh,i as tn,k as To,l as Qn,n as Io,p as bo,q as ph,s as wt,t as nn,u as Yn,v as Br,w as Et,x as Xn,y as zi,z as be}from"./chunk-7E5E4JX3.js";import{a as Ot,b as _o,c as xu,e as x}from"./chunk-ACKELEN3.js";var Wi=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Zt({type:n,selectors:[["common-footer"]],decls:86,vars:0,consts:[[1,"site-footer"],[1,"footer-container"],[1,"footer-grid"],[1,"footer-column"],[1,"footer-logo"],["src","assets/images/career-goals.png","width","40","alt","CareerPath Logo"],[1,"footer-about"],[1,"footer-newsletter"],[1,"newsletter-form"],["type","email","placeholder","Your email address"],["type","submit"],[1,"pi","pi-send"],[1,"footer-title"],[1,"footer-links"],["routerLink","/home"],["routerLink","/features"],["routerLink","/select-university"],["routerLink","/career-path"],["routerLink","/roadmap"],["href","#"],[1,"footer-social"],["href","#","aria-label","Facebook",1,"social-icon"],[1,"pi","pi-facebook"],["href","#","aria-label","Twitter",1,"social-icon"],[1,"pi","pi-twitter"],["href","#","aria-label","LinkedIn",1,"social-icon"],[1,"pi","pi-linkedin"],["href","#","aria-label","Instagram",1,"social-icon"],[1,"pi","pi-instagram"],["href","#","aria-label","GitHub",1,"social-icon"],[1,"pi","pi-github"],[1,"footer-contact"],[1,"pi","pi-envelope"],[1,"pi","pi-phone"],[1,"footer-bottom"],[1,"footer-legal"],[1,"footer-copyright"]],template:function(t,r){t&1&&(D(0,"footer",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),z(5,"img",5),D(6,"span"),V(7,"CareerPath"),O()(),D(8,"p",6),V(9," Empowering your journey to becoming a world-class developer through structured learning paths and real-world projects. "),O(),D(10,"div",7)(11,"h4"),V(12,"Stay Updated"),O(),D(13,"div",8),z(14,"input",9),D(15,"button",10),z(16,"i",11),O()()()(),D(17,"div",3)(18,"h3",12),V(19,"Quick Links"),O(),D(20,"ul",13)(21,"li")(22,"a",14),V(23,"Home"),O()(),D(24,"li")(25,"a",15),V(26,"Features"),O()(),D(27,"li")(28,"a",16),V(29,"Build Career"),O()(),D(30,"li")(31,"a",17),V(32,"Career Path"),O()(),D(33,"li")(34,"a",18),V(35,"Roadmap"),O()()()(),D(36,"div",3)(37,"h3",12),V(38,"Resources"),O(),D(39,"ul",13)(40,"li")(41,"a",19),V(42,"Documentation"),O()(),D(43,"li")(44,"a",19),V(45,"Tutorials"),O()(),D(46,"li")(47,"a",19),V(48,"Blog"),O()(),D(49,"li")(50,"a",19),V(51,"FAQ"),O()(),D(52,"li")(53,"a",19),V(54,"Support"),O()()()(),D(55,"div",3)(56,"h3",12),V(57,"Connect With Us"),O(),D(58,"div",20)(59,"a",21),z(60,"i",22),O(),D(61,"a",23),z(62,"i",24),O(),D(63,"a",25),z(64,"i",26),O(),D(65,"a",27),z(66,"i",28),O(),D(67,"a",29),z(68,"i",30),O()(),D(69,"div",31)(70,"p"),z(71,"i",32),V(72," mtoaima@bis.com"),O(),D(73,"p"),z(74,"i",33),V(75," +20 111 084 4808"),O()()()(),D(76,"div",34)(77,"div",35)(78,"a",19),V(79,"Privacy Policy"),O(),D(80,"a",19),V(81,"Terms of Service"),O(),D(82,"a",19),V(83,"Cookie Policy"),O()(),D(84,"div",36),V(85," \xA9 2025 CareerPath. All rights reserved. "),O()()()())},styles:['.site-footer[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1a365d,#15325a);color:#fff;padding:4rem 0 0;position:relative;font-family:Inter,sans-serif}.footer-container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:0 2rem}.footer-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:3rem;margin-bottom:3rem}.footer-column[_ngcontent-%COMP%]{padding:0 1rem}.footer-logo[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:1.5rem}.footer-logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-right:.75rem}.footer-logo[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;background:linear-gradient(90deg,#4361ee,#3a0ca3);-webkit-background-clip:text;background-clip:text;color:transparent}.footer-about[_ngcontent-%COMP%]{color:#fffc;line-height:1.6;margin-bottom:2rem}.footer-newsletter[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:1.1rem;margin-bottom:1rem;color:#fff}.newsletter-form[_ngcontent-%COMP%]{display:flex;border-radius:8px;overflow:hidden;box-shadow:0 4px 6px #0000001a}.newsletter-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;padding:.75rem 1rem;border:none;font-size:1rem;background:#ffffffe6}.newsletter-form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:#4361ee;color:#fff;border:none;padding:0 1.25rem;cursor:pointer;transition:all .3s ease}.newsletter-form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#3a56d4}.footer-title[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600;margin-bottom:1.5rem;position:relative;padding-bottom:.75rem;color:#fff}.footer-title[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:0;left:0;width:50px;height:3px;background:#4361ee;border-radius:3px}.footer-links[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.footer-links[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:.75rem}.footer-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fffc;text-decoration:none;transition:all .3s ease;display:inline-block;position:relative}.footer-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#fff;transform:translate(5px)}.footer-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:before{content:"";position:absolute;width:0;height:2px;bottom:-2px;left:0;background:#4361ee;transition:width .3s ease}.footer-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:before{width:100%}.footer-social[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-bottom:2rem}.social-icon[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;background:#ffffff1a;display:flex;align-items:center;justify-content:center;color:#fff;font-size:1.1rem;transition:all .3s ease}.social-icon[_ngcontent-%COMP%]:hover{background:#4361ee;transform:translateY(-3px)}.footer-contact[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{display:flex;align-items:center;color:#fffc;margin-bottom:.75rem}.footer-contact[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:.75rem;color:#4361ee}.footer-bottom[_ngcontent-%COMP%]{border-top:1px solid rgba(255,255,255,.1);padding:1.5rem 0;display:flex;flex-wrap:wrap;justify-content:space-between;align-items:center}.footer-legal[_ngcontent-%COMP%]{display:flex;gap:1.5rem}.footer-legal[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#ffffffb3;text-decoration:none;font-size:.9rem;transition:color .3s ease}.footer-legal[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#fff}.footer-copyright[_ngcontent-%COMP%]{color:#ffffffb3;font-size:.9rem}@media (max-width: 768px){.footer-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:2rem}.footer-bottom[_ngcontent-%COMP%]{flex-direction:column;gap:1rem;text-align:center}.footer-legal[_ngcontent-%COMP%]{justify-content:center}}']})};var n_=()=>({width:"30rem"}),r_=()=>({"960px":"75vw","640px":"90vw"});function i_(n,e){if(n&1&&(D(0,"div",29),V(1),O()),n&2){let t=Ie();re(),Lr(t.emailError)}}function s_(n,e){if(n&1&&(D(0,"div",29),V(1),O()),n&2){let t=Ie();re(),Lr(t.passwordError)}}function o_(n,e){if(n&1&&(D(0,"div",30),z(1,"i",31),V(2),O()),n&2){let t=Ie();re(2),Vr("",t.loginError," ")}}var Hi=class n{visible=!1;registerSuccess=!1;visibleChange=new Uu;messageService=Ft(Co);fb=Ft(Vh);router=Ft(en);authService=Ft(Jn);loginError="";loginForm=this.fb.group({email:["",[zr.required,zr.email]],password:["",[zr.required,zr.minLength(6)]]});onSubmit(){this.loginForm.valid?this.authService.login(this.loginForm.value.email,this.loginForm.value.password).subscribe({next:e=>{console.log("Login successful",this.loginForm.value,e),this.router.navigate(["/features"]),this.closeDialog()},error:e=>{console.error("Login error:",e),this.loginError=e?.message||"Invalid email or password."}}):this.loginForm.markAllAsTouched()}showDialog(){this.visible=!0}closeDialog(){this.visible=!1,this.visibleChange.emit(!1),this.loginError=""}get emailError(){let e=this.loginForm.get("email");return e?.hasError("required")&&e?.touched?"Email is required.":e?.hasError("email")&&e?.touched?"Invalid email address.":""}get passwordError(){let e=this.loginForm.get("password");return e?.hasError("required")&&e?.touched?"Password is required.":e?.hasError("minlength")&&e?.touched?"Password must be at least 6 characters long.":""}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Zt({type:n,selectors:[["login"]],inputs:{visible:"visible",registerSuccess:"registerSuccess"},outputs:{visibleChange:"visibleChange"},features:[Yu([Co])],decls:40,vars:11,consts:[["header","Welcome Back",3,"visibleChange","onHide","modal","visible","breakpoints"],[1,"dialog-container"],[1,"dialog-content"],[3,"ngSubmit","formGroup"],[1,"form-group","my-2"],["for","email"],[1,"input-wrapper"],[1,"pi","pi-envelope","input-icon"],["type","email","formControlName","email","id","email","placeholder","your@email.com",1,"form-control","input-field"],["class","error-message",4,"ngIf"],["for","password"],[1,"pi","pi-lock","input-icon"],["type","password","formControlName","password","id","password","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",1,"form-control","input-field"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[1,"form-check"],["type","checkbox","id","rememberMe",1,"form-check-input"],["for","rememberMe",1,"form-check-label"],["type","button","disabled","","title","comming soon..",2,"pointer-events","none","cursor","not-allowed","opacity","0.5","color","#6b7280","background-color","#e5e7eb","border-color","#e5e7eb"],["href","#","title","Coming soon",1,"forgot-password"],["class","error-banner",4,"ngIf"],["type","submit",1,"btn","btn-primary","w-100","mb-3"],[1,"pi","pi-sign-in","me-2"],[1,"social-login"],[1,"divider"],[1,"social-buttons"],["type","button","disabled","","title","comming soon..",1,"btn","btn-google"],["disabled","",1,"pi","pi-google","me-2"],["type","button","disabled","","title","comming soon..",1,"btn","btn-facebook"],[1,"pi","pi-facebook","me-2"],[1,"error-message"],[1,"error-banner"],[1,"pi","pi-exclamation-triangle","me-2"]],template:function(t,r){t&1&&(D(0,"p-dialog",0),Qu("visibleChange",function(o){return Hu(r.visible,o)||(r.visible=o),o}),Te("onHide",function(){return r.closeDialog()}),D(1,"div",1)(2,"div",2)(3,"form",3),Te("ngSubmit",function(){return r.onSubmit()}),D(4,"div",4)(5,"label",5),V(6,"Email Address"),O(),D(7,"div",6),z(8,"i",7)(9,"input",8),O(),vt(10,i_,2,1,"div",9),O(),D(11,"div",4)(12,"label",10),V(13,"Password"),O(),D(14,"div",6),z(15,"i",11)(16,"input",12),O(),vt(17,s_,2,1,"div",9),O(),D(18,"div",13)(19,"div",14),z(20,"input",15),D(21,"label",16),V(22,"Remember me"),O()(),D(23,"button",17)(24,"a",18),V(25,"Forgot password?"),O()()(),vt(26,o_,3,1,"div",19),D(27,"button",20),z(28,"i",21),V(29,"Login "),O(),D(30,"div",22)(31,"p",23),V(32,"or continue with"),O(),D(33,"div",24)(34,"button",25),z(35,"i",26),V(36,"Google "),O(),D(37,"button",27),z(38,"i",28),V(39,"Facebook "),O()()()()()()()),t&2&&(Ku(Ur(9,n_)),ge("modal",!0),Wu("visible",r.visible),ge("breakpoints",Ur(10,r_)),re(3),ge("formGroup",r.loginForm),re(7),ge("ngIf",r.emailError),re(7),ge("ngIf",r.passwordError),re(9),ge("ngIf",r.loginError))},dependencies:[Gn,ji,Uh,Mh,Dh,xh,Oh,Fh,Lh,$h,qh],styles:['.p-dialog{border-radius:16px!important;box-shadow:0 10px 50px #0003!important;border:none!important;overflow:hidden}  .p-dialog-header{background:linear-gradient(135deg,#4361ee,#3a0ca3)!important;color:#fff!important;padding:1.5rem!important;border-bottom:none!important}  .p-dialog-title{font-weight:600;font-size:1.5rem}  .p-dialog-content{padding:0!important;background:#f8f9fa!important}.dialog-container[_ngcontent-%COMP%]{padding:2rem}.dialog-content[_ngcontent-%COMP%]{max-width:100%}.section-title[_ngcontent-%COMP%]{color:#4361ee;font-weight:600;margin-bottom:1.5rem;padding-bottom:.5rem;border-bottom:2px solid #e9ecef}.input-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}.input-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-weight:500;color:#495057}.input-wrapper[_ngcontent-%COMP%]{position:relative}.input-icon[_ngcontent-%COMP%]{position:absolute;left:1rem;top:50%;transform:translateY(-50%);color:#6c757d}.input-field[_ngcontent-%COMP%], .select-field[_ngcontent-%COMP%]{width:100%;padding:.75rem 1rem .75rem 3rem;border:1px solid #ced4da;border-radius:8px;font-size:1rem;transition:all .3s ease;background-color:#fff}.input-field[_ngcontent-%COMP%]:focus, .select-field[_ngcontent-%COMP%]:focus{border-color:#4361ee;box-shadow:0 0 0 .2rem #4361ee33;outline:none}.gender-options[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-top:.5rem}.gender-option[_ngcontent-%COMP%]{display:flex;align-items:center;cursor:pointer}.gender-option[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-right:.5rem}.gender-label[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.5rem 1rem;border-radius:8px;background:#e9ecef;transition:all .3s ease}.gender-option[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .gender-label[_ngcontent-%COMP%]{background:#4361ee;color:#fff}.btn[_ngcontent-%COMP%]{padding:.75rem 1.5rem;border-radius:8px;font-weight:500;transition:all .3s ease;display:inline-flex;align-items:center;justify-content:center}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4361ee,#3a0ca3);border:none;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#3a56d4,#2e0a8a);transform:translateY(-2px);box-shadow:0 4px 12px #4361ee4d}.btn-outline-secondary[_ngcontent-%COMP%]{border:1px solid #6c757d;color:#6c757d;background:transparent}.btn-outline-secondary[_ngcontent-%COMP%]:hover{background:#6c757d;color:#fff}.social-login[_ngcontent-%COMP%]{margin:1.5rem 0}.divider[_ngcontent-%COMP%]{display:flex;align-items:center;color:#6c757d;margin:1rem 0}.divider[_ngcontent-%COMP%]:before, .divider[_ngcontent-%COMP%]:after{content:"";flex:1;border-bottom:1px solid #dee2e6}.divider[_ngcontent-%COMP%]:before{margin-right:1rem}.divider[_ngcontent-%COMP%]:after{margin-left:1rem}.social-buttons[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-top:1rem}.btn-google[_ngcontent-%COMP%]{background:#db4437;color:#fff;flex:1}.btn-facebook[_ngcontent-%COMP%]{background:#4267b2;color:#fff;flex:1}.signup-link[_ngcontent-%COMP%], .login-link[_ngcontent-%COMP%], .forgot-password[_ngcontent-%COMP%], .terms-link[_ngcontent-%COMP%]{color:#4361ee;text-decoration:none;font-weight:500;transition:all .2s ease}.signup-link[_ngcontent-%COMP%]:hover, .login-link[_ngcontent-%COMP%]:hover, .forgot-password[_ngcontent-%COMP%]:hover, .terms-link[_ngcontent-%COMP%]:hover{color:#3a0ca3;text-decoration:underline}.error-message[_ngcontent-%COMP%]{color:#dc3545;font-size:.875rem;margin-top:.25rem}.error-banner[_ngcontent-%COMP%]{background-color:#dc35451a;color:#dc3545;padding:.75rem 1rem;border-radius:8px;margin:1rem 0;display:flex;align-items:center}.terms-check[_ngcontent-%COMP%]{margin:1.5rem 0}@media (max-width: 768px){.dialog-container[_ngcontent-%COMP%]{padding:1.5rem}.section-title[_ngcontent-%COMP%]{margin-top:1.5rem}.social-buttons[_ngcontent-%COMP%]{flex-direction:column}}']})};var a_=()=>({exact:!0});function l_(n,e){if(n&1){let t=$n();qi(0),D(1,"li",8)(2,"a",18),Te("click",function(){Lt(t);let i=Ie();return Vt(i.closeMobileMenu())}),z(3,"i",19),V(4," Career Path "),O()(),D(5,"li",8)(6,"a",20),Te("click",function(){Lt(t);let i=Ie();return Vt(i.closeMobileMenu())}),z(7,"i",21),V(8," Roadmap "),O()(),$i()}}function c_(n,e){if(n&1){let t=$n();qi(0),D(1,"div",22)(2,"button",23),Te("click",function(){Lt(t);let i=Ie();return Vt(i.openLogin())}),z(3,"i",24),V(4," Login "),O(),D(5,"button",25),Te("click",function(){Lt(t);let i=Ie();return Vt(i.openSignUp())}),z(6,"i",26),V(7," Sign Up "),O()(),$i()}}function u_(n,e){if(n&1&&z(0,"img",40),n&2){let t=Ie().ngIf;ge("src",t.photoURL,qu)}}function h_(n,e){if(n&1&&(D(0,"span",41),V(1),O()),n&2){let t=Ie().ngIf;re(),Vr(" ",(t.displayName==null?null:t.displayName.charAt(0))||(t.email==null?null:t.email.charAt(0))," ")}}function d_(n,e){if(n&1){let t=$n();qi(0),D(1,"div",27)(2,"button",28),Te("click",function(){Lt(t);let i=Ie();return Vt(i.toggleUserDropdown())}),D(3,"span",29),vt(4,u_,1,1,"img",30)(5,h_,2,1,"span",31),O(),V(6),O(),D(7,"ul",32)(8,"li")(9,"h6",33),V(10),O()(),D(11,"li"),z(12,"hr",34),O(),D(13,"li")(14,"a",35),z(15,"i",36),V(16," Profile "),O()(),D(17,"li")(18,"a",35),z(19,"i",37),V(20," Settings "),O()(),D(21,"li"),z(22,"hr",34),O(),D(23,"li")(24,"a",38),Te("click",function(){Lt(t);let i=Ie();return Vt(i.logout())}),z(25,"i",39),V(26," Logout "),O()()()(),$i()}if(n&2){let t=e.ngIf,r=Ie();re(4),ge("ngIf",t.photoURL),re(),ge("ngIf",!t.photoURL),re(),Vr(" ",t.displayName||"Account"," "),re(),qn("show",r.showUserDropdown),re(3),Lr(t.email)}}function f_(n,e){if(n&1){let t=$n();D(0,"login",42),Te("visibleChange",function(i){Lt(t);let o=Ie();return Vt(o.showLogin=i)}),O()}if(n&2){let t=Ie();ge("visible",t.showLogin)}}function p_(n,e){if(n&1){let t=$n();D(0,"sign-up",42),Te("visibleChange",function(i){Lt(t);let o=Ie();return Vt(o.showSignUp=i)}),O()}if(n&2){let t=Ie();ge("visible",t.showSignUp)}}var Qi=class n{mobileMenuOpen=!1;showUserDropdown=!1;showLogin=!1;showSignUp=!1;authService=Ft(Jn);router=Ft(en);universityService=Ft(kh);user$=this.authService.user$;selectedUniversity$=this.universityService.selectedUniversity$;ngOnInit(){}toggleMobileMenu(){this.mobileMenuOpen=!this.mobileMenuOpen,this.toggleBodyOverflow()}closeMobileMenu(){this.mobileMenuOpen=!1,this.toggleBodyOverflow()}toggleUserDropdown(){this.showUserDropdown=!this.showUserDropdown}openLogin(){this.showLogin=!0,this.closeMobileMenu()}openSignUp(){this.showSignUp=!0,this.closeMobileMenu()}handleNavigationClick(e){this.user$.subscribe(t=>{t?this.router.navigate([e]):this.openLogin()})}logout(){this.authService.logout().subscribe(()=>{this.router.navigate(["/home"]),this.showUserDropdown=!1})}toggleBodyOverflow(){document.body.style.overflow=this.mobileMenuOpen?"hidden":""}onResize(){window.innerWidth>991.98&&this.mobileMenuOpen&&this.closeMobileMenu()}ngOnDestroy(){document.body.style.overflow=""}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Zt({type:n,selectors:[["app-navbar"]],hostBindings:function(t,r){t&1&&Te("resize",function(o){return r.onResize(o)},!1,$u)},decls:34,vars:28,consts:[[1,"navbar","navbar-expand-lg","navbar-light","bg-glass","shadow-sm","fixed-top"],[1,"container"],["routerLink","/home",1,"navbar-brand","d-flex","footer-logo"],["src","assets/images/career-goals.png","width","40","alt","CareerPath Logo"],["type","button","aria-label","Toggle navigation",1,"navbar-toggler",3,"click"],[1,"navbar-toggler-icon"],[1,"collapse","navbar-collapse"],[1,"navbar-nav","me-auto","mb-2","mb-lg-0"],[1,"nav-item"],["routerLink","/home","routerLinkActive","active",1,"nav-link",3,"click","routerLinkActiveOptions"],[1,"fas","fa-home","me-1"],["routerLinkActive","active",1,"nav-link",3,"click","routerLink"],[1,"fas","fa-star","me-1"],[1,"fas","fa-briefcase","me-1"],[4,"ngIf"],[1,"d-flex","align-items-center"],[1,"mobile-menu-overlay",3,"click"],[3,"visible","visibleChange",4,"ngIf"],["routerLink","/career-path","routerLinkActive","active",1,"nav-link",3,"click"],[1,"fas","fa-project-diagram","me-1"],["routerLink","/roadmap","routerLinkActive","active",1,"nav-link",3,"click"],[1,"fas","fa-map-marked-alt","me-1"],[1,"d-flex","align-items-center","logining","gap-lg-3"],[1,"btn","btn-outline-primary","w-30",3,"click"],[1,"fas","fa-sign-in-alt","me-1"],[1,"btn","btn-primary","w-70",3,"click"],[1,"fas","fa-user-plus","me-1"],[1,"dropdown"],["type","button","id","userDropdown","data-bs-toggle","dropdown","aria-expanded","false",1,"btn","dropdown-toggle","user-dropdown-toggle",3,"click"],[1,"user-avatar","me-1"],["class","rounded-circle","width","32","height","32","alt","User",3,"src",4,"ngIf"],["class","avatar-fallback rounded-circle",4,"ngIf"],[1,"dropdown-menu","dropdown-menu-end"],[1,"dropdown-header"],[1,"dropdown-divider"],["href","#",1,"dropdown-item"],[1,"fas","fa-user-circle","me-2"],[1,"fas","fa-cog","me-2"],["type","button",1,"dropdown-item","text-danger",3,"click"],[1,"fas","fa-sign-out-alt","me-2"],["width","32","height","32","alt","User",1,"rounded-circle",3,"src"],[1,"avatar-fallback","rounded-circle"],[3,"visibleChange","visible"]],template:function(t,r){t&1&&(D(0,"nav",0)(1,"div",1)(2,"a",2),z(3,"img",3),D(4,"span"),V(5,"CareerPath"),O()(),D(6,"button",4),Te("click",function(){return r.toggleMobileMenu()}),z(7,"span",5),O(),D(8,"div",6)(9,"ul",7)(10,"li",8)(11,"a",9),Te("click",function(){return r.closeMobileMenu()}),z(12,"i",10),V(13," Home "),O()(),D(14,"li",8)(15,"a",11),jn(16,"async"),Te("click",function(){return r.handleNavigationClick("/features")}),z(17,"i",12),V(18," Features "),O()(),D(19,"li",8)(20,"a",11),jn(21,"async"),Te("click",function(){return r.handleNavigationClick("/select-university")}),z(22,"i",13),V(23," Build Career "),O()(),vt(24,l_,9,0,"ng-container",14),jn(25,"async"),O(),D(26,"div",15),vt(27,c_,8,0,"ng-container",14),jn(28,"async"),vt(29,d_,27,6,"ng-container",14),jn(30,"async"),O()()()(),D(31,"div",16),Te("click",function(){return r.closeMobileMenu()}),O(),vt(32,f_,1,1,"login",17)(33,p_,1,1,"sign-up",17)),t&2&&(re(6),Gu("aria-expanded",r.mobileMenuOpen),re(2),qn("show",r.mobileMenuOpen),re(3),ge("routerLinkActiveOptions",Ur(27,a_)),re(4),qn("logged-in",zn(16,17,r.user$)),ge("routerLink","/features"),re(5),qn("logged-in",zn(21,19,r.user$)),ge("routerLink","/select-university"),re(4),ge("ngIf",zn(25,21,r.selectedUniversity$)),re(3),ge("ngIf",!zn(28,23,r.user$)),re(2),ge("ngIf",zn(30,25,r.user$)),re(2),qn("active",r.mobileMenuOpen),re(),ge("ngIf",r.showLogin),re(),ge("ngIf",r.showSignUp))},dependencies:[Gn,ji,Zu,lh,jh,Hi,ch],styles:['.bg-glass[_ngcontent-%COMP%]{background:#ffffffe6!important;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);border-bottom:1px solid rgba(255,255,255,.3)}.navbar-light[_ngcontent-%COMP%]   .navbar-brand[_ngcontent-%COMP%], .navbar-light[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{color:#000000d9!important}.navbar-light[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]{color:#4361ee!important;font-weight:600}.brand-text[_ngcontent-%COMP%]{background:linear-gradient(90deg,#4361ee,var(--primary-dark));-webkit-background-clip:text;background-clip:text;color:transparent}.nav-link[_ngcontent-%COMP%]{position:relative;margin:0 .5rem;transition:all .3s ease}.nav-link[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:-3px;left:0;width:0;height:2px;background:#4361ee;transition:width .3s ease}.nav-link[_ngcontent-%COMP%]:hover:after, .nav-link.active[_ngcontent-%COMP%]:after{width:100%}.user-dropdown-toggle[_ngcontent-%COMP%]{border:1px solid rgba(0,0,0,.1);padding:.375rem .75rem}.dropdown-menu[_ngcontent-%COMP%]{border:none;box-shadow:0 5px 20px #0000001a;margin-top:.5rem}@media (max-width: 991.98px){.navbar-collapse[_ngcontent-%COMP%]{position:fixed;top:0;left:-100%;bottom:0;width:80%;max-width:232px;padding-top:3.5rem;padding-left:2.5rem;padding-right:1.5rem;background:#fff;z-index:1046;overflow-y:auto;transition:all .4s cubic-bezier(.4,0,.2,1);height:100vh}.navbar-collapse.show[_ngcontent-%COMP%]{left:0;box-shadow:5px 0 30px #00000026}.nav-link[_ngcontent-%COMP%]{padding:.75rem 0;margin:.25rem 0}.logining[_ngcontent-%COMP%]{flex-direction:column;gap:1rem;width:100%}.logining[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%!important}}.mobile-menu-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);z-index:1029;opacity:0;visibility:hidden;transition:all .3s ease}.mobile-menu-overlay.active[_ngcontent-%COMP%]{opacity:1;visibility:visible}.btn-outline-primary[_ngcontent-%COMP%]{border-color:#4361ee;color:#4361ee}.btn-outline-primary[_ngcontent-%COMP%]:hover{background:#4361ee;color:#fff}.btn-primary[_ngcontent-%COMP%]{background:#4361ee;border-color:#4361ee}.btn-primary[_ngcontent-%COMP%]:hover{background:var(--primary-dark);border-color:var(--primary-dark)}.footer-logo[_ngcontent-%COMP%]{display:flex;align-items:center}.footer-logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-right:.75rem}.footer-logo[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;background:linear-gradient(90deg,#4361ee,#3a0ca3);-webkit-background-clip:text;background-clip:text;color:transparent}']})};var Yi=class n{title="career-path-project";static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Zt({type:n,selectors:[["app-root"]],decls:4,vars:0,consts:[[1,"parent","container-fluid"]],template:function(t,r){t&1&&(z(0,"app-navbar"),D(1,"div",0),z(2,"router-outlet"),O(),z(3,"common-footer"))},dependencies:[oh,Gn,Wi,Qi],encapsulation:2})};var wn=class n{constructor(e,t){this.authService=e;this.router=t}canActivate(){return this.authService.isLoggedIn()?!0:(this.router.navigate(["/home"]),!1)}static \u0275fac=function(t){return new(t||n)(Oe(Jn),Oe(en))};static \u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"})};var Gh=[{path:"",redirectTo:"home",pathMatch:"full"},{path:"home",loadComponent:()=>import("./chunk-TZ7PSEHH.js").then(n=>n.HomeComponent)},{path:"select-university",loadComponent:()=>import("./chunk-DA6D4X6R.js").then(n=>n.SelectUniversityComponent),canActivate:[wn]},{path:"features",loadComponent:()=>import("./chunk-7QJK2YIR.js").then(n=>n.FeaturesComponent),canActivate:[wn]},{path:"career-path",loadComponent:()=>import("./chunk-MZ3KU3CF.js").then(n=>n.CarerComponent),canActivate:[wn]},{path:"roadmap",loadComponent:()=>import("./chunk-NN2TE7WR.js").then(n=>n.RoadmapComponent),canActivate:[wn]}];function Kh(n){return new J(3e3,!1)}function g_(){return new J(3100,!1)}function __(){return new J(3101,!1)}function y_(n){return new J(3001,!1)}function v_(n){return new J(3003,!1)}function w_(n){return new J(3004,!1)}function E_(n,e){return new J(3005,!1)}function T_(){return new J(3006,!1)}function I_(){return new J(3007,!1)}function b_(n,e){return new J(3008,!1)}function S_(n){return new J(3002,!1)}function A_(n,e,t,r,i){return new J(3010,!1)}function C_(){return new J(3011,!1)}function R_(){return new J(3012,!1)}function P_(){return new J(3200,!1)}function N_(){return new J(3202,!1)}function k_(){return new J(3013,!1)}function D_(n){return new J(3014,!1)}function x_(n){return new J(3015,!1)}function O_(n){return new J(3016,!1)}function M_(n,e){return new J(3404,!1)}function F_(n){return new J(3502,!1)}function L_(n){return new J(3503,!1)}function V_(){return new J(3300,!1)}function U_(n){return new J(3504,!1)}function B_(n){return new J(3301,!1)}function q_(n,e){return new J(3302,!1)}function $_(n){return new J(3303,!1)}function j_(n,e){return new J(3400,!1)}function z_(n){return new J(3401,!1)}function G_(n){return new J(3402,!1)}function K_(n,e){return new J(3505,!1)}function ln(n){switch(n.length){case 0:return new Zn;case 1:return n[0];default:return new Po(n)}}function od(n,e,t=new Map,r=new Map){let i=[],o=[],a=-1,l=null;if(e.forEach(h=>{let d=h.get("offset"),m=d==a,g=m&&l||new Map;h.forEach((T,C)=>{let A=C,R=T;if(C!=="offset")switch(A=n.normalizePropertyName(A,i),R){case Ki:R=t.get(C);break;case St:R=r.get(C);break;default:R=n.normalizeStyleValue(C,A,R,i);break}g.set(A,R)}),m||o.push(g),l=g,a=d}),i.length)throw F_(i);return o}function Jo(n,e,t,r){switch(e){case"start":n.onStart(()=>r(t&&ko(t,"start",n)));break;case"done":n.onDone(()=>r(t&&ko(t,"done",n)));break;case"destroy":n.onDestroy(()=>r(t&&ko(t,"destroy",n)));break}}function ko(n,e,t){let r=t.totalTime,i=!!t.disabled,o=Zo(n.element,n.triggerName,n.fromState,n.toState,e||n.phaseName,r??n.totalTime,i),a=n._data;return a!=null&&(o._data=a),o}function Zo(n,e,t,r,i="",o=0,a){return{element:n,triggerName:e,fromState:t,toState:r,phaseName:i,totalTime:o,disabled:!!a}}function rt(n,e,t){let r=n.get(e);return r||n.set(e,r=t),r}function Wh(n){let e=n.indexOf(":"),t=n.substring(1,e),r=n.slice(e+1);return[t,r]}var W_=typeof document>"u"?null:document.documentElement;function ea(n){let e=n.parentNode||n.host||null;return e===W_?null:e}function H_(n){return n.substring(1,6)=="ebkit"}var En=null,Hh=!1;function Q_(n){En||(En=Y_()||{},Hh=En.style?"WebkitAppearance"in En.style:!1);let e=!0;return En.style&&!H_(n)&&(e=n in En.style,!e&&Hh&&(e="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in En.style)),e}function Y_(){return typeof document<"u"?document.body:null}function ad(n,e){for(;e;){if(e===n)return!0;e=ea(e)}return!1}function ld(n,e,t){if(t)return Array.from(n.querySelectorAll(e));let r=n.querySelector(e);return r?[r]:[]}var ta=(()=>{class n{validateStyleProperty(t){return Q_(t)}containsElement(t,r){return ad(t,r)}getParentElement(t){return ea(t)}query(t,r,i){return ld(t,r,i)}computeStyle(t,r,i){return i||""}animate(t,r,i,o,a,l=[],h){return new Zn(i,o)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Mt({token:n,factory:n.\u0275fac})}return n})(),bn=class{static NOOP=new ta},Sn=class{};var X_=1e3,cd="{{",J_="}}",ud="ng-enter",Lo="ng-leave",Xi="ng-trigger",ns=".ng-trigger",Qh="ng-animating",Vo=".ng-animating";function Bt(n){if(typeof n=="number")return n;let e=n.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:Uo(parseFloat(e[1]),e[2])}function Uo(n,e){switch(e){case"s":return n*X_;default:return n}}function rs(n,e,t){return n.hasOwnProperty("duration")?n:Z_(n,e,t)}function Z_(n,e,t){let r=/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i,i,o=0,a="";if(typeof n=="string"){let l=n.match(r);if(l===null)return e.push(Kh(n)),{duration:0,delay:0,easing:""};i=Uo(parseFloat(l[1]),l[2]);let h=l[3];h!=null&&(o=Uo(parseFloat(h),l[4]));let d=l[5];d&&(a=d)}else i=n;if(!t){let l=!1,h=e.length;i<0&&(e.push(g_()),l=!0),o<0&&(e.push(__()),l=!0),l&&e.splice(h,0,Kh(n))}return{duration:i,delay:o,easing:a}}function ey(n){return n.length?n[0]instanceof Map?n:n.map(e=>new Map(Object.entries(e))):[]}function At(n,e,t){e.forEach((r,i)=>{let o=na(i);t&&!t.has(i)&&t.set(i,n.style[o]),n.style[o]=r})}function In(n,e){e.forEach((t,r)=>{let i=na(r);n.style[i]=""})}function Gr(n){return Array.isArray(n)?n.length==1?n[0]:Bh(n):n}function ty(n,e,t){let r=e.params||{},i=hd(n);i.length&&i.forEach(o=>{r.hasOwnProperty(o)||t.push(y_(o))})}var Bo=new RegExp(`${cd}\\s*(.+?)\\s*${J_}`,"g");function hd(n){let e=[];if(typeof n=="string"){let t;for(;t=Bo.exec(n);)e.push(t[1]);Bo.lastIndex=0}return e}function Wr(n,e,t){let r=`${n}`,i=r.replace(Bo,(o,a)=>{let l=e[a];return l==null&&(t.push(v_(a)),l=""),l.toString()});return i==r?n:i}var ny=/-+([a-z0-9])/g;function na(n){return n.replace(ny,(...e)=>e[1].toUpperCase())}function ry(n,e){return n===0||e===0}function iy(n,e,t){if(t.size&&e.length){let r=e[0],i=[];if(t.forEach((o,a)=>{r.has(a)||i.push(a),r.set(a,o)}),i.length)for(let o=1;o<e.length;o++){let a=e[o];i.forEach(l=>a.set(l,ra(n,l)))}}return e}function nt(n,e,t){switch(e.type){case W.Trigger:return n.visitTrigger(e,t);case W.State:return n.visitState(e,t);case W.Transition:return n.visitTransition(e,t);case W.Sequence:return n.visitSequence(e,t);case W.Group:return n.visitGroup(e,t);case W.Animate:return n.visitAnimate(e,t);case W.Keyframes:return n.visitKeyframes(e,t);case W.Style:return n.visitStyle(e,t);case W.Reference:return n.visitReference(e,t);case W.AnimateChild:return n.visitAnimateChild(e,t);case W.AnimateRef:return n.visitAnimateRef(e,t);case W.Query:return n.visitQuery(e,t);case W.Stagger:return n.visitStagger(e,t);default:throw w_(e.type)}}function ra(n,e){return window.getComputedStyle(n)[e]}var sy=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]),is=class extends Sn{normalizePropertyName(e,t){return na(e)}normalizeStyleValue(e,t,r,i){let o="",a=r.toString().trim();if(sy.has(t)&&r!==0&&r!=="0")if(typeof r=="number")o="px";else{let l=r.match(/^[+-]?[\d\.]+([a-z]*)$/);l&&l[1].length==0&&i.push(E_(e,r))}return a+o}};var ss="*";function oy(n,e){let t=[];return typeof n=="string"?n.split(/\s*,\s*/).forEach(r=>ay(r,t,e)):t.push(n),t}function ay(n,e,t){if(n[0]==":"){let h=ly(n,t);if(typeof h=="function"){e.push(h);return}n=h}let r=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(r==null||r.length<4)return t.push(x_(n)),e;let i=r[1],o=r[2],a=r[3];e.push(Yh(i,a));let l=i==ss&&a==ss;o[0]=="<"&&!l&&e.push(Yh(a,i))}function ly(n,e){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,r)=>parseFloat(r)>parseFloat(t);case":decrement":return(t,r)=>parseFloat(r)<parseFloat(t);default:return e.push(O_(n)),"* => *"}}var Ji=new Set(["true","1"]),Zi=new Set(["false","0"]);function Yh(n,e){let t=Ji.has(n)||Zi.has(n),r=Ji.has(e)||Zi.has(e);return(i,o)=>{let a=n==ss||n==i,l=e==ss||e==o;return!a&&t&&typeof i=="boolean"&&(a=i?Ji.has(n):Zi.has(n)),!l&&r&&typeof o=="boolean"&&(l=o?Ji.has(e):Zi.has(e)),a&&l}}var dd=":self",cy=new RegExp(`s*${dd}s*,?`,"g");function fd(n,e,t,r){return new qo(n).build(e,t,r)}var Xh="",qo=class{_driver;constructor(e){this._driver=e}build(e,t,r){let i=new $o(t);return this._resetContextStyleTimingState(i),nt(this,Gr(e),i)}_resetContextStyleTimingState(e){e.currentQuerySelector=Xh,e.collectedStyles=new Map,e.collectedStyles.set(Xh,new Map),e.currentTime=0}visitTrigger(e,t){let r=t.queryCount=0,i=t.depCount=0,o=[],a=[];return e.name.charAt(0)=="@"&&t.errors.push(T_()),e.definitions.forEach(l=>{if(this._resetContextStyleTimingState(t),l.type==W.State){let h=l,d=h.name;d.toString().split(/\s*,\s*/).forEach(m=>{h.name=m,o.push(this.visitState(h,t))}),h.name=d}else if(l.type==W.Transition){let h=this.visitTransition(l,t);r+=h.queryCount,i+=h.depCount,a.push(h)}else t.errors.push(I_())}),{type:W.Trigger,name:e.name,states:o,transitions:a,queryCount:r,depCount:i,options:null}}visitState(e,t){let r=this.visitStyle(e.styles,t),i=e.options&&e.options.params||null;if(r.containsDynamicStyles){let o=new Set,a=i||{};r.styles.forEach(l=>{l instanceof Map&&l.forEach(h=>{hd(h).forEach(d=>{a.hasOwnProperty(d)||o.add(d)})})}),o.size&&t.errors.push(b_(e.name,[...o.values()]))}return{type:W.State,name:e.name,style:r,options:i?{params:i}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;let r=nt(this,Gr(e.animation),t),i=oy(e.expr,t.errors);return{type:W.Transition,matchers:i,animation:r,queryCount:t.queryCount,depCount:t.depCount,options:Tn(e.options)}}visitSequence(e,t){return{type:W.Sequence,steps:e.steps.map(r=>nt(this,r,t)),options:Tn(e.options)}}visitGroup(e,t){let r=t.currentTime,i=0,o=e.steps.map(a=>{t.currentTime=r;let l=nt(this,a,t);return i=Math.max(i,t.currentTime),l});return t.currentTime=i,{type:W.Group,steps:o,options:Tn(e.options)}}visitAnimate(e,t){let r=fy(e.timings,t.errors);t.currentAnimateTimings=r;let i,o=e.styles?e.styles:Ro({});if(o.type==W.Keyframes)i=this.visitKeyframes(o,t);else{let a=e.styles,l=!1;if(!a){l=!0;let d={};r.easing&&(d.easing=r.easing),a=Ro(d)}t.currentTime+=r.duration+r.delay;let h=this.visitStyle(a,t);h.isEmptyStep=l,i=h}return t.currentAnimateTimings=null,{type:W.Animate,timings:r,style:i,options:null}}visitStyle(e,t){let r=this._makeStyleAst(e,t);return this._validateStyleAst(r,t),r}_makeStyleAst(e,t){let r=[],i=Array.isArray(e.styles)?e.styles:[e.styles];for(let l of i)typeof l=="string"?l===St?r.push(l):t.errors.push(S_(l)):r.push(new Map(Object.entries(l)));let o=!1,a=null;return r.forEach(l=>{if(l instanceof Map&&(l.has("easing")&&(a=l.get("easing"),l.delete("easing")),!o)){for(let h of l.values())if(h.toString().indexOf(cd)>=0){o=!0;break}}}),{type:W.Style,styles:r,easing:a,offset:e.offset,containsDynamicStyles:o,options:null}}_validateStyleAst(e,t){let r=t.currentAnimateTimings,i=t.currentTime,o=t.currentTime;r&&o>0&&(o-=r.duration+r.delay),e.styles.forEach(a=>{typeof a!="string"&&a.forEach((l,h)=>{let d=t.collectedStyles.get(t.currentQuerySelector),m=d.get(h),g=!0;m&&(o!=i&&o>=m.startTime&&i<=m.endTime&&(t.errors.push(A_(h,m.startTime,m.endTime,o,i)),g=!1),o=m.startTime),g&&d.set(h,{startTime:o,endTime:i}),t.options&&ty(l,t.options,t.errors)})})}visitKeyframes(e,t){let r={type:W.Keyframes,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(C_()),r;let i=1,o=0,a=[],l=!1,h=!1,d=0,m=e.steps.map(U=>{let $=this._makeStyleAst(U,t),j=$.offset!=null?$.offset:dy($.styles),q=0;return j!=null&&(o++,q=$.offset=j),h=h||q<0||q>1,l=l||q<d,d=q,a.push(q),$});h&&t.errors.push(R_()),l&&t.errors.push(P_());let g=e.steps.length,T=0;o>0&&o<g?t.errors.push(N_()):o==0&&(T=i/(g-1));let C=g-1,A=t.currentTime,R=t.currentAnimateTimings,P=R.duration;return m.forEach((U,$)=>{let j=T>0?$==C?1:T*$:a[$],q=j*P;t.currentTime=A+R.delay+q,R.duration=q,this._validateStyleAst(U,t),U.offset=j,r.styles.push(U)}),r}visitReference(e,t){return{type:W.Reference,animation:nt(this,Gr(e.animation),t),options:Tn(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:W.AnimateChild,options:Tn(e.options)}}visitAnimateRef(e,t){return{type:W.AnimateRef,animation:this.visitReference(e.animation,t),options:Tn(e.options)}}visitQuery(e,t){let r=t.currentQuerySelector,i=e.options||{};t.queryCount++,t.currentQuery=e;let[o,a]=uy(e.selector);t.currentQuerySelector=r.length?r+" "+o:o,rt(t.collectedStyles,t.currentQuerySelector,new Map);let l=nt(this,Gr(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=r,{type:W.Query,selector:o,limit:i.limit||0,optional:!!i.optional,includeSelf:a,animation:l,originalSelector:e.selector,options:Tn(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(k_());let r=e.timings==="full"?{duration:0,delay:0,easing:"full"}:rs(e.timings,t.errors,!0);return{type:W.Stagger,animation:nt(this,Gr(e.animation),t),timings:r,options:null}}};function uy(n){let e=!!n.split(/\s*,\s*/).find(t=>t==dd);return e&&(n=n.replace(cy,"")),n=n.replace(/@\*/g,ns).replace(/@\w+/g,t=>ns+"-"+t.slice(1)).replace(/:animating/g,Vo),[n,e]}function hy(n){return n?Ot({},n):null}var $o=class{errors;queryCount=0;depCount=0;currentTransition=null;currentQuery=null;currentQuerySelector=null;currentAnimateTimings=null;currentTime=0;collectedStyles=new Map;options=null;unsupportedCSSPropertiesFound=new Set;constructor(e){this.errors=e}};function dy(n){if(typeof n=="string")return null;let e=null;if(Array.isArray(n))n.forEach(t=>{if(t instanceof Map&&t.has("offset")){let r=t;e=parseFloat(r.get("offset")),r.delete("offset")}});else if(n instanceof Map&&n.has("offset")){let t=n;e=parseFloat(t.get("offset")),t.delete("offset")}return e}function fy(n,e){if(n.hasOwnProperty("duration"))return n;if(typeof n=="number"){let o=rs(n,e).duration;return Do(o,0,"")}let t=n;if(t.split(/\s+/).some(o=>o.charAt(0)=="{"&&o.charAt(1)=="{")){let o=Do(0,0,"");return o.dynamic=!0,o.strValue=t,o}let i=rs(t,e);return Do(i.duration,i.delay,i.easing)}function Tn(n){return n?(n=Ot({},n),n.params&&(n.params=hy(n.params))):n={},n}function Do(n,e,t){return{duration:n,delay:e,easing:t}}function ia(n,e,t,r,i,o,a=null,l=!1){return{type:1,element:n,keyframes:e,preStyleProps:t,postStyleProps:r,duration:i,delay:o,totalTime:i+o,easing:a,subTimeline:l}}var Hr=class{_map=new Map;get(e){return this._map.get(e)||[]}append(e,t){let r=this._map.get(e);r||this._map.set(e,r=[]),r.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}},py=1,my=":enter",gy=new RegExp(my,"g"),_y=":leave",yy=new RegExp(_y,"g");function pd(n,e,t,r,i,o=new Map,a=new Map,l,h,d=[]){return new jo().buildKeyframes(n,e,t,r,i,o,a,l,h,d)}var jo=class{buildKeyframes(e,t,r,i,o,a,l,h,d,m=[]){d=d||new Hr;let g=new zo(e,t,d,i,o,m,[]);g.options=h;let T=h.delay?Bt(h.delay):0;g.currentTimeline.delayNextStep(T),g.currentTimeline.setStyles([a],null,g.errors,h),nt(this,r,g);let C=g.timelines.filter(A=>A.containsAnimation());if(C.length&&l.size){let A;for(let R=C.length-1;R>=0;R--){let P=C[R];if(P.element===t){A=P;break}}A&&!A.allowOnlyTimelineStyles()&&A.setStyles([l],null,g.errors,h)}return C.length?C.map(A=>A.buildKeyframes()):[ia(t,[],[],[],0,T,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){let r=t.subInstructions.get(t.element);if(r){let i=t.createSubContext(e.options),o=t.currentTimeline.currentTime,a=this._visitSubInstructions(r,i,i.options);o!=a&&t.transformIntoNewTimeline(a)}t.previousNode=e}visitAnimateRef(e,t){let r=t.createSubContext(e.options);r.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,r),this.visitReference(e.animation,r),t.transformIntoNewTimeline(r.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,r){for(let i of e){let o=i?.delay;if(o){let a=typeof o=="number"?o:Bt(Wr(o,i?.params??{},t.errors));r.delayNextStep(a)}}}_visitSubInstructions(e,t,r){let o=t.currentTimeline.currentTime,a=r.duration!=null?Bt(r.duration):null,l=r.delay!=null?Bt(r.delay):null;return a!==0&&e.forEach(h=>{let d=t.appendInstructionToTimeline(h,a,l);o=Math.max(o,d.duration+d.delay)}),o}visitReference(e,t){t.updateOptions(e.options,!0),nt(this,e.animation,t),t.previousNode=e}visitSequence(e,t){let r=t.subContextCount,i=t,o=e.options;if(o&&(o.params||o.delay)&&(i=t.createSubContext(o),i.transformIntoNewTimeline(),o.delay!=null)){i.previousNode.type==W.Style&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=os);let a=Bt(o.delay);i.delayNextStep(a)}e.steps.length&&(e.steps.forEach(a=>nt(this,a,i)),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>r&&i.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){let r=[],i=t.currentTimeline.currentTime,o=e.options&&e.options.delay?Bt(e.options.delay):0;e.steps.forEach(a=>{let l=t.createSubContext(e.options);o&&l.delayNextStep(o),nt(this,a,l),i=Math.max(i,l.currentTimeline.currentTime),r.push(l.currentTimeline)}),r.forEach(a=>t.currentTimeline.mergeTimelineCollectedStyles(a)),t.transformIntoNewTimeline(i),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){let r=e.strValue,i=t.params?Wr(r,t.params,t.errors):r;return rs(i,t.errors)}else return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){let r=t.currentAnimateTimings=this._visitTiming(e.timings,t),i=t.currentTimeline;r.delay&&(t.incrementTime(r.delay),i.snapshotCurrentStyles());let o=e.style;o.type==W.Keyframes?this.visitKeyframes(o,t):(t.incrementTime(r.duration),this.visitStyle(o,t),i.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){let r=t.currentTimeline,i=t.currentAnimateTimings;!i&&r.hasCurrentStyleProperties()&&r.forwardFrame();let o=i&&i.easing||e.easing;e.isEmptyStep?r.applyEmptyStep(o):r.setStyles(e.styles,o,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){let r=t.currentAnimateTimings,i=t.currentTimeline.duration,o=r.duration,l=t.createSubContext().currentTimeline;l.easing=r.easing,e.styles.forEach(h=>{let d=h.offset||0;l.forwardTime(d*o),l.setStyles(h.styles,h.easing,t.errors,t.options),l.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(l),t.transformIntoNewTimeline(i+o),t.previousNode=e}visitQuery(e,t){let r=t.currentTimeline.currentTime,i=e.options||{},o=i.delay?Bt(i.delay):0;o&&(t.previousNode.type===W.Style||r==0&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=os);let a=r,l=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!i.optional,t.errors);t.currentQueryTotal=l.length;let h=null;l.forEach((d,m)=>{t.currentQueryIndex=m;let g=t.createSubContext(e.options,d);o&&g.delayNextStep(o),d===t.element&&(h=g.currentTimeline),nt(this,e.animation,g),g.currentTimeline.applyStylesToKeyframe();let T=g.currentTimeline.currentTime;a=Math.max(a,T)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(a),h&&(t.currentTimeline.mergeTimelineCollectedStyles(h),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){let r=t.parentContext,i=t.currentTimeline,o=e.timings,a=Math.abs(o.duration),l=a*(t.currentQueryTotal-1),h=a*t.currentQueryIndex;switch(o.duration<0?"reverse":o.easing){case"reverse":h=l-h;break;case"full":h=r.currentStaggerTime;break}let m=t.currentTimeline;h&&m.delayNextStep(h);let g=m.currentTime;nt(this,e.animation,t),t.previousNode=e,r.currentStaggerTime=i.currentTime-g+(i.startTime-r.currentTimeline.startTime)}},os={},zo=class n{_driver;element;subInstructions;_enterClassName;_leaveClassName;errors;timelines;parentContext=null;currentTimeline;currentAnimateTimings=null;previousNode=os;subContextCount=0;options={};currentQueryIndex=0;currentQueryTotal=0;currentStaggerTime=0;constructor(e,t,r,i,o,a,l,h){this._driver=e,this.element=t,this.subInstructions=r,this._enterClassName=i,this._leaveClassName=o,this.errors=a,this.timelines=l,this.currentTimeline=h||new as(this._driver,t,0),l.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;let r=e,i=this.options;r.duration!=null&&(i.duration=Bt(r.duration)),r.delay!=null&&(i.delay=Bt(r.delay));let o=r.params;if(o){let a=i.params;a||(a=this.options.params={}),Object.keys(o).forEach(l=>{(!t||!a.hasOwnProperty(l))&&(a[l]=Wr(o[l],a,this.errors))})}}_copyOptions(){let e={};if(this.options){let t=this.options.params;if(t){let r=e.params={};Object.keys(t).forEach(i=>{r[i]=t[i]})}}return e}createSubContext(e=null,t,r){let i=t||this.element,o=new n(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,r||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(e),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}transformIntoNewTimeline(e){return this.previousNode=os,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,r){let i={duration:t??e.duration,delay:this.currentTimeline.currentTime+(r??0)+e.delay,easing:""},o=new Go(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,i,e.stretchStartingKeyframe);return this.timelines.push(o),i}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,r,i,o,a){let l=[];if(i&&l.push(this.element),e.length>0){e=e.replace(gy,"."+this._enterClassName),e=e.replace(yy,"."+this._leaveClassName);let h=r!=1,d=this._driver.query(this.element,e,h);r!==0&&(d=r<0?d.slice(d.length+r,d.length):d.slice(0,r)),l.push(...d)}return!o&&l.length==0&&a.push(D_(t)),l}},as=class n{_driver;element;startTime;_elementTimelineStylesLookup;duration=0;easing=null;_previousKeyframe=new Map;_currentKeyframe=new Map;_keyframes=new Map;_styleSummary=new Map;_localTimelineStyles=new Map;_globalTimelineStyles;_pendingStyles=new Map;_backFill=new Map;_currentEmptyStepKeyframe=null;constructor(e,t,r,i){this._driver=e,this.element=t,this.startTime=r,this._elementTimelineStylesLookup=i,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){let t=this._keyframes.size===1&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new n(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=py,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,r]of this._globalTimelineStyles)this._backFill.set(t,r||St),this._currentKeyframe.set(t,St);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,r,i){t&&this._previousKeyframe.set("easing",t);let o=i&&i.params||{},a=vy(e,this._globalTimelineStyles);for(let[l,h]of a){let d=Wr(h,o,r);this._pendingStyles.set(l,d),this._localTimelineStyles.has(l)||this._backFill.set(l,this._globalTimelineStyles.get(l)??St),this._updateStyle(l,d)}}applyStylesToKeyframe(){this._pendingStyles.size!=0&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){let e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,r)=>{let i=this._styleSummary.get(r);(!i||t.time>i.time)&&this._updateStyle(r,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();let e=new Set,t=new Set,r=this._keyframes.size===1&&this.duration===0,i=[];this._keyframes.forEach((l,h)=>{let d=new Map([...this._backFill,...l]);d.forEach((m,g)=>{m===Ki?e.add(g):m===St&&t.add(g)}),r||d.set("offset",h/this.duration),i.push(d)});let o=[...e.values()],a=[...t.values()];if(r){let l=i[0],h=new Map(l);l.set("offset",0),h.set("offset",1),i=[l,h]}return ia(this.element,i,o,a,this.duration,this.startTime,this.easing,!1)}},Go=class extends as{keyframes;preStyleProps;postStyleProps;_stretchStartingKeyframe;timings;constructor(e,t,r,i,o,a,l=!1){super(e,t,a.delay),this.keyframes=r,this.preStyleProps=i,this.postStyleProps=o,this._stretchStartingKeyframe=l,this.timings={duration:a.duration,delay:a.delay,easing:a.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:r,easing:i}=this.timings;if(this._stretchStartingKeyframe&&t){let o=[],a=r+t,l=t/a,h=new Map(e[0]);h.set("offset",0),o.push(h);let d=new Map(e[0]);d.set("offset",Jh(l)),o.push(d);let m=e.length-1;for(let g=1;g<=m;g++){let T=new Map(e[g]),C=T.get("offset"),A=t+C*r;T.set("offset",Jh(A/a)),o.push(T)}r=a,t=0,i="",e=o}return ia(this.element,e,this.preStyleProps,this.postStyleProps,r,t,i,!0)}};function Jh(n,e=3){let t=Math.pow(10,e-1);return Math.round(n*t)/t}function vy(n,e){let t=new Map,r;return n.forEach(i=>{if(i==="*"){r??=e.keys();for(let o of r)t.set(o,St)}else for(let[o,a]of i)t.set(o,a)}),t}function Zh(n,e,t,r,i,o,a,l,h,d,m,g,T){return{type:0,element:n,triggerName:e,isRemovalTransition:i,fromState:t,fromStyles:o,toState:r,toStyles:a,timelines:l,queriedElements:h,preStyleProps:d,postStyleProps:m,totalTime:g,errors:T}}var xo={},ls=class{_triggerName;ast;_stateStyles;constructor(e,t,r){this._triggerName=e,this.ast=t,this._stateStyles=r}match(e,t,r,i){return wy(this.ast.matchers,e,t,r,i)}buildStyles(e,t,r){let i=this._stateStyles.get("*");return e!==void 0&&(i=this._stateStyles.get(e?.toString())||i),i?i.buildStyles(t,r):new Map}build(e,t,r,i,o,a,l,h,d,m){let g=[],T=this.ast.options&&this.ast.options.params||xo,C=l&&l.params||xo,A=this.buildStyles(r,C,g),R=h&&h.params||xo,P=this.buildStyles(i,R,g),U=new Set,$=new Map,j=new Map,q=i==="void",Ve={params:md(R,T),delay:this.ast.options?.delay},ie=m?[]:pd(e,t,this.ast.animation,o,a,A,P,Ve,d,g),w=0;return ie.forEach(p=>{w=Math.max(p.duration+p.delay,w)}),g.length?Zh(t,this._triggerName,r,i,q,A,P,[],[],$,j,w,g):(ie.forEach(p=>{let y=p.element,v=rt($,y,new Set);p.preStyleProps.forEach(b=>v.add(b));let E=rt(j,y,new Set);p.postStyleProps.forEach(b=>E.add(b)),y!==t&&U.add(y)}),Zh(t,this._triggerName,r,i,q,A,P,ie,[...U.values()],$,j,w))}};function wy(n,e,t,r,i){return n.some(o=>o(e,t,r,i))}function md(n,e){let t=Ot({},e);return Object.entries(n).forEach(([r,i])=>{i!=null&&(t[r]=i)}),t}var Ko=class{styles;defaultParams;normalizer;constructor(e,t,r){this.styles=e,this.defaultParams=t,this.normalizer=r}buildStyles(e,t){let r=new Map,i=md(e,this.defaultParams);return this.styles.styles.forEach(o=>{typeof o!="string"&&o.forEach((a,l)=>{a&&(a=Wr(a,i,t));let h=this.normalizer.normalizePropertyName(l,t);a=this.normalizer.normalizeStyleValue(l,h,a,t),r.set(l,a)})}),r}};function Ey(n,e,t){return new Wo(n,e,t)}var Wo=class{name;ast;_normalizer;transitionFactories=[];fallbackTransition;states=new Map;constructor(e,t,r){this.name=e,this.ast=t,this._normalizer=r,t.states.forEach(i=>{let o=i.options&&i.options.params||{};this.states.set(i.name,new Ko(i.style,o,r))}),ed(this.states,"true","1"),ed(this.states,"false","0"),t.transitions.forEach(i=>{this.transitionFactories.push(new ls(e,i,this.states))}),this.fallbackTransition=Ty(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,r,i){return this.transitionFactories.find(a=>a.match(e,t,r,i))||null}matchStyles(e,t,r){return this.fallbackTransition.buildStyles(e,t,r)}};function Ty(n,e,t){let r=[(a,l)=>!0],i={type:W.Sequence,steps:[],options:null},o={type:W.Transition,animation:i,matchers:r,options:null,queryCount:0,depCount:0};return new ls(n,o,e)}function ed(n,e,t){n.has(e)?n.has(t)||n.set(t,n.get(e)):n.has(t)&&n.set(e,n.get(t))}var Iy=new Hr,Ho=class{bodyNode;_driver;_normalizer;_animations=new Map;_playersById=new Map;players=[];constructor(e,t,r){this.bodyNode=e,this._driver=t,this._normalizer=r}register(e,t){let r=[],i=[],o=fd(this._driver,t,r,i);if(r.length)throw L_(r);this._animations.set(e,o)}_buildPlayer(e,t,r){let i=e.element,o=od(this._normalizer,e.keyframes,t,r);return this._driver.animate(i,o,e.duration,e.delay,e.easing,[],!0)}create(e,t,r={}){let i=[],o=this._animations.get(e),a,l=new Map;if(o?(a=pd(this._driver,t,o,ud,Lo,new Map,new Map,r,Iy,i),a.forEach(m=>{let g=rt(l,m.element,new Map);m.postStyleProps.forEach(T=>g.set(T,null))})):(i.push(V_()),a=[]),i.length)throw U_(i);l.forEach((m,g)=>{m.forEach((T,C)=>{m.set(C,this._driver.computeStyle(g,C,St))})});let h=a.map(m=>{let g=l.get(m.element);return this._buildPlayer(m,new Map,g)}),d=ln(h);return this._playersById.set(e,d),d.onDestroy(()=>this.destroy(e)),this.players.push(d),d}destroy(e){let t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);let r=this.players.indexOf(t);r>=0&&this.players.splice(r,1)}_getPlayer(e){let t=this._playersById.get(e);if(!t)throw B_(e);return t}listen(e,t,r,i){let o=Zo(t,"","","");return Jo(this._getPlayer(e),r,o,i),()=>{}}command(e,t,r,i){if(r=="register"){this.register(e,i[0]);return}if(r=="create"){let a=i[0]||{};this.create(e,t,a);return}let o=this._getPlayer(e);switch(r){case"play":o.play();break;case"pause":o.pause();break;case"reset":o.reset();break;case"restart":o.restart();break;case"finish":o.finish();break;case"init":o.init();break;case"setPosition":o.setPosition(parseFloat(i[0]));break;case"destroy":this.destroy(e);break}}},td="ng-animate-queued",by=".ng-animate-queued",Oo="ng-animate-disabled",Sy=".ng-animate-disabled",Ay="ng-star-inserted",Cy=".ng-star-inserted",Ry=[],gd={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Py={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},pt="__ng_removed",Qr=class{namespaceId;value;options;get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;let r=e&&e.hasOwnProperty("value"),i=r?e.value:e;if(this.value=ky(i),r){let o=e,{value:a}=o,l=xu(o,["value"]);this.options=l}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){let t=e.params;if(t){let r=this.options.params;Object.keys(t).forEach(i=>{r[i]==null&&(r[i]=t[i])})}}},Kr="void",Mo=new Qr(Kr),Qo=class{id;hostElement;_engine;players=[];_triggers=new Map;_queue=[];_elementListeners=new Map;_hostClassName;constructor(e,t,r){this.id=e,this.hostElement=t,this._engine=r,this._hostClassName="ng-tns-"+e,ct(t,this._hostClassName)}listen(e,t,r,i){if(!this._triggers.has(t))throw q_(r,t);if(r==null||r.length==0)throw $_(t);if(!Dy(r))throw j_(r,t);let o=rt(this._elementListeners,e,[]),a={name:t,phase:r,callback:i};o.push(a);let l=rt(this._engine.statesByElement,e,new Map);return l.has(t)||(ct(e,Xi),ct(e,Xi+"-"+t),l.set(t,Mo)),()=>{this._engine.afterFlush(()=>{let h=o.indexOf(a);h>=0&&o.splice(h,1),this._triggers.has(t)||l.delete(t)})}}register(e,t){return this._triggers.has(e)?!1:(this._triggers.set(e,t),!0)}_getTrigger(e){let t=this._triggers.get(e);if(!t)throw z_(e);return t}trigger(e,t,r,i=!0){let o=this._getTrigger(t),a=new Yr(this.id,t,e),l=this._engine.statesByElement.get(e);l||(ct(e,Xi),ct(e,Xi+"-"+t),this._engine.statesByElement.set(e,l=new Map));let h=l.get(t),d=new Qr(r,this.id);if(!(r&&r.hasOwnProperty("value"))&&h&&d.absorbOptions(h.options),l.set(t,d),h||(h=Mo),!(d.value===Kr)&&h.value===d.value){if(!My(h.params,d.params)){let R=[],P=o.matchStyles(h.value,h.params,R),U=o.matchStyles(d.value,d.params,R);R.length?this._engine.reportError(R):this._engine.afterFlush(()=>{In(e,P),At(e,U)})}return}let T=rt(this._engine.playersByElement,e,[]);T.forEach(R=>{R.namespaceId==this.id&&R.triggerName==t&&R.queued&&R.destroy()});let C=o.matchTransition(h.value,d.value,e,d.params),A=!1;if(!C){if(!i)return;C=o.fallbackTransition,A=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:C,fromState:h,toState:d,player:a,isFallbackTransition:A}),A||(ct(e,td),a.onStart(()=>{er(e,td)})),a.onDone(()=>{let R=this.players.indexOf(a);R>=0&&this.players.splice(R,1);let P=this._engine.playersByElement.get(e);if(P){let U=P.indexOf(a);U>=0&&P.splice(U,1)}}),this.players.push(a),T.push(a),a}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,r)=>{this._elementListeners.set(r,t.filter(i=>i.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);let t=this._engine.playersByElement.get(e);t&&(t.forEach(r=>r.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){let r=this._engine.driver.query(e,ns,!0);r.forEach(i=>{if(i[pt])return;let o=this._engine.fetchNamespacesByElement(i);o.size?o.forEach(a=>a.triggerLeaveAnimation(i,t,!1,!0)):this.clearElementCache(i)}),this._engine.afterFlushAnimationsDone(()=>r.forEach(i=>this.clearElementCache(i)))}triggerLeaveAnimation(e,t,r,i){let o=this._engine.statesByElement.get(e),a=new Map;if(o){let l=[];if(o.forEach((h,d)=>{if(a.set(d,h.value),this._triggers.has(d)){let m=this.trigger(e,d,Kr,i);m&&l.push(m)}}),l.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,a),r&&ln(l).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){let t=this._elementListeners.get(e),r=this._engine.statesByElement.get(e);if(t&&r){let i=new Set;t.forEach(o=>{let a=o.name;if(i.has(a))return;i.add(a);let h=this._triggers.get(a).fallbackTransition,d=r.get(a)||Mo,m=new Qr(Kr),g=new Yr(this.id,a,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:a,transition:h,fromState:d,toState:m,player:g,isFallbackTransition:!0})})}}removeNode(e,t){let r=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let i=!1;if(r.totalAnimations){let o=r.players.length?r.playersByQueriedElement.get(e):[];if(o&&o.length)i=!0;else{let a=e;for(;a=a.parentNode;)if(r.statesByElement.get(a)){i=!0;break}}}if(this.prepareLeaveAnimationListeners(e),i)r.markElementAsRemoved(this.id,e,!1,t);else{let o=e[pt];(!o||o===gd)&&(r.afterFlush(()=>this.clearElementCache(e)),r.destroyInnerAnimations(e),r._onRemovalComplete(e,t))}}insertNode(e,t){ct(e,this._hostClassName)}drainQueuedTransitions(e){let t=[];return this._queue.forEach(r=>{let i=r.player;if(i.destroyed)return;let o=r.element,a=this._elementListeners.get(o);a&&a.forEach(l=>{if(l.name==r.triggerName){let h=Zo(o,r.triggerName,r.fromState.value,r.toState.value);h._data=e,Jo(r.player,l.phase,h,l.callback)}}),i.markedForDestroy?this._engine.afterFlush(()=>{i.destroy()}):t.push(r)}),this._queue=[],t.sort((r,i)=>{let o=r.transition.ast.depCount,a=i.transition.ast.depCount;return o==0||a==0?o-a:this._engine.driver.containsElement(r.element,i.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}},Yo=class{bodyNode;driver;_normalizer;players=[];newHostElements=new Map;playersByElement=new Map;playersByQueriedElement=new Map;statesByElement=new Map;disabledNodes=new Set;totalAnimations=0;totalQueuedPlayers=0;_namespaceLookup={};_namespaceList=[];_flushFns=[];_whenQuietFns=[];namespacesByHostElement=new Map;collectedEnterElements=[];collectedLeaveElements=[];onRemovalComplete=(e,t)=>{};_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,r){this.bodyNode=e,this.driver=t,this._normalizer=r}get queuedPlayers(){let e=[];return this._namespaceList.forEach(t=>{t.players.forEach(r=>{r.queued&&e.push(r)})}),e}createNamespace(e,t){let r=new Qo(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(r,t):(this.newHostElements.set(t,r),this.collectEnterElement(t)),this._namespaceLookup[e]=r}_balanceNamespaceList(e,t){let r=this._namespaceList,i=this.namespacesByHostElement;if(r.length-1>=0){let a=!1,l=this.driver.getParentElement(t);for(;l;){let h=i.get(l);if(h){let d=r.indexOf(h);r.splice(d+1,0,e),a=!0;break}l=this.driver.getParentElement(l)}a||r.unshift(e)}else r.push(e);return i.set(t,e),e}register(e,t){let r=this._namespaceLookup[e];return r||(r=this.createNamespace(e,t)),r}registerTrigger(e,t,r){let i=this._namespaceLookup[e];i&&i.register(t,r)&&this.totalAnimations++}destroy(e,t){e&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{let r=this._fetchNamespace(e);this.namespacesByHostElement.delete(r.hostElement);let i=this._namespaceList.indexOf(r);i>=0&&this._namespaceList.splice(i,1),r.destroy(t),delete this._namespaceLookup[e]}))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){let t=new Set,r=this.statesByElement.get(e);if(r){for(let i of r.values())if(i.namespaceId){let o=this._fetchNamespace(i.namespaceId);o&&t.add(o)}}return t}trigger(e,t,r,i){if(es(t)){let o=this._fetchNamespace(e);if(o)return o.trigger(t,r,i),!0}return!1}insertNode(e,t,r,i){if(!es(t))return;let o=t[pt];if(o&&o.setForRemoval){o.setForRemoval=!1,o.setForMove=!0;let a=this.collectedLeaveElements.indexOf(t);a>=0&&this.collectedLeaveElements.splice(a,1)}if(e){let a=this._fetchNamespace(e);a&&a.insertNode(t,r)}i&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),ct(e,Oo)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),er(e,Oo))}removeNode(e,t,r){if(es(t)){let i=e?this._fetchNamespace(e):null;i?i.removeNode(t,r):this.markElementAsRemoved(e,t,!1,r);let o=this.namespacesByHostElement.get(t);o&&o.id!==e&&o.removeNode(t,r)}else this._onRemovalComplete(t,r)}markElementAsRemoved(e,t,r,i,o){this.collectedLeaveElements.push(t),t[pt]={namespaceId:e,setForRemoval:i,hasAnimation:r,removedBeforeQueried:!1,previousTriggersValues:o}}listen(e,t,r,i,o){return es(t)?this._fetchNamespace(e).listen(t,r,i,o):()=>{}}_buildInstruction(e,t,r,i,o){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,r,i,e.fromState.options,e.toState.options,t,o)}destroyInnerAnimations(e){let t=this.driver.query(e,ns,!0);t.forEach(r=>this.destroyActiveAnimationsForElement(r)),this.playersByQueriedElement.size!=0&&(t=this.driver.query(e,Vo,!0),t.forEach(r=>this.finishActiveQueriedAnimationOnElement(r)))}destroyActiveAnimationsForElement(e){let t=this.playersByElement.get(e);t&&t.forEach(r=>{r.queued?r.markedForDestroy=!0:r.destroy()})}finishActiveQueriedAnimationOnElement(e){let t=this.playersByQueriedElement.get(e);t&&t.forEach(r=>r.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return ln(this.players).onDone(()=>e());e()})}processLeaveNode(e){let t=e[pt];if(t&&t.setForRemoval){if(e[pt]=gd,t.namespaceId){this.destroyInnerAnimations(e);let r=this._fetchNamespace(t.namespaceId);r&&r.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(Oo)&&this.markElementAsDisabled(e,!1),this.driver.query(e,Sy,!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((r,i)=>this._balanceNamespaceList(r,i)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let r=0;r<this.collectedEnterElements.length;r++){let i=this.collectedEnterElements[r];ct(i,Ay)}if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){let r=[];try{t=this._flushAnimations(r,e)}finally{for(let i=0;i<r.length;i++)r[i]()}}else for(let r=0;r<this.collectedLeaveElements.length;r++){let i=this.collectedLeaveElements[r];this.processLeaveNode(i)}if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(r=>r()),this._flushFns=[],this._whenQuietFns.length){let r=this._whenQuietFns;this._whenQuietFns=[],t.length?ln(t).onDone(()=>{r.forEach(i=>i())}):r.forEach(i=>i())}}reportError(e){throw G_(e)}_flushAnimations(e,t){let r=new Hr,i=[],o=new Map,a=[],l=new Map,h=new Map,d=new Map,m=new Set;this.disabledNodes.forEach(M=>{m.add(M);let F=this.driver.query(M,by,!0);for(let L=0;L<F.length;L++)m.add(F[L])});let g=this.bodyNode,T=Array.from(this.statesByElement.keys()),C=id(T,this.collectedEnterElements),A=new Map,R=0;C.forEach((M,F)=>{let L=ud+R++;A.set(F,L),M.forEach(G=>ct(G,L))});let P=[],U=new Set,$=new Set;for(let M=0;M<this.collectedLeaveElements.length;M++){let F=this.collectedLeaveElements[M],L=F[pt];L&&L.setForRemoval&&(P.push(F),U.add(F),L.hasAnimation?this.driver.query(F,Cy,!0).forEach(G=>U.add(G)):$.add(F))}let j=new Map,q=id(T,Array.from(U));q.forEach((M,F)=>{let L=Lo+R++;j.set(F,L),M.forEach(G=>ct(G,L))}),e.push(()=>{C.forEach((M,F)=>{let L=A.get(F);M.forEach(G=>er(G,L))}),q.forEach((M,F)=>{let L=j.get(F);M.forEach(G=>er(G,L))}),P.forEach(M=>{this.processLeaveNode(M)})});let Ve=[],ie=[];for(let M=this._namespaceList.length-1;M>=0;M--)this._namespaceList[M].drainQueuedTransitions(t).forEach(L=>{let G=L.player,pe=L.element;if(Ve.push(G),this.collectedEnterElements.length){let de=pe[pt];if(de&&de.setForMove){if(de.previousTriggersValues&&de.previousTriggersValues.has(L.triggerName)){let Nt=de.previousTriggersValues.get(L.triggerName),Xe=this.statesByElement.get(L.element);if(Xe&&Xe.has(L.triggerName)){let kt=Xe.get(L.triggerName);kt.value=Nt,Xe.set(L.triggerName,kt)}}G.destroy();return}}let at=!g||!this.driver.containsElement(g,pe),he=j.get(pe),se=A.get(pe),oe=this._buildInstruction(L,r,se,he,at);if(oe.errors&&oe.errors.length){ie.push(oe);return}if(at){G.onStart(()=>In(pe,oe.fromStyles)),G.onDestroy(()=>At(pe,oe.toStyles)),i.push(G);return}if(L.isFallbackTransition){G.onStart(()=>In(pe,oe.fromStyles)),G.onDestroy(()=>At(pe,oe.toStyles)),i.push(G);return}let Ht=[];oe.timelines.forEach(de=>{de.stretchStartingKeyframe=!0,this.disabledNodes.has(de.element)||Ht.push(de)}),oe.timelines=Ht,r.append(pe,oe.timelines);let Gs={instruction:oe,player:G,element:pe};a.push(Gs),oe.queriedElements.forEach(de=>rt(l,de,[]).push(G)),oe.preStyleProps.forEach((de,Nt)=>{if(de.size){let Xe=h.get(Nt);Xe||h.set(Nt,Xe=new Set),de.forEach((kt,Qt)=>Xe.add(Qt))}}),oe.postStyleProps.forEach((de,Nt)=>{let Xe=d.get(Nt);Xe||d.set(Nt,Xe=new Set),de.forEach((kt,Qt)=>Xe.add(Qt))})});if(ie.length){let M=[];ie.forEach(F=>{M.push(K_(F.triggerName,F.errors))}),Ve.forEach(F=>F.destroy()),this.reportError(M)}let w=new Map,p=new Map;a.forEach(M=>{let F=M.element;r.has(F)&&(p.set(F,F),this._beforeAnimationBuild(M.player.namespaceId,M.instruction,w))}),i.forEach(M=>{let F=M.element;this._getPreviousPlayers(F,!1,M.namespaceId,M.triggerName,null).forEach(G=>{rt(w,F,[]).push(G),G.destroy()})});let y=P.filter(M=>sd(M,h,d)),v=new Map;rd(v,this.driver,$,d,St).forEach(M=>{sd(M,h,d)&&y.push(M)});let b=new Map;C.forEach((M,F)=>{rd(b,this.driver,new Set(M),h,Ki)}),y.forEach(M=>{let F=v.get(M),L=b.get(M);v.set(M,new Map([...F?.entries()??[],...L?.entries()??[]]))});let _=[],ot=[],Wt={};a.forEach(M=>{let{element:F,player:L,instruction:G}=M;if(r.has(F)){if(m.has(F)){L.onDestroy(()=>At(F,G.toStyles)),L.disabled=!0,L.overrideTotalTime(G.totalTime),i.push(L);return}let pe=Wt;if(p.size>1){let he=F,se=[];for(;he=he.parentNode;){let oe=p.get(he);if(oe){pe=oe;break}se.push(he)}se.forEach(oe=>p.set(oe,pe))}let at=this._buildAnimation(L.namespaceId,G,w,o,b,v);if(L.setRealPlayer(at),pe===Wt)_.push(L);else{let he=this.playersByElement.get(pe);he&&he.length&&(L.parentPlayer=ln(he)),i.push(L)}}else In(F,G.fromStyles),L.onDestroy(()=>At(F,G.toStyles)),ot.push(L),m.has(F)&&i.push(L)}),ot.forEach(M=>{let F=o.get(M.element);if(F&&F.length){let L=ln(F);M.setRealPlayer(L)}}),i.forEach(M=>{M.parentPlayer?M.syncPlayerEvents(M.parentPlayer):M.destroy()});for(let M=0;M<P.length;M++){let F=P[M],L=F[pt];if(er(F,Lo),L&&L.hasAnimation)continue;let G=[];if(l.size){let at=l.get(F);at&&at.length&&G.push(...at);let he=this.driver.query(F,Vo,!0);for(let se=0;se<he.length;se++){let oe=l.get(he[se]);oe&&oe.length&&G.push(...oe)}}let pe=G.filter(at=>!at.destroyed);pe.length?xy(this,F,pe):this.processLeaveNode(F)}return P.length=0,_.forEach(M=>{this.players.push(M),M.onDone(()=>{M.destroy();let F=this.players.indexOf(M);this.players.splice(F,1)}),M.play()}),_}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,r,i,o){let a=[];if(t){let l=this.playersByQueriedElement.get(e);l&&(a=l)}else{let l=this.playersByElement.get(e);if(l){let h=!o||o==Kr;l.forEach(d=>{d.queued||!h&&d.triggerName!=i||a.push(d)})}}return(r||i)&&(a=a.filter(l=>!(r&&r!=l.namespaceId||i&&i!=l.triggerName))),a}_beforeAnimationBuild(e,t,r){let i=t.triggerName,o=t.element,a=t.isRemovalTransition?void 0:e,l=t.isRemovalTransition?void 0:i;for(let h of t.timelines){let d=h.element,m=d!==o,g=rt(r,d,[]);this._getPreviousPlayers(d,m,a,l,t.toState).forEach(C=>{let A=C.getRealPlayer();A.beforeDestroy&&A.beforeDestroy(),C.destroy(),g.push(C)})}In(o,t.fromStyles)}_buildAnimation(e,t,r,i,o,a){let l=t.triggerName,h=t.element,d=[],m=new Set,g=new Set,T=t.timelines.map(A=>{let R=A.element;m.add(R);let P=R[pt];if(P&&P.removedBeforeQueried)return new Zn(A.duration,A.delay);let U=R!==h,$=Oy((r.get(R)||Ry).map(w=>w.getRealPlayer())).filter(w=>{let p=w;return p.element?p.element===R:!1}),j=o.get(R),q=a.get(R),Ve=od(this._normalizer,A.keyframes,j,q),ie=this._buildPlayer(A,Ve,$);if(A.subTimeline&&i&&g.add(R),U){let w=new Yr(e,l,R);w.setRealPlayer(ie),d.push(w)}return ie});d.forEach(A=>{rt(this.playersByQueriedElement,A.element,[]).push(A),A.onDone(()=>Ny(this.playersByQueriedElement,A.element,A))}),m.forEach(A=>ct(A,Qh));let C=ln(T);return C.onDestroy(()=>{m.forEach(A=>er(A,Qh)),At(h,t.toStyles)}),g.forEach(A=>{rt(i,A,[]).push(C)}),C}_buildPlayer(e,t,r){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,r):new Zn(e.duration,e.delay)}},Yr=class{namespaceId;triggerName;element;_player=new Zn;_containsRealPlayer=!1;_queuedCallbacks=new Map;destroyed=!1;parentPlayer=null;markedForDestroy=!1;disabled=!1;queued=!0;totalTime=0;constructor(e,t,r){this.namespaceId=e,this.triggerName=t,this.element=r}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,r)=>{t.forEach(i=>Jo(e,r,void 0,i))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){let t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){rt(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return this.queued?!1:this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){let t=this._player;t.triggerCallback&&t.triggerCallback(e)}};function Ny(n,e,t){let r=n.get(e);if(r){if(r.length){let i=r.indexOf(t);r.splice(i,1)}r.length==0&&n.delete(e)}return r}function ky(n){return n??null}function es(n){return n&&n.nodeType===1}function Dy(n){return n=="start"||n=="done"}function nd(n,e){let t=n.style.display;return n.style.display=e??"none",t}function rd(n,e,t,r,i){let o=[];t.forEach(h=>o.push(nd(h)));let a=[];r.forEach((h,d)=>{let m=new Map;h.forEach(g=>{let T=e.computeStyle(d,g,i);m.set(g,T),(!T||T.length==0)&&(d[pt]=Py,a.push(d))}),n.set(d,m)});let l=0;return t.forEach(h=>nd(h,o[l++])),a}function id(n,e){let t=new Map;if(n.forEach(l=>t.set(l,[])),e.length==0)return t;let r=1,i=new Set(e),o=new Map;function a(l){if(!l)return r;let h=o.get(l);if(h)return h;let d=l.parentNode;return t.has(d)?h=d:i.has(d)?h=r:h=a(d),o.set(l,h),h}return e.forEach(l=>{let h=a(l);h!==r&&t.get(h).push(l)}),t}function ct(n,e){n.classList?.add(e)}function er(n,e){n.classList?.remove(e)}function xy(n,e,t){ln(t).onDone(()=>n.processLeaveNode(e))}function Oy(n){let e=[];return _d(n,e),e}function _d(n,e){for(let t=0;t<n.length;t++){let r=n[t];r instanceof Po?_d(r.players,e):e.push(r)}}function My(n,e){let t=Object.keys(n),r=Object.keys(e);if(t.length!=r.length)return!1;for(let i=0;i<t.length;i++){let o=t[i];if(!e.hasOwnProperty(o)||n[o]!==e[o])return!1}return!0}function sd(n,e,t){let r=t.get(n);if(!r)return!1;let i=e.get(n);return i?r.forEach(o=>i.add(o)):e.set(n,r),t.delete(n),!0}var tr=class{_driver;_normalizer;_transitionEngine;_timelineEngine;_triggerCache={};onRemovalComplete=(e,t)=>{};constructor(e,t,r){this._driver=t,this._normalizer=r,this._transitionEngine=new Yo(e.body,t,r),this._timelineEngine=new Ho(e.body,t,r),this._transitionEngine.onRemovalComplete=(i,o)=>this.onRemovalComplete(i,o)}registerTrigger(e,t,r,i,o){let a=e+"-"+i,l=this._triggerCache[a];if(!l){let h=[],d=[],m=fd(this._driver,o,h,d);if(h.length)throw M_(i,h);l=Ey(i,m,this._normalizer),this._triggerCache[a]=l}this._transitionEngine.registerTrigger(t,i,l)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,r,i){this._transitionEngine.insertNode(e,t,r,i)}onRemove(e,t,r){this._transitionEngine.removeNode(e,t,r)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,r,i){if(r.charAt(0)=="@"){let[o,a]=Wh(r),l=i;this._timelineEngine.command(o,t,a,l)}else this._transitionEngine.trigger(e,t,r,i)}listen(e,t,r,i,o){if(r.charAt(0)=="@"){let[a,l]=Wh(r);return this._timelineEngine.listen(a,t,l,o)}return this._transitionEngine.listen(e,t,r,i,o)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(e){this._transitionEngine.afterFlushAnimationsDone(e)}};function Fy(n,e){let t=null,r=null;return Array.isArray(e)&&e.length?(t=Fo(e[0]),e.length>1&&(r=Fo(e[e.length-1]))):e instanceof Map&&(t=Fo(e)),t||r?new Ly(n,t,r):null}var Ly=(()=>{class n{_element;_startStyles;_endStyles;static initialStylesByElement=new WeakMap;_state=0;_initialStyles;constructor(t,r,i){this._element=t,this._startStyles=r,this._endStyles=i;let o=n.initialStylesByElement.get(t);o||n.initialStylesByElement.set(t,o=new Map),this._initialStyles=o}start(){this._state<1&&(this._startStyles&&At(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(At(this._element,this._initialStyles),this._endStyles&&(At(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(In(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(In(this._element,this._endStyles),this._endStyles=null),At(this._element,this._initialStyles),this._state=3)}}return n})();function Fo(n){let e=null;return n.forEach((t,r)=>{Vy(r)&&(e=e||new Map,e.set(r,t))}),e}function Vy(n){return n==="display"||n==="position"}var cs=class{element;keyframes;options;_specialStyles;_onDoneFns=[];_onStartFns=[];_onDestroyFns=[];_duration;_delay;_initialized=!1;_finished=!1;_started=!1;_destroyed=!1;_finalKeyframe;_originalOnDoneFns=[];_originalOnStartFns=[];domPlayer;time=0;parentPlayer=null;currentSnapshot=new Map;constructor(e,t,r,i){this.element=e,this.keyframes=t,this.options=r,this._specialStyles=i,this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;let e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map;let t=()=>this._onFinish();this.domPlayer.addEventListener("finish",t),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",t)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){let t=[];return e.forEach(r=>{t.push(Object.fromEntries(r))}),t}_triggerWebAnimation(e,t,r){return e.animate(this._convertKeyframesToObject(t),r)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){this.domPlayer===void 0&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){let e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((r,i)=>{i!=="offset"&&e.set(i,this._finished?r:ra(this.element,i))}),this.currentSnapshot=e}triggerCallback(e){let t=e==="start"?this._onStartFns:this._onDoneFns;t.forEach(r=>r()),t.length=0}},us=class{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}containsElement(e,t){return ad(e,t)}getParentElement(e){return ea(e)}query(e,t,r){return ld(e,t,r)}computeStyle(e,t,r){return ra(e,t)}animate(e,t,r,i,o,a=[]){let l=i==0?"both":"forwards",h={duration:r,delay:i,fill:l};o&&(h.easing=o);let d=new Map,m=a.filter(C=>C instanceof cs);ry(r,i)&&m.forEach(C=>{C.currentSnapshot.forEach((A,R)=>d.set(R,A))});let g=ey(t).map(C=>new Map(C));g=iy(e,g,d);let T=Fy(e,g);return new cs(e,g,h,T)}};var ts="@",yd="@.disabled",hs=class{namespaceId;delegate;engine;_onDestroy;\u0275type=0;constructor(e,t,r,i){this.namespaceId=e,this.delegate=t,this.engine=r,this._onDestroy=i}get data(){return this.delegate.data}destroyNode(e){this.delegate.destroyNode?.(e)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,r,i=!0){this.delegate.insertBefore(e,t,r),this.engine.onInsert(this.namespaceId,t,e,i)}removeChild(e,t,r){this.parentNode(t)&&this.engine.onRemove(this.namespaceId,t,this.delegate)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,r,i){this.delegate.setAttribute(e,t,r,i)}removeAttribute(e,t,r){this.delegate.removeAttribute(e,t,r)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,r,i){this.delegate.setStyle(e,t,r,i)}removeStyle(e,t,r){this.delegate.removeStyle(e,t,r)}setProperty(e,t,r){t.charAt(0)==ts&&t==yd?this.disableAnimations(e,!!r):this.delegate.setProperty(e,t,r)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,r,i){return this.delegate.listen(e,t,r,i)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}},Xo=class extends hs{factory;constructor(e,t,r,i,o){super(t,r,i,o),this.factory=e,this.namespaceId=t}setProperty(e,t,r){t.charAt(0)==ts?t.charAt(1)=="."&&t==yd?(r=r===void 0?!0:!!r,this.disableAnimations(e,r)):this.engine.process(this.namespaceId,e,t.slice(1),r):this.delegate.setProperty(e,t,r)}listen(e,t,r,i){if(t.charAt(0)==ts){let o=Uy(e),a=t.slice(1),l="";return a.charAt(0)!=ts&&([a,l]=By(a)),this.engine.listen(this.namespaceId,o,a,l,h=>{let d=h._data||-1;this.factory.scheduleListenerCallback(d,r,h)})}return this.delegate.listen(e,t,r,i)}};function Uy(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}function By(n){let e=n.indexOf("."),t=n.substring(0,e),r=n.slice(e+1);return[t,r]}var ds=class{delegate;engine;_zone;_currentId=0;_microtaskId=1;_animationCallbacksBuffer=[];_rendererCache=new Map;_cdRecurDepth=0;constructor(e,t,r){this.delegate=e,this.engine=t,this._zone=r,t.onRemovalComplete=(i,o)=>{o?.removeChild(null,i)}}createRenderer(e,t){let r="",i=this.delegate.createRenderer(e,t);if(!e||!t?.data?.animation){let d=this._rendererCache,m=d.get(i);if(!m){let g=()=>d.delete(i);m=new hs(r,i,this.engine,g),d.set(i,m)}return m}let o=t.id,a=t.id+"-"+this._currentId;this._currentId++,this.engine.register(a,e);let l=d=>{Array.isArray(d)?d.forEach(l):this.engine.registerTrigger(o,a,e,d.name,d)};return t.data.animation.forEach(l),new Xo(this,a,i,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(e,t,r){if(e>=0&&e<this._microtaskId){this._zone.run(()=>t(r));return}let i=this._animationCallbacksBuffer;i.length==0&&queueMicrotask(()=>{this._zone.run(()=>{i.forEach(o=>{let[a,l]=o;a(l)}),this._animationCallbacksBuffer=[]})}),i.push([t,r])}end(){this._cdRecurDepth--,this._cdRecurDepth==0&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}componentReplaced(e){this.engine.flush(),this.delegate.componentReplaced?.(e)}};var zy=(()=>{class n extends tr{constructor(t,r,i){super(t,r,i)}ngOnDestroy(){this.flush()}static \u0275fac=function(r){return new(r||n)(Oe(Ju),Oe(bn),Oe(Sn))};static \u0275prov=Mt({token:n,factory:n.\u0275fac})}return n})();function Gy(){return new is}function Ky(n,e,t){return new ds(n,e,t)}var vd=[{provide:Sn,useFactory:Gy},{provide:tr,useClass:zy},{provide:zu,useFactory:Ky,deps:[nh,tr,ce]}],F0=[{provide:bn,useClass:ta},{provide:Eo,useValue:"NoopAnimations"},...vd],Wy=[{provide:bn,useFactory:()=>new us},{provide:Eo,useFactory:()=>"BrowserAnimations"},...vd];function wd(){return Bu("NgEagerAnimations"),[...Wy]}var fs="analytics",Hy="firebase_id",Qy="origin",Yy=60*1e3,Xy="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",ha="https://www.googletagmanager.com/gtag/js";var He=new It("@firebase/analytics");var Jy={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},it=new Xn("analytics","Analytics",Jy);function Zy(n){if(!n.startsWith(ha)){let e=it.create("invalid-gtag-resource",{gtagURL:n});return He.warn(e.message),""}return n}function Cd(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function ev(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function tv(n,e){let t=ev("firebase-js-sdk-policy",{createScriptURL:Zy}),r=document.createElement("script"),i=`${ha}?l=${n}&id=${e}`;r.src=t?t?.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}function nv(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}function rv(n,e,t,r,i,o){return x(this,null,function*(){let a=r[i];try{if(a)yield e[a];else{let h=(yield Cd(t)).find(d=>d.measurementId===i);h&&(yield e[h.appId])}}catch(l){He.error(l)}n("config",i,o)})}function iv(n,e,t,r,i){return x(this,null,function*(){try{let o=[];if(i&&i.send_to){let a=i.send_to;Array.isArray(a)||(a=[a]);let l=yield Cd(t);for(let h of a){let d=l.find(g=>g.measurementId===h),m=d&&e[d.appId];if(m)o.push(m);else{o=[];break}}}o.length===0&&(o=Object.values(e)),yield Promise.all(o),n("event",r,i||{})}catch(o){He.error(o)}})}function sv(n,e,t,r){function i(o,...a){return x(this,null,function*(){try{if(o==="event"){let[l,h]=a;yield iv(n,e,t,l,h)}else if(o==="config"){let[l,h]=a;yield rv(n,e,t,r,l,h)}else if(o==="consent"){let[l,h]=a;n("consent",l,h)}else if(o==="get"){let[l,h,d]=a;n("get",l,h,d)}else if(o==="set"){let[l]=a;n("set",l)}else n(o,...a)}catch(l){He.error(l)}})}return i}function ov(n,e,t,r,i){let o=function(...a){window[r].push(arguments)};return window[i]&&typeof window[i]=="function"&&(o=window[i]),window[i]=sv(o,n,e,t),{gtagCore:o,wrappedGtag:window[i]}}function av(n){let e=window.document.getElementsByTagName("script");for(let t of Object.values(e))if(t.src&&t.src.includes(ha)&&t.src.includes(n))return t;return null}var lv=30,cv=1e3,oa=class{constructor(e={},t=cv){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}},Rd=new oa;function uv(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}function hv(n){return x(this,null,function*(){var e;let{appId:t,apiKey:r}=n,i={method:"GET",headers:uv(r)},o=Xy.replace("{app-id}",t),a=yield fetch(o,i);if(a.status!==200&&a.status!==304){let l="";try{let h=yield a.json();!((e=h.error)===null||e===void 0)&&e.message&&(l=h.error.message)}catch{}throw it.create("config-fetch-failed",{httpStatus:a.status,responseMessage:l})}return a.json()})}function dv(r){return x(this,arguments,function*(n,e=Rd,t){let{appId:i,apiKey:o,measurementId:a}=n.options;if(!i)throw it.create("no-app-id");if(!o){if(a)return{measurementId:a,appId:i};throw it.create("no-api-key")}let l=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},h=new aa;return setTimeout(()=>x(this,null,function*(){h.abort()}),t!==void 0?t:Yy),Pd({appId:i,apiKey:o,measurementId:a},l,h,e)})}function Pd(o,a,l){return x(this,arguments,function*(n,{throttleEndTimeMillis:e,backoffCount:t},r,i=Rd){var h;let{appId:d,measurementId:m}=n;try{yield fv(r,e)}catch(g){if(m)return He.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${m} provided in the "measurementId" field in the local Firebase config. [${g?.message}]`),{appId:d,measurementId:m};throw g}try{let g=yield hv(n);return i.deleteThrottleMetadata(d),g}catch(g){let T=g;if(!pv(T)){if(i.deleteThrottleMetadata(d),m)return He.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${m} provided in the "measurementId" field in the local Firebase config. [${T?.message}]`),{appId:d,measurementId:m};throw g}let C=Number((h=T?.customData)===null||h===void 0?void 0:h.httpStatus)===503?jr(t,i.intervalMillis,lv):jr(t,i.intervalMillis),A={throttleEndTimeMillis:Date.now()+C,backoffCount:t+1};return i.setThrottleMetadata(d,A),He.debug(`Calling attemptFetch again in ${C} millis`),Pd(n,A,r,i)}})}function fv(n,e){return new Promise((t,r)=>{let i=Math.max(e-Date.now(),0),o=setTimeout(t,i);n.addEventListener(()=>{clearTimeout(o),r(it.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function pv(n){if(!(n instanceof Et)||!n.customData)return!1;let e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}var aa=class{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}};var la;function mv(n,e,t,r,i){return x(this,null,function*(){if(i&&i.global){n("event",t,r);return}else{let o=yield e,a=Object.assign(Object.assign({},r),{send_to:o});n("event",t,a)}})}function gv(n,e,t,r){return x(this,null,function*(){if(r&&r.global)return n("set",{user_id:t}),Promise.resolve();{let i=yield e;n("config",i,{update:!0,user_id:t})}})}var ca;function _v(n){ca=n}function yv(n){la=n}function vv(){return x(this,null,function*(){if(nn())try{yield Yn()}catch(n){return He.warn(it.create("indexeddb-unavailable",{errorInfo:n?.toString()}).message),!1}else return He.warn(it.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0})}function wv(n,e,t,r,i,o,a){return x(this,null,function*(){var l;let h=dv(n);h.then(C=>{t[C.measurementId]=C.appId,n.options.measurementId&&C.measurementId!==n.options.measurementId&&He.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${C.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(C=>He.error(C)),e.push(h);let d=vv().then(C=>{if(C)return r.getId()}),[m,g]=yield Promise.all([h,d]);av(o)||tv(o,m.measurementId),ca&&(i("consent","default",ca),_v(void 0)),i("js",new Date);let T=(l=a?.config)!==null&&l!==void 0?l:{};return T[Qy]="firebase",T.update=!0,g!=null&&(T[Hy]=g),i("config",m.measurementId,T),la&&(i("set",la),yv(void 0)),m.measurementId})}var ua=class{constructor(e){this.app=e}_delete(){return delete nr[this.app.options.appId],Promise.resolve()}},nr={},Ed=[],Td={},sa="dataLayer",Ev="gtag",Id,da,bd=!1;function Tv(){let n=[];if(bo()&&n.push("This is a browser extension environment."),Br()||n.push("Cookies are not available."),n.length>0){let e=n.map((r,i)=>`(${i+1}) ${r}`).join(" "),t=it.create("invalid-analytics-context",{errorInfo:e});He.warn(t.message)}}function Iv(n,e,t){Tv();let r=n.options.appId;if(!r)throw it.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)He.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw it.create("no-api-key");if(nr[r]!=null)throw it.create("already-exists",{id:r});if(!bd){nv(sa);let{wrappedGtag:o,gtagCore:a}=ov(nr,Ed,Td,sa,Ev);da=o,Id=a,bd=!0}return nr[r]=wv(n,Ed,Td,e,Id,sa,t),new ua(n)}function Nd(n=$e()){n=ye(n);let e=Me(n,fs);return e.isInitialized()?e.getImmediate():kd(n)}function kd(n,e={}){let t=Me(n,fs);if(t.isInitialized()){let i=t.getImmediate();if(rn(e,t.getOptions()))return i;throw it.create("already-initialized")}return t.initialize({options:e})}function Dd(){return x(this,null,function*(){if(bo()||!Br()||!nn())return!1;try{return yield Yn()}catch{return!1}})}function xd(n,e,t){n=ye(n),gv(da,nr[n.app.options.appId],e,t).catch(r=>He.error(r))}function fa(n,e,t,r){n=ye(n),mv(da,nr[n.app.options.appId],e,t,r).catch(i=>He.error(i))}var Sd="@firebase/analytics",Ad="0.10.12";function bv(){Ae(new Se(fs,(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();return Iv(r,i,t)},"PUBLIC")),Ae(new Se("analytics-internal",n,"PRIVATE")),B(Sd,Ad),B(Sd,Ad,"esm2017");function n(e){try{let t=e.getProvider(fs).getImmediate();return{logEvent:(r,i,o)=>fa(t,r,i,o)}}catch(t){throw it.create("interop-component-reg-failed",{reason:t})}}}bv();var An=class{constructor(e){return e}},Fd="analytics",ma=class{constructor(){return Re(Fd)}};var Ld=_e(Nd,!0);var Vd=_e(Dd,!1),Sv=_e(fa,!1,2);var Av=_e(xd,!0,2);var _a=(()=>{class n{initialized;disposables=[];constructor(t,r,i){B("angularfire",ve.full,"user-tracking");let o;this.initialized=r.runOutsideAngular(()=>new Promise(a=>{o=a})),Vd().then(()=>{let a=i.get(An);a?this.disposables=[Ph(t).subscribe(l=>{Av(a,l?.uid),o()})]:o()})}ngOnDestroy(){this.disposables.forEach(t=>t.unsubscribe())}static \u0275fac=function(r){return new(r||n)(Oe(Ch),Oe(ce),Oe(me))};static \u0275prov=Mt({token:n,factory:n.\u0275fac})}return n})(),Cv="firebase_event_origin",Rv="firebase_previous_class",Pv="firebase_previous_id",Nv="firebase_previous_screen",kv="firebase_screen_class",Od="firebase_screen_id",Dv="firebase_screen",ga="outlet",xv="page_path",Ov="page_title",Xr="screen_class",Md="screen_name",Mv="screen_view",Fv="auto",Lv="#",Vv=Math.floor(Math.random()*(2**32-1))-2**31,pa={},Uv=n=>{let e=[n[Xr],n[ga]].join(Lv);if(pa.hasOwnProperty(e))return pa[e];{let t=Vv++;return pa[e]=t,t}},Bv=(n,e,t)=>n.events.pipe(vo(i=>i instanceof sh)).pipe(wo(i=>{let a=n.parseUrl(n.url.replace(/(?:\().+(?:\))/g,T=>T.replace("://",":///"))).root.children[i.snapshot.outlet]?.toString()||"",l=n.routerState.root.children.map(T=>T).find(T=>T.outlet===i.snapshot.outlet);if(!l)return Fr(null);let h=l;for(;h.firstChild;)h=h.firstChild;let d=h.pathFromRoot.map(T=>T.routeConfig?.path).filter(T=>T).join("/")||"/",m={[Md]:d,[xv]:`/${a}`,[Cv]:Fv,[Dv]:d,[ga]:i.snapshot.outlet};e&&(m[Ov]=e.getTitle());let g=l.component;if(g){if(g===ah){let T=i.snapshot;for(;T.firstChild;)T=T.firstChild;g=T.component}}else g=i.snapshot.component;if(typeof g=="string")return Fr(_o(Ot({},m),{[Xr]:g}));if(g){let T=t.resolveComponentFactory(g);return Fr(_o(Ot({},m),{[Xr]:T.selector}))}return Fr(null)}),vo(i=>!!i),yo(i=>Ot({[kv]:i[Xr],[Od]:Uv(i)},i)),Fu(i=>i[ga]),Ou(i=>i.pipe(Mu((o,a)=>JSON.stringify(o)===JSON.stringify(a)),Vu(void 0),Lu(),yo(([o,a])=>o?Ot({[Rv]:o[Xr],[Nv]:o[Md],[Pv]:o[Od]},a):a)))),Ud=(()=>{class n{disposable;constructor(t,r,i,o,a,l){B("angularfire",ve.full,"screen-tracking"),Vd().then(()=>{let h=l.get(An);!t||!h||o.runOutsideAngular(()=>{this.disposable=Bv(t,r,i).pipe(wo(d=>x(this,null,function*(){return a&&(yield a.initialized),Sv(h,Mv,d)}))).subscribe()})})}ngOnDestroy(){this.disposable&&this.disposable.unsubscribe()}static \u0275fac=function(r){return new(r||n)(Oe(en,8),Oe(ih,8),Oe(ju),Oe(ce),Oe(_a,8),Oe(me))};static \u0275prov=Mt({token:n,factory:n.\u0275fac})}return n})(),ya=new we("angularfire2.analytics-instances");function qv(n,e,t){if(!Kn(t))return null;let r=Ce(Fd,n,e);return r&&new An(r)}function $v(n){return(e,t,r)=>{if(!Kn(r))return null;let i=e.runOutsideAngular(()=>n(t));return new An(i)}}var jv={provide:ma,deps:[[new K,ya]]},zv={provide:An,useFactory:qv,deps:[[new K,ya],Ne,lt]};function Bd(n,...e){return B("angularfire",ve.full,"analytics"),Ee([zv,jv,{provide:ya,useFactory:$v(n),multi:!0,deps:[ce,me,lt,Pe,ke,...e]}])}var qd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},$d={};var ps,jd;(function(){var n;function e(w,p){function y(){}y.prototype=p.prototype,w.D=p.prototype,w.prototype=new y,w.prototype.constructor=w,w.C=function(v,E,b){for(var _=Array(arguments.length-2),ot=2;ot<arguments.length;ot++)_[ot-2]=arguments[ot];return p.prototype[E].apply(v,_)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(w,p,y){y||(y=0);var v=Array(16);if(typeof p=="string")for(var E=0;16>E;++E)v[E]=p.charCodeAt(y++)|p.charCodeAt(y++)<<8|p.charCodeAt(y++)<<16|p.charCodeAt(y++)<<24;else for(E=0;16>E;++E)v[E]=p[y++]|p[y++]<<8|p[y++]<<16|p[y++]<<24;p=w.g[0],y=w.g[1],E=w.g[2];var b=w.g[3],_=p+(b^y&(E^b))+v[0]+3614090360&4294967295;p=y+(_<<7&4294967295|_>>>25),_=b+(E^p&(y^E))+v[1]+3905402710&4294967295,b=p+(_<<12&4294967295|_>>>20),_=E+(y^b&(p^y))+v[2]+606105819&4294967295,E=b+(_<<17&4294967295|_>>>15),_=y+(p^E&(b^p))+v[3]+3250441966&4294967295,y=E+(_<<22&4294967295|_>>>10),_=p+(b^y&(E^b))+v[4]+4118548399&4294967295,p=y+(_<<7&4294967295|_>>>25),_=b+(E^p&(y^E))+v[5]+1200080426&4294967295,b=p+(_<<12&4294967295|_>>>20),_=E+(y^b&(p^y))+v[6]+2821735955&4294967295,E=b+(_<<17&4294967295|_>>>15),_=y+(p^E&(b^p))+v[7]+4249261313&4294967295,y=E+(_<<22&4294967295|_>>>10),_=p+(b^y&(E^b))+v[8]+1770035416&4294967295,p=y+(_<<7&4294967295|_>>>25),_=b+(E^p&(y^E))+v[9]+2336552879&4294967295,b=p+(_<<12&4294967295|_>>>20),_=E+(y^b&(p^y))+v[10]+4294925233&4294967295,E=b+(_<<17&4294967295|_>>>15),_=y+(p^E&(b^p))+v[11]+2304563134&4294967295,y=E+(_<<22&4294967295|_>>>10),_=p+(b^y&(E^b))+v[12]+1804603682&4294967295,p=y+(_<<7&4294967295|_>>>25),_=b+(E^p&(y^E))+v[13]+4254626195&4294967295,b=p+(_<<12&4294967295|_>>>20),_=E+(y^b&(p^y))+v[14]+2792965006&4294967295,E=b+(_<<17&4294967295|_>>>15),_=y+(p^E&(b^p))+v[15]+1236535329&4294967295,y=E+(_<<22&4294967295|_>>>10),_=p+(E^b&(y^E))+v[1]+4129170786&4294967295,p=y+(_<<5&4294967295|_>>>27),_=b+(y^E&(p^y))+v[6]+3225465664&4294967295,b=p+(_<<9&4294967295|_>>>23),_=E+(p^y&(b^p))+v[11]+643717713&4294967295,E=b+(_<<14&4294967295|_>>>18),_=y+(b^p&(E^b))+v[0]+3921069994&4294967295,y=E+(_<<20&4294967295|_>>>12),_=p+(E^b&(y^E))+v[5]+3593408605&4294967295,p=y+(_<<5&4294967295|_>>>27),_=b+(y^E&(p^y))+v[10]+38016083&4294967295,b=p+(_<<9&4294967295|_>>>23),_=E+(p^y&(b^p))+v[15]+3634488961&4294967295,E=b+(_<<14&4294967295|_>>>18),_=y+(b^p&(E^b))+v[4]+3889429448&4294967295,y=E+(_<<20&4294967295|_>>>12),_=p+(E^b&(y^E))+v[9]+568446438&4294967295,p=y+(_<<5&4294967295|_>>>27),_=b+(y^E&(p^y))+v[14]+3275163606&4294967295,b=p+(_<<9&4294967295|_>>>23),_=E+(p^y&(b^p))+v[3]+4107603335&4294967295,E=b+(_<<14&4294967295|_>>>18),_=y+(b^p&(E^b))+v[8]+1163531501&4294967295,y=E+(_<<20&4294967295|_>>>12),_=p+(E^b&(y^E))+v[13]+2850285829&4294967295,p=y+(_<<5&4294967295|_>>>27),_=b+(y^E&(p^y))+v[2]+4243563512&4294967295,b=p+(_<<9&4294967295|_>>>23),_=E+(p^y&(b^p))+v[7]+1735328473&4294967295,E=b+(_<<14&4294967295|_>>>18),_=y+(b^p&(E^b))+v[12]+2368359562&4294967295,y=E+(_<<20&4294967295|_>>>12),_=p+(y^E^b)+v[5]+4294588738&4294967295,p=y+(_<<4&4294967295|_>>>28),_=b+(p^y^E)+v[8]+2272392833&4294967295,b=p+(_<<11&4294967295|_>>>21),_=E+(b^p^y)+v[11]+1839030562&4294967295,E=b+(_<<16&4294967295|_>>>16),_=y+(E^b^p)+v[14]+4259657740&4294967295,y=E+(_<<23&4294967295|_>>>9),_=p+(y^E^b)+v[1]+2763975236&4294967295,p=y+(_<<4&4294967295|_>>>28),_=b+(p^y^E)+v[4]+1272893353&4294967295,b=p+(_<<11&4294967295|_>>>21),_=E+(b^p^y)+v[7]+4139469664&4294967295,E=b+(_<<16&4294967295|_>>>16),_=y+(E^b^p)+v[10]+3200236656&4294967295,y=E+(_<<23&4294967295|_>>>9),_=p+(y^E^b)+v[13]+681279174&4294967295,p=y+(_<<4&4294967295|_>>>28),_=b+(p^y^E)+v[0]+3936430074&4294967295,b=p+(_<<11&4294967295|_>>>21),_=E+(b^p^y)+v[3]+3572445317&4294967295,E=b+(_<<16&4294967295|_>>>16),_=y+(E^b^p)+v[6]+76029189&4294967295,y=E+(_<<23&4294967295|_>>>9),_=p+(y^E^b)+v[9]+3654602809&4294967295,p=y+(_<<4&4294967295|_>>>28),_=b+(p^y^E)+v[12]+3873151461&4294967295,b=p+(_<<11&4294967295|_>>>21),_=E+(b^p^y)+v[15]+530742520&4294967295,E=b+(_<<16&4294967295|_>>>16),_=y+(E^b^p)+v[2]+3299628645&4294967295,y=E+(_<<23&4294967295|_>>>9),_=p+(E^(y|~b))+v[0]+4096336452&4294967295,p=y+(_<<6&4294967295|_>>>26),_=b+(y^(p|~E))+v[7]+1126891415&4294967295,b=p+(_<<10&4294967295|_>>>22),_=E+(p^(b|~y))+v[14]+2878612391&4294967295,E=b+(_<<15&4294967295|_>>>17),_=y+(b^(E|~p))+v[5]+4237533241&4294967295,y=E+(_<<21&4294967295|_>>>11),_=p+(E^(y|~b))+v[12]+1700485571&4294967295,p=y+(_<<6&4294967295|_>>>26),_=b+(y^(p|~E))+v[3]+2399980690&4294967295,b=p+(_<<10&4294967295|_>>>22),_=E+(p^(b|~y))+v[10]+4293915773&4294967295,E=b+(_<<15&4294967295|_>>>17),_=y+(b^(E|~p))+v[1]+2240044497&4294967295,y=E+(_<<21&4294967295|_>>>11),_=p+(E^(y|~b))+v[8]+1873313359&4294967295,p=y+(_<<6&4294967295|_>>>26),_=b+(y^(p|~E))+v[15]+4264355552&4294967295,b=p+(_<<10&4294967295|_>>>22),_=E+(p^(b|~y))+v[6]+2734768916&4294967295,E=b+(_<<15&4294967295|_>>>17),_=y+(b^(E|~p))+v[13]+1309151649&4294967295,y=E+(_<<21&4294967295|_>>>11),_=p+(E^(y|~b))+v[4]+4149444226&4294967295,p=y+(_<<6&4294967295|_>>>26),_=b+(y^(p|~E))+v[11]+3174756917&4294967295,b=p+(_<<10&4294967295|_>>>22),_=E+(p^(b|~y))+v[2]+718787259&4294967295,E=b+(_<<15&4294967295|_>>>17),_=y+(b^(E|~p))+v[9]+3951481745&4294967295,w.g[0]=w.g[0]+p&4294967295,w.g[1]=w.g[1]+(E+(_<<21&4294967295|_>>>11))&4294967295,w.g[2]=w.g[2]+E&4294967295,w.g[3]=w.g[3]+b&4294967295}r.prototype.u=function(w,p){p===void 0&&(p=w.length);for(var y=p-this.blockSize,v=this.B,E=this.h,b=0;b<p;){if(E==0)for(;b<=y;)i(this,w,b),b+=this.blockSize;if(typeof w=="string"){for(;b<p;)if(v[E++]=w.charCodeAt(b++),E==this.blockSize){i(this,v),E=0;break}}else for(;b<p;)if(v[E++]=w[b++],E==this.blockSize){i(this,v),E=0;break}}this.h=E,this.o+=p},r.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var p=1;p<w.length-8;++p)w[p]=0;var y=8*this.o;for(p=w.length-8;p<w.length;++p)w[p]=y&255,y/=256;for(this.u(w),w=Array(16),p=y=0;4>p;++p)for(var v=0;32>v;v+=8)w[y++]=this.g[p]>>>v&255;return w};function o(w,p){var y=l;return Object.prototype.hasOwnProperty.call(y,w)?y[w]:y[w]=p(w)}function a(w,p){this.h=p;for(var y=[],v=!0,E=w.length-1;0<=E;E--){var b=w[E]|0;v&&b==p||(y[E]=b,v=!1)}this.g=y}var l={};function h(w){return-128<=w&&128>w?o(w,function(p){return new a([p|0],0>p?-1:0)}):new a([w|0],0>w?-1:0)}function d(w){if(isNaN(w)||!isFinite(w))return g;if(0>w)return P(d(-w));for(var p=[],y=1,v=0;w>=y;v++)p[v]=w/y|0,y*=4294967296;return new a(p,0)}function m(w,p){if(w.length==0)throw Error("number format error: empty string");if(p=p||10,2>p||36<p)throw Error("radix out of range: "+p);if(w.charAt(0)=="-")return P(m(w.substring(1),p));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var y=d(Math.pow(p,8)),v=g,E=0;E<w.length;E+=8){var b=Math.min(8,w.length-E),_=parseInt(w.substring(E,E+b),p);8>b?(b=d(Math.pow(p,b)),v=v.j(b).add(d(_))):(v=v.j(y),v=v.add(d(_)))}return v}var g=h(0),T=h(1),C=h(16777216);n=a.prototype,n.m=function(){if(R(this))return-P(this).m();for(var w=0,p=1,y=0;y<this.g.length;y++){var v=this.i(y);w+=(0<=v?v:4294967296+v)*p,p*=4294967296}return w},n.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(A(this))return"0";if(R(this))return"-"+P(this).toString(w);for(var p=d(Math.pow(w,6)),y=this,v="";;){var E=q(y,p).g;y=U(y,E.j(p));var b=((0<y.g.length?y.g[0]:y.h)>>>0).toString(w);if(y=E,A(y))return b+v;for(;6>b.length;)b="0"+b;v=b+v}},n.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function A(w){if(w.h!=0)return!1;for(var p=0;p<w.g.length;p++)if(w.g[p]!=0)return!1;return!0}function R(w){return w.h==-1}n.l=function(w){return w=U(this,w),R(w)?-1:A(w)?0:1};function P(w){for(var p=w.g.length,y=[],v=0;v<p;v++)y[v]=~w.g[v];return new a(y,~w.h).add(T)}n.abs=function(){return R(this)?P(this):this},n.add=function(w){for(var p=Math.max(this.g.length,w.g.length),y=[],v=0,E=0;E<=p;E++){var b=v+(this.i(E)&65535)+(w.i(E)&65535),_=(b>>>16)+(this.i(E)>>>16)+(w.i(E)>>>16);v=_>>>16,b&=65535,_&=65535,y[E]=_<<16|b}return new a(y,y[y.length-1]&-2147483648?-1:0)};function U(w,p){return w.add(P(p))}n.j=function(w){if(A(this)||A(w))return g;if(R(this))return R(w)?P(this).j(P(w)):P(P(this).j(w));if(R(w))return P(this.j(P(w)));if(0>this.l(C)&&0>w.l(C))return d(this.m()*w.m());for(var p=this.g.length+w.g.length,y=[],v=0;v<2*p;v++)y[v]=0;for(v=0;v<this.g.length;v++)for(var E=0;E<w.g.length;E++){var b=this.i(v)>>>16,_=this.i(v)&65535,ot=w.i(E)>>>16,Wt=w.i(E)&65535;y[2*v+2*E]+=_*Wt,$(y,2*v+2*E),y[2*v+2*E+1]+=b*Wt,$(y,2*v+2*E+1),y[2*v+2*E+1]+=_*ot,$(y,2*v+2*E+1),y[2*v+2*E+2]+=b*ot,$(y,2*v+2*E+2)}for(v=0;v<p;v++)y[v]=y[2*v+1]<<16|y[2*v];for(v=p;v<2*p;v++)y[v]=0;return new a(y,0)};function $(w,p){for(;(w[p]&65535)!=w[p];)w[p+1]+=w[p]>>>16,w[p]&=65535,p++}function j(w,p){this.g=w,this.h=p}function q(w,p){if(A(p))throw Error("division by zero");if(A(w))return new j(g,g);if(R(w))return p=q(P(w),p),new j(P(p.g),P(p.h));if(R(p))return p=q(w,P(p)),new j(P(p.g),p.h);if(30<w.g.length){if(R(w)||R(p))throw Error("slowDivide_ only works with positive integers.");for(var y=T,v=p;0>=v.l(w);)y=Ve(y),v=Ve(v);var E=ie(y,1),b=ie(v,1);for(v=ie(v,2),y=ie(y,2);!A(v);){var _=b.add(v);0>=_.l(w)&&(E=E.add(y),b=_),v=ie(v,1),y=ie(y,1)}return p=U(w,E.j(p)),new j(E,p)}for(E=g;0<=w.l(p);){for(y=Math.max(1,Math.floor(w.m()/p.m())),v=Math.ceil(Math.log(y)/Math.LN2),v=48>=v?1:Math.pow(2,v-48),b=d(y),_=b.j(p);R(_)||0<_.l(w);)y-=v,b=d(y),_=b.j(p);A(b)&&(b=T),E=E.add(b),w=U(w,_)}return new j(E,w)}n.A=function(w){return q(this,w).h},n.and=function(w){for(var p=Math.max(this.g.length,w.g.length),y=[],v=0;v<p;v++)y[v]=this.i(v)&w.i(v);return new a(y,this.h&w.h)},n.or=function(w){for(var p=Math.max(this.g.length,w.g.length),y=[],v=0;v<p;v++)y[v]=this.i(v)|w.i(v);return new a(y,this.h|w.h)},n.xor=function(w){for(var p=Math.max(this.g.length,w.g.length),y=[],v=0;v<p;v++)y[v]=this.i(v)^w.i(v);return new a(y,this.h^w.h)};function Ve(w){for(var p=w.g.length+1,y=[],v=0;v<p;v++)y[v]=w.i(v)<<1|w.i(v-1)>>>31;return new a(y,w.h)}function ie(w,p){var y=p>>5;p%=32;for(var v=w.g.length-y,E=[],b=0;b<v;b++)E[b]=0<p?w.i(b+y)>>>p|w.i(b+y+1)<<32-p:w.i(b+y);return new a(E,w.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,jd=$d.Md5=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=m,ps=$d.Integer=a}).apply(typeof qd<"u"?qd:typeof self<"u"?self:typeof window<"u"?window:{});var ms=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},qt={};var zd,Gv,Gd,Kd,Wd,Hd,Qd,Yd,Xd;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(s,c,u){return s==Array.prototype||s==Object.prototype||(s[c]=u.value),s};function t(s){s=[typeof globalThis=="object"&&globalThis,s,typeof window=="object"&&window,typeof self=="object"&&self,typeof ms=="object"&&ms];for(var c=0;c<s.length;++c){var u=s[c];if(u&&u.Math==Math)return u}throw Error("Cannot find global object")}var r=t(this);function i(s,c){if(c)e:{var u=r;s=s.split(".");for(var f=0;f<s.length-1;f++){var I=s[f];if(!(I in u))break e;u=u[I]}s=s[s.length-1],f=u[s],c=c(f),c!=f&&c!=null&&e(u,s,{configurable:!0,writable:!0,value:c})}}function o(s,c){s instanceof String&&(s+="");var u=0,f=!1,I={next:function(){if(!f&&u<s.length){var S=u++;return{value:c(S,s[S]),done:!1}}return f=!0,{done:!0,value:void 0}}};return I[Symbol.iterator]=function(){return I},I}i("Array.prototype.values",function(s){return s||function(){return o(this,function(c,u){return u})}});var a=a||{},l=this||self;function h(s){var c=typeof s;return c=c!="object"?c:s?Array.isArray(s)?"array":c:"null",c=="array"||c=="object"&&typeof s.length=="number"}function d(s){var c=typeof s;return c=="object"&&s!=null||c=="function"}function m(s,c,u){return s.call.apply(s.bind,arguments)}function g(s,c,u){if(!s)throw Error();if(2<arguments.length){var f=Array.prototype.slice.call(arguments,2);return function(){var I=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(I,f),s.apply(c,I)}}return function(){return s.apply(c,arguments)}}function T(s,c,u){return T=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?m:g,T.apply(null,arguments)}function C(s,c){var u=Array.prototype.slice.call(arguments,1);return function(){var f=u.slice();return f.push.apply(f,arguments),s.apply(this,f)}}function A(s,c){function u(){}u.prototype=c.prototype,s.aa=c.prototype,s.prototype=new u,s.prototype.constructor=s,s.Qb=function(f,I,S){for(var N=Array(arguments.length-2),te=2;te<arguments.length;te++)N[te-2]=arguments[te];return c.prototype[I].apply(f,N)}}function R(s){let c=s.length;if(0<c){let u=Array(c);for(let f=0;f<c;f++)u[f]=s[f];return u}return[]}function P(s,c){for(let u=1;u<arguments.length;u++){let f=arguments[u];if(h(f)){let I=s.length||0,S=f.length||0;s.length=I+S;for(let N=0;N<S;N++)s[I+N]=f[N]}else s.push(f)}}class U{constructor(c,u){this.i=c,this.j=u,this.h=0,this.g=null}get(){let c;return 0<this.h?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function $(s){return/^[\s\xa0]*$/.test(s)}function j(){var s=l.navigator;return s&&(s=s.userAgent)?s:""}function q(s){return q[" "](s),s}q[" "]=function(){};var Ve=j().indexOf("Gecko")!=-1&&!(j().toLowerCase().indexOf("webkit")!=-1&&j().indexOf("Edge")==-1)&&!(j().indexOf("Trident")!=-1||j().indexOf("MSIE")!=-1)&&j().indexOf("Edge")==-1;function ie(s,c,u){for(let f in s)c.call(u,s[f],f,s)}function w(s,c){for(let u in s)c.call(void 0,s[u],u,s)}function p(s){let c={};for(let u in s)c[u]=s[u];return c}let y="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function v(s,c){let u,f;for(let I=1;I<arguments.length;I++){f=arguments[I];for(u in f)s[u]=f[u];for(let S=0;S<y.length;S++)u=y[S],Object.prototype.hasOwnProperty.call(f,u)&&(s[u]=f[u])}}function E(s){var c=1;s=s.split(":");let u=[];for(;0<c&&s.length;)u.push(s.shift()),c--;return s.length&&u.push(s.join(":")),u}function b(s){l.setTimeout(()=>{throw s},0)}function _(){var s=G;let c=null;return s.g&&(c=s.g,s.g=s.g.next,s.g||(s.h=null),c.next=null),c}class ot{constructor(){this.h=this.g=null}add(c,u){let f=Wt.get();f.set(c,u),this.h?this.h.next=f:this.g=f,this.h=f}}var Wt=new U(()=>new M,s=>s.reset());class M{constructor(){this.next=this.g=this.h=null}set(c,u){this.h=c,this.g=u,this.next=null}reset(){this.next=this.g=this.h=null}}let F,L=!1,G=new ot,pe=()=>{let s=l.Promise.resolve(void 0);F=()=>{s.then(at)}};var at=()=>{for(var s;s=_();){try{s.h.call(s.g)}catch(u){b(u)}var c=Wt;c.j(s),100>c.h&&(c.h++,s.next=c.g,c.g=s)}L=!1};function he(){this.s=this.s,this.C=this.C}he.prototype.s=!1,he.prototype.ma=function(){this.s||(this.s=!0,this.N())},he.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function se(s,c){this.type=s,this.g=this.target=c,this.defaultPrevented=!1}se.prototype.h=function(){this.defaultPrevented=!0};var oe=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var s=!1,c=Object.defineProperty({},"passive",{get:function(){s=!0}});try{let u=()=>{};l.addEventListener("test",u,c),l.removeEventListener("test",u,c)}catch{}return s}();function Ht(s,c){if(se.call(this,s?s.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,s){var u=this.type=s.type,f=s.changedTouches&&s.changedTouches.length?s.changedTouches[0]:null;if(this.target=s.target||s.srcElement,this.g=c,c=s.relatedTarget){if(Ve){e:{try{q(c.nodeName);var I=!0;break e}catch{}I=!1}I||(c=null)}}else u=="mouseover"?c=s.fromElement:u=="mouseout"&&(c=s.toElement);this.relatedTarget=c,f?(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0):(this.clientX=s.clientX!==void 0?s.clientX:s.pageX,this.clientY=s.clientY!==void 0?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0),this.button=s.button,this.key=s.key||"",this.ctrlKey=s.ctrlKey,this.altKey=s.altKey,this.shiftKey=s.shiftKey,this.metaKey=s.metaKey,this.pointerId=s.pointerId||0,this.pointerType=typeof s.pointerType=="string"?s.pointerType:Gs[s.pointerType]||"",this.state=s.state,this.i=s,s.defaultPrevented&&Ht.aa.h.call(this)}}A(Ht,se);var Gs={2:"touch",3:"pen",4:"mouse"};Ht.prototype.h=function(){Ht.aa.h.call(this);var s=this.i;s.preventDefault?s.preventDefault():s.returnValue=!1};var de="closure_listenable_"+(1e6*Math.random()|0),Nt=0;function Xe(s,c,u,f,I){this.listener=s,this.proxy=null,this.src=c,this.type=u,this.capture=!!f,this.ha=I,this.key=++Nt,this.da=this.fa=!1}function kt(s){s.da=!0,s.listener=null,s.proxy=null,s.src=null,s.ha=null}function Qt(s){this.src=s,this.g={},this.h=0}Qt.prototype.add=function(s,c,u,f,I){var S=s.toString();s=this.g[S],s||(s=this.g[S]=[],this.h++);var N=Ws(s,c,f,I);return-1<N?(c=s[N],u||(c.fa=!1)):(c=new Xe(c,this.src,S,!!f,I),c.fa=u,s.push(c)),c};function Ks(s,c){var u=c.type;if(u in s.g){var f=s.g[u],I=Array.prototype.indexOf.call(f,c,void 0),S;(S=0<=I)&&Array.prototype.splice.call(f,I,1),S&&(kt(c),s.g[u].length==0&&(delete s.g[u],s.h--))}}function Ws(s,c,u,f){for(var I=0;I<s.length;++I){var S=s[I];if(!S.da&&S.listener==c&&S.capture==!!u&&S.ha==f)return I}return-1}var Hs="closure_lm_"+(1e6*Math.random()|0),Qs={};function xc(s,c,u,f,I){if(f&&f.once)return Mc(s,c,u,f,I);if(Array.isArray(c)){for(var S=0;S<c.length;S++)xc(s,c[S],u,f,I);return null}return u=Zs(u),s&&s[de]?s.K(c,u,d(f)?!!f.capture:!!f,I):Oc(s,c,u,!1,f,I)}function Oc(s,c,u,f,I,S){if(!c)throw Error("Invalid event type");var N=d(I)?!!I.capture:!!I,te=Xs(s);if(te||(s[Hs]=te=new Qt(s)),u=te.add(c,u,f,N,S),u.proxy)return u;if(f=Cg(),u.proxy=f,f.src=s,f.listener=u,s.addEventListener)oe||(I=N),I===void 0&&(I=!1),s.addEventListener(c.toString(),f,I);else if(s.attachEvent)s.attachEvent(Lc(c.toString()),f);else if(s.addListener&&s.removeListener)s.addListener(f);else throw Error("addEventListener and attachEvent are unavailable.");return u}function Cg(){function s(u){return c.call(s.src,s.listener,u)}let c=Rg;return s}function Mc(s,c,u,f,I){if(Array.isArray(c)){for(var S=0;S<c.length;S++)Mc(s,c[S],u,f,I);return null}return u=Zs(u),s&&s[de]?s.L(c,u,d(f)?!!f.capture:!!f,I):Oc(s,c,u,!0,f,I)}function Fc(s,c,u,f,I){if(Array.isArray(c))for(var S=0;S<c.length;S++)Fc(s,c[S],u,f,I);else f=d(f)?!!f.capture:!!f,u=Zs(u),s&&s[de]?(s=s.i,c=String(c).toString(),c in s.g&&(S=s.g[c],u=Ws(S,u,f,I),-1<u&&(kt(S[u]),Array.prototype.splice.call(S,u,1),S.length==0&&(delete s.g[c],s.h--)))):s&&(s=Xs(s))&&(c=s.g[c.toString()],s=-1,c&&(s=Ws(c,u,f,I)),(u=-1<s?c[s]:null)&&Ys(u))}function Ys(s){if(typeof s!="number"&&s&&!s.da){var c=s.src;if(c&&c[de])Ks(c.i,s);else{var u=s.type,f=s.proxy;c.removeEventListener?c.removeEventListener(u,f,s.capture):c.detachEvent?c.detachEvent(Lc(u),f):c.addListener&&c.removeListener&&c.removeListener(f),(u=Xs(c))?(Ks(u,s),u.h==0&&(u.src=null,c[Hs]=null)):kt(s)}}}function Lc(s){return s in Qs?Qs[s]:Qs[s]="on"+s}function Rg(s,c){if(s.da)s=!0;else{c=new Ht(c,this);var u=s.listener,f=s.ha||s.src;s.fa&&Ys(s),s=u.call(f,c)}return s}function Xs(s){return s=s[Hs],s instanceof Qt?s:null}var Js="__closure_events_fn_"+(1e9*Math.random()>>>0);function Zs(s){return typeof s=="function"?s:(s[Js]||(s[Js]=function(c){return s.handleEvent(c)}),s[Js])}function Ue(){he.call(this),this.i=new Qt(this),this.M=this,this.F=null}A(Ue,he),Ue.prototype[de]=!0,Ue.prototype.removeEventListener=function(s,c,u,f){Fc(this,s,c,u,f)};function Ke(s,c){var u,f=s.F;if(f)for(u=[];f;f=f.F)u.push(f);if(s=s.M,f=c.type||c,typeof c=="string")c=new se(c,s);else if(c instanceof se)c.target=c.target||s;else{var I=c;c=new se(f,s),v(c,I)}if(I=!0,u)for(var S=u.length-1;0<=S;S--){var N=c.g=u[S];I=Ai(N,f,!0,c)&&I}if(N=c.g=s,I=Ai(N,f,!0,c)&&I,I=Ai(N,f,!1,c)&&I,u)for(S=0;S<u.length;S++)N=c.g=u[S],I=Ai(N,f,!1,c)&&I}Ue.prototype.N=function(){if(Ue.aa.N.call(this),this.i){var s=this.i,c;for(c in s.g){for(var u=s.g[c],f=0;f<u.length;f++)kt(u[f]);delete s.g[c],s.h--}}this.F=null},Ue.prototype.K=function(s,c,u,f){return this.i.add(String(s),c,!1,u,f)},Ue.prototype.L=function(s,c,u,f){return this.i.add(String(s),c,!0,u,f)};function Ai(s,c,u,f){if(c=s.i.g[String(c)],!c)return!0;c=c.concat();for(var I=!0,S=0;S<c.length;++S){var N=c[S];if(N&&!N.da&&N.capture==u){var te=N.listener,xe=N.ha||N.src;N.fa&&Ks(s.i,N),I=te.call(xe,f)!==!1&&I}}return I&&!f.defaultPrevented}function Vc(s,c,u){if(typeof s=="function")u&&(s=T(s,u));else if(s&&typeof s.handleEvent=="function")s=T(s.handleEvent,s);else throw Error("Invalid listener argument");return 2147483647<Number(c)?-1:l.setTimeout(s,c||0)}function Uc(s){s.g=Vc(()=>{s.g=null,s.i&&(s.i=!1,Uc(s))},s.l);let c=s.h;s.h=null,s.m.apply(null,c)}class Pg extends he{constructor(c,u){super(),this.m=c,this.l=u,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:Uc(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Tr(s){he.call(this),this.h=s,this.g={}}A(Tr,he);var Bc=[];function qc(s){ie(s.g,function(c,u){this.g.hasOwnProperty(u)&&Ys(c)},s),s.g={}}Tr.prototype.N=function(){Tr.aa.N.call(this),qc(this)},Tr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var eo=l.JSON.stringify,Ng=l.JSON.parse,kg=class{stringify(s){return l.JSON.stringify(s,void 0)}parse(s){return l.JSON.parse(s,void 0)}};function to(){}to.prototype.h=null;function $c(s){return s.h||(s.h=s.i())}function jc(){}var Ir={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function no(){se.call(this,"d")}A(no,se);function ro(){se.call(this,"c")}A(ro,se);var pn={},zc=null;function Ci(){return zc=zc||new Ue}pn.La="serverreachability";function Gc(s){se.call(this,pn.La,s)}A(Gc,se);function br(s){let c=Ci();Ke(c,new Gc(c))}pn.STAT_EVENT="statevent";function Kc(s,c){se.call(this,pn.STAT_EVENT,s),this.stat=c}A(Kc,se);function We(s){let c=Ci();Ke(c,new Kc(c,s))}pn.Ma="timingevent";function Wc(s,c){se.call(this,pn.Ma,s),this.size=c}A(Wc,se);function Sr(s,c){if(typeof s!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){s()},c)}function Ar(){this.g=!0}Ar.prototype.xa=function(){this.g=!1};function Dg(s,c,u,f,I,S){s.info(function(){if(s.g)if(S)for(var N="",te=S.split("&"),xe=0;xe<te.length;xe++){var Z=te[xe].split("=");if(1<Z.length){var Be=Z[0];Z=Z[1];var qe=Be.split("_");N=2<=qe.length&&qe[1]=="type"?N+(Be+"="+Z+"&"):N+(Be+"=redacted&")}}else N=null;else N=S;return"XMLHTTP REQ ("+f+") [attempt "+I+"]: "+c+`
`+u+`
`+N})}function xg(s,c,u,f,I,S,N){s.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+I+"]: "+c+`
`+u+`
`+S+" "+N})}function Ln(s,c,u,f){s.info(function(){return"XMLHTTP TEXT ("+c+"): "+Mg(s,u)+(f?" "+f:"")})}function Og(s,c){s.info(function(){return"TIMEOUT: "+c})}Ar.prototype.info=function(){};function Mg(s,c){if(!s.g)return c;if(!c)return null;try{var u=JSON.parse(c);if(u){for(s=0;s<u.length;s++)if(Array.isArray(u[s])){var f=u[s];if(!(2>f.length)){var I=f[1];if(Array.isArray(I)&&!(1>I.length)){var S=I[0];if(S!="noop"&&S!="stop"&&S!="close")for(var N=1;N<I.length;N++)I[N]=""}}}}return eo(u)}catch{return c}}var Ri={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Hc={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},io;function Pi(){}A(Pi,to),Pi.prototype.g=function(){return new XMLHttpRequest},Pi.prototype.i=function(){return{}},io=new Pi;function Yt(s,c,u,f){this.j=s,this.i=c,this.l=u,this.R=f||1,this.U=new Tr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Qc}function Qc(){this.i=null,this.g="",this.h=!1}var Yc={},so={};function oo(s,c,u){s.L=1,s.v=xi(Dt(c)),s.m=u,s.P=!0,Xc(s,null)}function Xc(s,c){s.F=Date.now(),Ni(s),s.A=Dt(s.v);var u=s.A,f=s.R;Array.isArray(f)||(f=[String(f)]),hu(u.i,"t",f),s.C=0,u=s.j.J,s.h=new Qc,s.g=Pu(s.j,u?c:null,!s.m),0<s.O&&(s.M=new Pg(T(s.Y,s,s.g),s.O)),c=s.U,u=s.g,f=s.ca;var I="readystatechange";Array.isArray(I)||(I&&(Bc[0]=I.toString()),I=Bc);for(var S=0;S<I.length;S++){var N=xc(u,I[S],f||c.handleEvent,!1,c.h||c);if(!N)break;c.g[N.key]=N}c=s.H?p(s.H):{},s.m?(s.u||(s.u="POST"),c["Content-Type"]="application/x-www-form-urlencoded",s.g.ea(s.A,s.u,s.m,c)):(s.u="GET",s.g.ea(s.A,s.u,null,c)),br(),Dg(s.i,s.u,s.A,s.l,s.R,s.m)}Yt.prototype.ca=function(s){s=s.target;let c=this.M;c&&xt(s)==3?c.j():this.Y(s)},Yt.prototype.Y=function(s){try{if(s==this.g)e:{let qe=xt(this.g);var c=this.g.Ba();let Bn=this.g.Z();if(!(3>qe)&&(qe!=3||this.g&&(this.h.h||this.g.oa()||yu(this.g)))){this.J||qe!=4||c==7||(c==8||0>=Bn?br(3):br(2)),ao(this);var u=this.g.Z();this.X=u;t:if(Jc(this)){var f=yu(this.g);s="";var I=f.length,S=xt(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){mn(this),Cr(this);var N="";break t}this.h.i=new l.TextDecoder}for(c=0;c<I;c++)this.h.h=!0,s+=this.h.i.decode(f[c],{stream:!(S&&c==I-1)});f.length=0,this.h.g+=s,this.C=0,N=this.h.g}else N=this.g.oa();if(this.o=u==200,xg(this.i,this.u,this.A,this.l,this.R,qe,u),this.o){if(this.T&&!this.K){t:{if(this.g){var te,xe=this.g;if((te=xe.g?xe.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!$(te)){var Z=te;break t}}Z=null}if(u=Z)Ln(this.i,this.l,u,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,lo(this,u);else{this.o=!1,this.s=3,We(12),mn(this),Cr(this);break e}}if(this.P){u=!0;let ft;for(;!this.J&&this.C<N.length;)if(ft=Fg(this,N),ft==so){qe==4&&(this.s=4,We(14),u=!1),Ln(this.i,this.l,null,"[Incomplete Response]");break}else if(ft==Yc){this.s=4,We(15),Ln(this.i,this.l,N,"[Invalid Chunk]"),u=!1;break}else Ln(this.i,this.l,ft,null),lo(this,ft);if(Jc(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),qe!=4||N.length!=0||this.h.h||(this.s=1,We(16),u=!1),this.o=this.o&&u,!u)Ln(this.i,this.l,N,"[Invalid Chunked Response]"),mn(this),Cr(this);else if(0<N.length&&!this.W){this.W=!0;var Be=this.j;Be.g==this&&Be.ba&&!Be.M&&(Be.j.info("Great, no buffering proxy detected. Bytes received: "+N.length),mo(Be),Be.M=!0,We(11))}}else Ln(this.i,this.l,N,null),lo(this,N);qe==4&&mn(this),this.o&&!this.J&&(qe==4?Su(this.j,this):(this.o=!1,Ni(this)))}else Zg(this.g),u==400&&0<N.indexOf("Unknown SID")?(this.s=3,We(12)):(this.s=0,We(13)),mn(this),Cr(this)}}}catch{}finally{}};function Jc(s){return s.g?s.u=="GET"&&s.L!=2&&s.j.Ca:!1}function Fg(s,c){var u=s.C,f=c.indexOf(`
`,u);return f==-1?so:(u=Number(c.substring(u,f)),isNaN(u)?Yc:(f+=1,f+u>c.length?so:(c=c.slice(f,f+u),s.C=f+u,c)))}Yt.prototype.cancel=function(){this.J=!0,mn(this)};function Ni(s){s.S=Date.now()+s.I,Zc(s,s.I)}function Zc(s,c){if(s.B!=null)throw Error("WatchDog timer not null");s.B=Sr(T(s.ba,s),c)}function ao(s){s.B&&(l.clearTimeout(s.B),s.B=null)}Yt.prototype.ba=function(){this.B=null;let s=Date.now();0<=s-this.S?(Og(this.i,this.A),this.L!=2&&(br(),We(17)),mn(this),this.s=2,Cr(this)):Zc(this,this.S-s)};function Cr(s){s.j.G==0||s.J||Su(s.j,s)}function mn(s){ao(s);var c=s.M;c&&typeof c.ma=="function"&&c.ma(),s.M=null,qc(s.U),s.g&&(c=s.g,s.g=null,c.abort(),c.ma())}function lo(s,c){try{var u=s.j;if(u.G!=0&&(u.g==s||co(u.h,s))){if(!s.K&&co(u.h,s)&&u.G==3){try{var f=u.Da.g.parse(c)}catch{f=null}if(Array.isArray(f)&&f.length==3){var I=f;if(I[0]==0){e:if(!u.u){if(u.g)if(u.g.F+3e3<s.F)Vi(u),Fi(u);else break e;po(u),We(18)}}else u.za=I[1],0<u.za-u.T&&37500>I[2]&&u.F&&u.v==0&&!u.C&&(u.C=Sr(T(u.Za,u),6e3));if(1>=nu(u.h)&&u.ca){try{u.ca()}catch{}u.ca=void 0}}else _n(u,11)}else if((s.K||u.g==s)&&Vi(u),!$(c))for(I=u.Da.g.parse(c),c=0;c<I.length;c++){let Z=I[c];if(u.T=Z[0],Z=Z[1],u.G==2)if(Z[0]=="c"){u.K=Z[1],u.ia=Z[2];let Be=Z[3];Be!=null&&(u.la=Be,u.j.info("VER="+u.la));let qe=Z[4];qe!=null&&(u.Aa=qe,u.j.info("SVER="+u.Aa));let Bn=Z[5];Bn!=null&&typeof Bn=="number"&&0<Bn&&(f=1.5*Bn,u.L=f,u.j.info("backChannelRequestTimeoutMs_="+f)),f=u;let ft=s.g;if(ft){let Bi=ft.g?ft.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Bi){var S=f.h;S.g||Bi.indexOf("spdy")==-1&&Bi.indexOf("quic")==-1&&Bi.indexOf("h2")==-1||(S.j=S.l,S.g=new Set,S.h&&(uo(S,S.h),S.h=null))}if(f.D){let go=ft.g?ft.g.getResponseHeader("X-HTTP-Session-Id"):null;go&&(f.ya=go,ae(f.I,f.D,go))}}u.G=3,u.l&&u.l.ua(),u.ba&&(u.R=Date.now()-s.F,u.j.info("Handshake RTT: "+u.R+"ms")),f=u;var N=s;if(f.qa=Ru(f,f.J?f.ia:null,f.W),N.K){ru(f.h,N);var te=N,xe=f.L;xe&&(te.I=xe),te.B&&(ao(te),Ni(te)),f.g=N}else Iu(f);0<u.i.length&&Li(u)}else Z[0]!="stop"&&Z[0]!="close"||_n(u,7);else u.G==3&&(Z[0]=="stop"||Z[0]=="close"?Z[0]=="stop"?_n(u,7):fo(u):Z[0]!="noop"&&u.l&&u.l.ta(Z),u.v=0)}}br(4)}catch{}}var Lg=class{constructor(s,c){this.g=s,this.map=c}};function eu(s){this.l=s||10,l.PerformanceNavigationTiming?(s=l.performance.getEntriesByType("navigation"),s=0<s.length&&(s[0].nextHopProtocol=="hq"||s[0].nextHopProtocol=="h2")):s=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=s?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function tu(s){return s.h?!0:s.g?s.g.size>=s.j:!1}function nu(s){return s.h?1:s.g?s.g.size:0}function co(s,c){return s.h?s.h==c:s.g?s.g.has(c):!1}function uo(s,c){s.g?s.g.add(c):s.h=c}function ru(s,c){s.h&&s.h==c?s.h=null:s.g&&s.g.has(c)&&s.g.delete(c)}eu.prototype.cancel=function(){if(this.i=iu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let s of this.g.values())s.cancel();this.g.clear()}};function iu(s){if(s.h!=null)return s.i.concat(s.h.D);if(s.g!=null&&s.g.size!==0){let c=s.i;for(let u of s.g.values())c=c.concat(u.D);return c}return R(s.i)}function Vg(s){if(s.V&&typeof s.V=="function")return s.V();if(typeof Map<"u"&&s instanceof Map||typeof Set<"u"&&s instanceof Set)return Array.from(s.values());if(typeof s=="string")return s.split("");if(h(s)){for(var c=[],u=s.length,f=0;f<u;f++)c.push(s[f]);return c}c=[],u=0;for(f in s)c[u++]=s[f];return c}function Ug(s){if(s.na&&typeof s.na=="function")return s.na();if(!s.V||typeof s.V!="function"){if(typeof Map<"u"&&s instanceof Map)return Array.from(s.keys());if(!(typeof Set<"u"&&s instanceof Set)){if(h(s)||typeof s=="string"){var c=[];s=s.length;for(var u=0;u<s;u++)c.push(u);return c}c=[],u=0;for(let f in s)c[u++]=f;return c}}}function su(s,c){if(s.forEach&&typeof s.forEach=="function")s.forEach(c,void 0);else if(h(s)||typeof s=="string")Array.prototype.forEach.call(s,c,void 0);else for(var u=Ug(s),f=Vg(s),I=f.length,S=0;S<I;S++)c.call(void 0,f[S],u&&u[S],s)}var ou=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Bg(s,c){if(s){s=s.split("&");for(var u=0;u<s.length;u++){var f=s[u].indexOf("="),I=null;if(0<=f){var S=s[u].substring(0,f);I=s[u].substring(f+1)}else S=s[u];c(S,I?decodeURIComponent(I.replace(/\+/g," ")):"")}}}function gn(s){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,s instanceof gn){this.h=s.h,ki(this,s.j),this.o=s.o,this.g=s.g,Di(this,s.s),this.l=s.l;var c=s.i,u=new Nr;u.i=c.i,c.g&&(u.g=new Map(c.g),u.h=c.h),au(this,u),this.m=s.m}else s&&(c=String(s).match(ou))?(this.h=!1,ki(this,c[1]||"",!0),this.o=Rr(c[2]||""),this.g=Rr(c[3]||"",!0),Di(this,c[4]),this.l=Rr(c[5]||"",!0),au(this,c[6]||"",!0),this.m=Rr(c[7]||"")):(this.h=!1,this.i=new Nr(null,this.h))}gn.prototype.toString=function(){var s=[],c=this.j;c&&s.push(Pr(c,lu,!0),":");var u=this.g;return(u||c=="file")&&(s.push("//"),(c=this.o)&&s.push(Pr(c,lu,!0),"@"),s.push(encodeURIComponent(String(u)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u=this.s,u!=null&&s.push(":",String(u))),(u=this.l)&&(this.g&&u.charAt(0)!="/"&&s.push("/"),s.push(Pr(u,u.charAt(0)=="/"?jg:$g,!0))),(u=this.i.toString())&&s.push("?",u),(u=this.m)&&s.push("#",Pr(u,Gg)),s.join("")};function Dt(s){return new gn(s)}function ki(s,c,u){s.j=u?Rr(c,!0):c,s.j&&(s.j=s.j.replace(/:$/,""))}function Di(s,c){if(c){if(c=Number(c),isNaN(c)||0>c)throw Error("Bad port number "+c);s.s=c}else s.s=null}function au(s,c,u){c instanceof Nr?(s.i=c,Kg(s.i,s.h)):(u||(c=Pr(c,zg)),s.i=new Nr(c,s.h))}function ae(s,c,u){s.i.set(c,u)}function xi(s){return ae(s,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),s}function Rr(s,c){return s?c?decodeURI(s.replace(/%25/g,"%2525")):decodeURIComponent(s):""}function Pr(s,c,u){return typeof s=="string"?(s=encodeURI(s).replace(c,qg),u&&(s=s.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),s):null}function qg(s){return s=s.charCodeAt(0),"%"+(s>>4&15).toString(16)+(s&15).toString(16)}var lu=/[#\/\?@]/g,$g=/[#\?:]/g,jg=/[#\?]/g,zg=/[#\?@]/g,Gg=/#/g;function Nr(s,c){this.h=this.g=null,this.i=s||null,this.j=!!c}function Xt(s){s.g||(s.g=new Map,s.h=0,s.i&&Bg(s.i,function(c,u){s.add(decodeURIComponent(c.replace(/\+/g," ")),u)}))}n=Nr.prototype,n.add=function(s,c){Xt(this),this.i=null,s=Vn(this,s);var u=this.g.get(s);return u||this.g.set(s,u=[]),u.push(c),this.h+=1,this};function cu(s,c){Xt(s),c=Vn(s,c),s.g.has(c)&&(s.i=null,s.h-=s.g.get(c).length,s.g.delete(c))}function uu(s,c){return Xt(s),c=Vn(s,c),s.g.has(c)}n.forEach=function(s,c){Xt(this),this.g.forEach(function(u,f){u.forEach(function(I){s.call(c,I,f,this)},this)},this)},n.na=function(){Xt(this);let s=Array.from(this.g.values()),c=Array.from(this.g.keys()),u=[];for(let f=0;f<c.length;f++){let I=s[f];for(let S=0;S<I.length;S++)u.push(c[f])}return u},n.V=function(s){Xt(this);let c=[];if(typeof s=="string")uu(this,s)&&(c=c.concat(this.g.get(Vn(this,s))));else{s=Array.from(this.g.values());for(let u=0;u<s.length;u++)c=c.concat(s[u])}return c},n.set=function(s,c){return Xt(this),this.i=null,s=Vn(this,s),uu(this,s)&&(this.h-=this.g.get(s).length),this.g.set(s,[c]),this.h+=1,this},n.get=function(s,c){return s?(s=this.V(s),0<s.length?String(s[0]):c):c};function hu(s,c,u){cu(s,c),0<u.length&&(s.i=null,s.g.set(Vn(s,c),R(u)),s.h+=u.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let s=[],c=Array.from(this.g.keys());for(var u=0;u<c.length;u++){var f=c[u];let S=encodeURIComponent(String(f)),N=this.V(f);for(f=0;f<N.length;f++){var I=S;N[f]!==""&&(I+="="+encodeURIComponent(String(N[f]))),s.push(I)}}return this.i=s.join("&")};function Vn(s,c){return c=String(c),s.j&&(c=c.toLowerCase()),c}function Kg(s,c){c&&!s.j&&(Xt(s),s.i=null,s.g.forEach(function(u,f){var I=f.toLowerCase();f!=I&&(cu(this,f),hu(this,I,u))},s)),s.j=c}function Wg(s,c){let u=new Ar;if(l.Image){let f=new Image;f.onload=C(Jt,u,"TestLoadImage: loaded",!0,c,f),f.onerror=C(Jt,u,"TestLoadImage: error",!1,c,f),f.onabort=C(Jt,u,"TestLoadImage: abort",!1,c,f),f.ontimeout=C(Jt,u,"TestLoadImage: timeout",!1,c,f),l.setTimeout(function(){f.ontimeout&&f.ontimeout()},1e4),f.src=s}else c(!1)}function Hg(s,c){let u=new Ar,f=new AbortController,I=setTimeout(()=>{f.abort(),Jt(u,"TestPingServer: timeout",!1,c)},1e4);fetch(s,{signal:f.signal}).then(S=>{clearTimeout(I),S.ok?Jt(u,"TestPingServer: ok",!0,c):Jt(u,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(I),Jt(u,"TestPingServer: error",!1,c)})}function Jt(s,c,u,f,I){try{I&&(I.onload=null,I.onerror=null,I.onabort=null,I.ontimeout=null),f(u)}catch{}}function Qg(){this.g=new kg}function Yg(s,c,u){let f=u||"";try{su(s,function(I,S){let N=I;d(I)&&(N=eo(I)),c.push(f+S+"="+encodeURIComponent(N))})}catch(I){throw c.push(f+"type="+encodeURIComponent("_badmap")),I}}function kr(s){this.l=s.Ub||null,this.j=s.eb||!1}A(kr,to),kr.prototype.g=function(){return new Oi(this.l,this.j)},kr.prototype.i=function(s){return function(){return s}}({});function Oi(s,c){Ue.call(this),this.D=s,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}A(Oi,Ue),n=Oi.prototype,n.open=function(s,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=s,this.A=c,this.readyState=1,xr(this)},n.send=function(s){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let c={headers:this.u,method:this.B,credentials:this.m,cache:void 0};s&&(c.body=s),(this.D||l).fetch(new Request(this.A,c)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Dr(this)),this.readyState=0},n.Sa=function(s){if(this.g&&(this.l=s,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=s.headers,this.readyState=2,xr(this)),this.g&&(this.readyState=3,xr(this),this.g)))if(this.responseType==="arraybuffer")s.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in s){if(this.j=s.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;du(this)}else s.text().then(this.Ra.bind(this),this.ga.bind(this))};function du(s){s.j.read().then(s.Pa.bind(s)).catch(s.ga.bind(s))}n.Pa=function(s){if(this.g){if(this.o&&s.value)this.response.push(s.value);else if(!this.o){var c=s.value?s.value:new Uint8Array(0);(c=this.v.decode(c,{stream:!s.done}))&&(this.response=this.responseText+=c)}s.done?Dr(this):xr(this),this.readyState==3&&du(this)}},n.Ra=function(s){this.g&&(this.response=this.responseText=s,Dr(this))},n.Qa=function(s){this.g&&(this.response=s,Dr(this))},n.ga=function(){this.g&&Dr(this)};function Dr(s){s.readyState=4,s.l=null,s.j=null,s.v=null,xr(s)}n.setRequestHeader=function(s,c){this.u.append(s,c)},n.getResponseHeader=function(s){return this.h&&this.h.get(s.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let s=[],c=this.h.entries();for(var u=c.next();!u.done;)u=u.value,s.push(u[0]+": "+u[1]),u=c.next();return s.join(`\r
`)};function xr(s){s.onreadystatechange&&s.onreadystatechange.call(s)}Object.defineProperty(Oi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(s){this.m=s?"include":"same-origin"}});function fu(s){let c="";return ie(s,function(u,f){c+=f,c+=":",c+=u,c+=`\r
`}),c}function ho(s,c,u){e:{for(f in u){var f=!1;break e}f=!0}f||(u=fu(u),typeof s=="string"?u!=null&&encodeURIComponent(String(u)):ae(s,c,u))}function fe(s){Ue.call(this),this.headers=new Map,this.o=s||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}A(fe,Ue);var Xg=/^https?$/i,Jg=["POST","PUT"];n=fe.prototype,n.Ha=function(s){this.J=s},n.ea=function(s,c,u,f){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+s);c=c?c.toUpperCase():"GET",this.D=s,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():io.g(),this.v=this.o?$c(this.o):$c(io),this.g.onreadystatechange=T(this.Ea,this);try{this.B=!0,this.g.open(c,String(s),!0),this.B=!1}catch(S){pu(this,S);return}if(s=u||"",u=new Map(this.headers),f)if(Object.getPrototypeOf(f)===Object.prototype)for(var I in f)u.set(I,f[I]);else if(typeof f.keys=="function"&&typeof f.get=="function")for(let S of f.keys())u.set(S,f.get(S));else throw Error("Unknown input type for opt_headers: "+String(f));f=Array.from(u.keys()).find(S=>S.toLowerCase()=="content-type"),I=l.FormData&&s instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Jg,c,void 0))||f||I||u.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[S,N]of u)this.g.setRequestHeader(S,N);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{_u(this),this.u=!0,this.g.send(s),this.u=!1}catch(S){pu(this,S)}};function pu(s,c){s.h=!1,s.g&&(s.j=!0,s.g.abort(),s.j=!1),s.l=c,s.m=5,mu(s),Mi(s)}function mu(s){s.A||(s.A=!0,Ke(s,"complete"),Ke(s,"error"))}n.abort=function(s){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=s||7,Ke(this,"complete"),Ke(this,"abort"),Mi(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Mi(this,!0)),fe.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?gu(this):this.bb())},n.bb=function(){gu(this)};function gu(s){if(s.h&&typeof a<"u"&&(!s.v[1]||xt(s)!=4||s.Z()!=2)){if(s.u&&xt(s)==4)Vc(s.Ea,0,s);else if(Ke(s,"readystatechange"),xt(s)==4){s.h=!1;try{let N=s.Z();e:switch(N){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var u;if(!(u=c)){var f;if(f=N===0){var I=String(s.D).match(ou)[1]||null;!I&&l.self&&l.self.location&&(I=l.self.location.protocol.slice(0,-1)),f=!Xg.test(I?I.toLowerCase():"")}u=f}if(u)Ke(s,"complete"),Ke(s,"success");else{s.m=6;try{var S=2<xt(s)?s.g.statusText:""}catch{S=""}s.l=S+" ["+s.Z()+"]",mu(s)}}finally{Mi(s)}}}}function Mi(s,c){if(s.g){_u(s);let u=s.g,f=s.v[0]?()=>{}:null;s.g=null,s.v=null,c||Ke(s,"ready");try{u.onreadystatechange=f}catch{}}}function _u(s){s.I&&(l.clearTimeout(s.I),s.I=null)}n.isActive=function(){return!!this.g};function xt(s){return s.g?s.g.readyState:0}n.Z=function(){try{return 2<xt(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(s){if(this.g){var c=this.g.responseText;return s&&c.indexOf(s)==0&&(c=c.substring(s.length)),Ng(c)}};function yu(s){try{if(!s.g)return null;if("response"in s.g)return s.g.response;switch(s.H){case"":case"text":return s.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in s.g)return s.g.mozResponseArrayBuffer}return null}catch{return null}}function Zg(s){let c={};s=(s.g&&2<=xt(s)&&s.g.getAllResponseHeaders()||"").split(`\r
`);for(let f=0;f<s.length;f++){if($(s[f]))continue;var u=E(s[f]);let I=u[0];if(u=u[1],typeof u!="string")continue;u=u.trim();let S=c[I]||[];c[I]=S,S.push(u)}w(c,function(f){return f.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Or(s,c,u){return u&&u.internalChannelParams&&u.internalChannelParams[s]||c}function vu(s){this.Aa=0,this.i=[],this.j=new Ar,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Or("failFast",!1,s),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Or("baseRetryDelayMs",5e3,s),this.cb=Or("retryDelaySeedMs",1e4,s),this.Wa=Or("forwardChannelMaxRetries",2,s),this.wa=Or("forwardChannelRequestTimeoutMs",2e4,s),this.pa=s&&s.xmlHttpFactory||void 0,this.Xa=s&&s.Tb||void 0,this.Ca=s&&s.useFetchStreams||!1,this.L=void 0,this.J=s&&s.supportsCrossDomainXhr||!1,this.K="",this.h=new eu(s&&s.concurrentRequestLimit),this.Da=new Qg,this.P=s&&s.fastHandshake||!1,this.O=s&&s.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=s&&s.Rb||!1,s&&s.xa&&this.j.xa(),s&&s.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&s&&s.detectBufferingProxy||!1,this.ja=void 0,s&&s.longPollingTimeout&&0<s.longPollingTimeout&&(this.ja=s.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=vu.prototype,n.la=8,n.G=1,n.connect=function(s,c,u,f){We(0),this.W=s,this.H=c||{},u&&f!==void 0&&(this.H.OSID=u,this.H.OAID=f),this.F=this.X,this.I=Ru(this,null,this.W),Li(this)};function fo(s){if(wu(s),s.G==3){var c=s.U++,u=Dt(s.I);if(ae(u,"SID",s.K),ae(u,"RID",c),ae(u,"TYPE","terminate"),Mr(s,u),c=new Yt(s,s.j,c),c.L=2,c.v=xi(Dt(u)),u=!1,l.navigator&&l.navigator.sendBeacon)try{u=l.navigator.sendBeacon(c.v.toString(),"")}catch{}!u&&l.Image&&(new Image().src=c.v,u=!0),u||(c.g=Pu(c.j,null),c.g.ea(c.v)),c.F=Date.now(),Ni(c)}Cu(s)}function Fi(s){s.g&&(mo(s),s.g.cancel(),s.g=null)}function wu(s){Fi(s),s.u&&(l.clearTimeout(s.u),s.u=null),Vi(s),s.h.cancel(),s.s&&(typeof s.s=="number"&&l.clearTimeout(s.s),s.s=null)}function Li(s){if(!tu(s.h)&&!s.s){s.s=!0;var c=s.Ga;F||pe(),L||(F(),L=!0),G.add(c,s),s.B=0}}function e_(s,c){return nu(s.h)>=s.h.j-(s.s?1:0)?!1:s.s?(s.i=c.D.concat(s.i),!0):s.G==1||s.G==2||s.B>=(s.Va?0:s.Wa)?!1:(s.s=Sr(T(s.Ga,s,c),Au(s,s.B)),s.B++,!0)}n.Ga=function(s){if(this.s)if(this.s=null,this.G==1){if(!s){this.U=Math.floor(1e5*Math.random()),s=this.U++;let I=new Yt(this,this.j,s),S=this.o;if(this.S&&(S?(S=p(S),v(S,this.S)):S=this.S),this.m!==null||this.O||(I.H=S,S=null),this.P)e:{for(var c=0,u=0;u<this.i.length;u++){t:{var f=this.i[u];if("__data__"in f.map&&(f=f.map.__data__,typeof f=="string")){f=f.length;break t}f=void 0}if(f===void 0)break;if(c+=f,4096<c){c=u;break e}if(c===4096||u===this.i.length-1){c=u+1;break e}}c=1e3}else c=1e3;c=Tu(this,I,c),u=Dt(this.I),ae(u,"RID",s),ae(u,"CVER",22),this.D&&ae(u,"X-HTTP-Session-Id",this.D),Mr(this,u),S&&(this.O?c="headers="+encodeURIComponent(String(fu(S)))+"&"+c:this.m&&ho(u,this.m,S)),uo(this.h,I),this.Ua&&ae(u,"TYPE","init"),this.P?(ae(u,"$req",c),ae(u,"SID","null"),I.T=!0,oo(I,u,null)):oo(I,u,c),this.G=2}}else this.G==3&&(s?Eu(this,s):this.i.length==0||tu(this.h)||Eu(this))};function Eu(s,c){var u;c?u=c.l:u=s.U++;let f=Dt(s.I);ae(f,"SID",s.K),ae(f,"RID",u),ae(f,"AID",s.T),Mr(s,f),s.m&&s.o&&ho(f,s.m,s.o),u=new Yt(s,s.j,u,s.B+1),s.m===null&&(u.H=s.o),c&&(s.i=c.D.concat(s.i)),c=Tu(s,u,1e3),u.I=Math.round(.5*s.wa)+Math.round(.5*s.wa*Math.random()),uo(s.h,u),oo(u,f,c)}function Mr(s,c){s.H&&ie(s.H,function(u,f){ae(c,f,u)}),s.l&&su({},function(u,f){ae(c,f,u)})}function Tu(s,c,u){u=Math.min(s.i.length,u);var f=s.l?T(s.l.Na,s.l,s):null;e:{var I=s.i;let S=-1;for(;;){let N=["count="+u];S==-1?0<u?(S=I[0].g,N.push("ofs="+S)):S=0:N.push("ofs="+S);let te=!0;for(let xe=0;xe<u;xe++){let Z=I[xe].g,Be=I[xe].map;if(Z-=S,0>Z)S=Math.max(0,I[xe].g-100),te=!1;else try{Yg(Be,N,"req"+Z+"_")}catch{f&&f(Be)}}if(te){f=N.join("&");break e}}}return s=s.i.splice(0,u),c.D=s,f}function Iu(s){if(!s.g&&!s.u){s.Y=1;var c=s.Fa;F||pe(),L||(F(),L=!0),G.add(c,s),s.v=0}}function po(s){return s.g||s.u||3<=s.v?!1:(s.Y++,s.u=Sr(T(s.Fa,s),Au(s,s.v)),s.v++,!0)}n.Fa=function(){if(this.u=null,bu(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var s=2*this.R;this.j.info("BP detection timer enabled: "+s),this.A=Sr(T(this.ab,this),s)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,We(10),Fi(this),bu(this))};function mo(s){s.A!=null&&(l.clearTimeout(s.A),s.A=null)}function bu(s){s.g=new Yt(s,s.j,"rpc",s.Y),s.m===null&&(s.g.H=s.o),s.g.O=0;var c=Dt(s.qa);ae(c,"RID","rpc"),ae(c,"SID",s.K),ae(c,"AID",s.T),ae(c,"CI",s.F?"0":"1"),!s.F&&s.ja&&ae(c,"TO",s.ja),ae(c,"TYPE","xmlhttp"),Mr(s,c),s.m&&s.o&&ho(c,s.m,s.o),s.L&&(s.g.I=s.L);var u=s.g;s=s.ia,u.L=1,u.v=xi(Dt(c)),u.m=null,u.P=!0,Xc(u,s)}n.Za=function(){this.C!=null&&(this.C=null,Fi(this),po(this),We(19))};function Vi(s){s.C!=null&&(l.clearTimeout(s.C),s.C=null)}function Su(s,c){var u=null;if(s.g==c){Vi(s),mo(s),s.g=null;var f=2}else if(co(s.h,c))u=c.D,ru(s.h,c),f=1;else return;if(s.G!=0){if(c.o)if(f==1){u=c.m?c.m.length:0,c=Date.now()-c.F;var I=s.B;f=Ci(),Ke(f,new Wc(f,u)),Li(s)}else Iu(s);else if(I=c.s,I==3||I==0&&0<c.X||!(f==1&&e_(s,c)||f==2&&po(s)))switch(u&&0<u.length&&(c=s.h,c.i=c.i.concat(u)),I){case 1:_n(s,5);break;case 4:_n(s,10);break;case 3:_n(s,6);break;default:_n(s,2)}}}function Au(s,c){let u=s.Ta+Math.floor(Math.random()*s.cb);return s.isActive()||(u*=2),u*c}function _n(s,c){if(s.j.info("Error code "+c),c==2){var u=T(s.fb,s),f=s.Xa;let I=!f;f=new gn(f||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||ki(f,"https"),xi(f),I?Wg(f.toString(),u):Hg(f.toString(),u)}else We(2);s.G=0,s.l&&s.l.sa(c),Cu(s),wu(s)}n.fb=function(s){s?(this.j.info("Successfully pinged google.com"),We(2)):(this.j.info("Failed to ping google.com"),We(1))};function Cu(s){if(s.G=0,s.ka=[],s.l){let c=iu(s.h);(c.length!=0||s.i.length!=0)&&(P(s.ka,c),P(s.ka,s.i),s.h.i.length=0,R(s.i),s.i.length=0),s.l.ra()}}function Ru(s,c,u){var f=u instanceof gn?Dt(u):new gn(u);if(f.g!="")c&&(f.g=c+"."+f.g),Di(f,f.s);else{var I=l.location;f=I.protocol,c=c?c+"."+I.hostname:I.hostname,I=+I.port;var S=new gn(null);f&&ki(S,f),c&&(S.g=c),I&&Di(S,I),u&&(S.l=u),f=S}return u=s.D,c=s.ya,u&&c&&ae(f,u,c),ae(f,"VER",s.la),Mr(s,f),f}function Pu(s,c,u){if(c&&!s.J)throw Error("Can't create secondary domain capable XhrIo object.");return c=s.Ca&&!s.pa?new fe(new kr({eb:u})):new fe(s.pa),c.Ha(s.J),c}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Nu(){}n=Nu.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Ui(){}Ui.prototype.g=function(s,c){return new tt(s,c)};function tt(s,c){Ue.call(this),this.g=new vu(c),this.l=s,this.h=c&&c.messageUrlParams||null,s=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(s?s["X-Client-Protocol"]="webchannel":s={"X-Client-Protocol":"webchannel"}),this.g.o=s,s=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(s?s["X-WebChannel-Content-Type"]=c.messageContentType:s={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.va&&(s?s["X-WebChannel-Client-Profile"]=c.va:s={"X-WebChannel-Client-Profile":c.va}),this.g.S=s,(s=c&&c.Sb)&&!$(s)&&(this.g.m=s),this.v=c&&c.supportsCrossDomainXhr||!1,this.u=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!$(c)&&(this.g.D=c,s=this.h,s!==null&&c in s&&(s=this.h,c in s&&delete s[c])),this.j=new Un(this)}A(tt,Ue),tt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},tt.prototype.close=function(){fo(this.g)},tt.prototype.o=function(s){var c=this.g;if(typeof s=="string"){var u={};u.__data__=s,s=u}else this.u&&(u={},u.__data__=eo(s),s=u);c.i.push(new Lg(c.Ya++,s)),c.G==3&&Li(c)},tt.prototype.N=function(){this.g.l=null,delete this.j,fo(this.g),delete this.g,tt.aa.N.call(this)};function ku(s){no.call(this),s.__headers__&&(this.headers=s.__headers__,this.statusCode=s.__status__,delete s.__headers__,delete s.__status__);var c=s.__sm__;if(c){e:{for(let u in c){s=u;break e}s=void 0}(this.i=s)&&(s=this.i,c=c!==null&&s in c?c[s]:void 0),this.data=c}else this.data=s}A(ku,no);function Du(){ro.call(this),this.status=1}A(Du,ro);function Un(s){this.g=s}A(Un,Nu),Un.prototype.ua=function(){Ke(this.g,"a")},Un.prototype.ta=function(s){Ke(this.g,new ku(s))},Un.prototype.sa=function(s){Ke(this.g,new Du)},Un.prototype.ra=function(){Ke(this.g,"b")},Ui.prototype.createWebChannel=Ui.prototype.g,tt.prototype.send=tt.prototype.o,tt.prototype.open=tt.prototype.m,tt.prototype.close=tt.prototype.close,Xd=qt.createWebChannelTransport=function(){return new Ui},Yd=qt.getStatEventTarget=function(){return Ci()},Qd=qt.Event=pn,Hd=qt.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ri.NO_ERROR=0,Ri.TIMEOUT=8,Ri.HTTP_ERROR=6,Wd=qt.ErrorCode=Ri,Hc.COMPLETE="complete",Kd=qt.EventType=Hc,jc.EventType=Ir,Ir.OPEN="a",Ir.CLOSE="b",Ir.ERROR="c",Ir.MESSAGE="d",Ue.prototype.listen=Ue.prototype.K,Gd=qt.WebChannel=jc,Gv=qt.FetchXmlHttpFactory=kr,fe.prototype.listenOnce=fe.prototype.L,fe.prototype.getLastError=fe.prototype.Ka,fe.prototype.getLastErrorCode=fe.prototype.Ba,fe.prototype.getStatus=fe.prototype.Z,fe.prototype.getResponseJson=fe.prototype.Oa,fe.prototype.getResponseText=fe.prototype.oa,fe.prototype.send=fe.prototype.ea,fe.prototype.setWithCredentials=fe.prototype.Ha,zd=qt.XhrIo=fe}).apply(typeof ms<"u"?ms:typeof self<"u"?self:typeof window<"u"?window:{});var Jd="@firebase/firestore",Zd="4.7.10";var Fe=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Fe.UNAUTHENTICATED=new Fe(null),Fe.GOOGLE_CREDENTIALS=new Fe("google-credentials-uid"),Fe.FIRST_PARTY=new Fe("first-party-uid"),Fe.MOCK_USER=new Fe("mock-user");var Zr="11.5.0";var ir=new It("@firebase/firestore");function mt(n,...e){if(ir.logLevel<=sn.DEBUG){let t=e.map(Oa);ir.debug(`Firestore (${Zr}): ${n}`,...t)}}function lf(n,...e){if(ir.logLevel<=sn.ERROR){let t=e.map(Oa);ir.error(`Firestore (${Zr}): ${n}`,...t)}}function Kv(n,...e){if(ir.logLevel<=sn.WARN){let t=e.map(Oa);ir.warn(`Firestore (${Zr}): ${n}`,...t)}}function Oa(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function Je(n="Unexpected state"){let e=`FIRESTORE (${Zr}) INTERNAL ASSERTION FAILED: `+n;throw lf(e),new Error(e)}function Cn(n,e){n||Je()}var Qe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Le=class extends Et{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Rn=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var gs=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},wa=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Fe.UNAUTHENTICATED))}shutdown(){}},Ea=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Ta=class{constructor(e){this.t=e,this.currentUser=Fe.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Cn(this.o===void 0);let r=this.i,i=h=>this.i!==r?(r=this.i,t(h)):Promise.resolve(),o=new Rn;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Rn,e.enqueueRetryable(()=>i(this.currentUser))};let a=()=>{let h=o;e.enqueueRetryable(()=>x(this,null,function*(){yield h.promise,yield i(this.currentUser)}))},l=h=>{mt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(h=>l(h)),setTimeout(()=>{if(!this.auth){let h=this.t.getImmediate({optional:!0});h?l(h):(mt("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Rn)}},0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(mt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Cn(typeof r.accessToken=="string"),new gs(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return Cn(e===null||typeof e=="string"),new Fe(e)}},Ia=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=Fe.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);let e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}},ba=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new Ia(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Fe.FIRST_PARTY))}shutdown(){}invalidateToken(){}},_s=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Sa=class{constructor(e,t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null,this.V=null,Ut(e)&&e.settings.appCheckToken&&(this.V=e.settings.appCheckToken)}start(e,t){Cn(this.o===void 0);let r=o=>{o.error!=null&&mt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let a=o.token!==this.R;return this.R=o.token,mt("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};let i=o=>{mt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){let o=this.A.getImmediate({optional:!0});o?i(o):mt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.V)return Promise.resolve(new _s(this.V));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Cn(typeof t.token=="string"),this.R=t.token,new _s(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function Wv(){return new TextEncoder}function un(n,e){return n<e?-1:n>e?1:0}function Hv(n,e){let t=0;for(;t<n.length&&t<e.length;){let r=n.codePointAt(t),i=e.codePointAt(t);if(r!==i){if(r<128&&i<128)return un(r,i);{let o=Wv(),a=Qv(o.encode(ef(n,t)),o.encode(ef(e,t)));return a!==0?a:un(r,i)}}t+=r>65535?2:1}return un(n.length,e.length)}function ef(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function Qv(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return un(n[t],e[t]);return un(n.length,e.length)}var Aa=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&Je(),r===void 0?r=e.length-t:r>e.length-t&&Je(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let o=n.compareSegments(e.get(i),t.get(i));if(o!==0)return o}return un(e.length,t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):Hv(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ps.fromString(e.substring(4,e.length-2))}},cn=class n extends Aa{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new Le(Qe.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}};var Pn=class n{constructor(e){this.path=e}static fromPath(e){return new n(cn.fromString(e))}static fromName(e){return new n(cn.fromString(e).popFirst(5))}static empty(){return new n(cn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&cn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return cn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new cn(e.slice()))}};var Ca=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};Ca.UNKNOWN_ID=-1;function Yv(n){return n.name==="IndexedDbTransactionError"}function Xv(n){return n===0&&1/n==-1/0}var Jv="remoteDocuments",cf="owner";var uf="mutationQueues";var hf="mutations";var df="documentMutations",Zv="remoteDocumentsV14";var ff="remoteDocumentGlobal";var pf="targets";var mf="targetDocuments";var gf="targetGlobal",_f="collectionParents";var yf="clientMetadata";var vf="bundles";var wf="namedQueries";var ew="indexConfiguration";var tw="indexState";var nw="indexEntries";var Ef="documentOverlays";var rw="globals";var iw=[uf,hf,df,Jv,pf,cf,gf,mf,yf,ff,_f,vf,wf],MS=[...iw,Ef],sw=[uf,hf,df,Zv,pf,cf,gf,mf,yf,ff,_f,vf,wf,Ef],ow=sw,aw=[...ow,ew,tw,nw];var FS=[...aw,rw];var sr=class n{constructor(e,t){this.comparator=e,this.root=t||Rt.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Rt.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Rt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new rr(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new rr(this.root,e,this.comparator,!1)}getReverseIterator(){return new rr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new rr(this.root,e,this.comparator,!0)}},rr=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Rt=class n{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new n(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Je();let e=this.left.check();if(e!==this.right.check())throw Je();return e+(this.isRed()?0:1)}};Rt.EMPTY=null,Rt.RED=!0,Rt.BLACK=!1;Rt.EMPTY=new class{constructor(){this.size=0}get key(){throw Je()}get value(){throw Je()}get color(){throw Je()}get left(){throw Je()}get right(){throw Je()}copy(e,t,r,i,o){return this}insert(e,t,r){return new Rt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var ys=class n{constructor(e){this.comparator=e,this.data=new sr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new vs(this.data.getIterator())}getIteratorFrom(e){return new vs(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},vs=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Ra=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var or=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new Ra("Invalid base64 string: "+o):o}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let o="";for(let a=0;a<i.length;++a)o+=String.fromCharCode(i[a]);return o}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return un(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};or.EMPTY_BYTE_STRING=new or("");var lw=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function cw(n){if(Cn(!!n),typeof n=="string"){let e=0,t=lw.exec(n);if(Cn(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Jr(n.seconds),nanos:Jr(n.nanos)}}function Jr(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function uw(n){return typeof n=="string"?or.fromBase64String(n):or.fromUint8Array(n)}var Pa="(default)",Na=class n{constructor(e,t){this.projectId=e,this.database=t||Pa}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===Pa}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Tf="__type__",hw="__max__";var If="__vector__",bf="value";function dw(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[Tf])===null||t===void 0?void 0:t.stringValue)===If}function fw(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===hw}var VS={mapValue:{fields:{[Tf]:{stringValue:If},[bf]:{arrayValue:{}}}}};var US=new sr(Pn.comparator);var BS=new sr(Pn.comparator);var qS=new sr(Pn.comparator),$S=new ys(Pn.comparator);var jS=new ys(un);var tf,Q;(Q=tf||(tf={}))[Q.OK=0]="OK",Q[Q.CANCELLED=1]="CANCELLED",Q[Q.UNKNOWN=2]="UNKNOWN",Q[Q.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Q[Q.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Q[Q.NOT_FOUND=5]="NOT_FOUND",Q[Q.ALREADY_EXISTS=6]="ALREADY_EXISTS",Q[Q.PERMISSION_DENIED=7]="PERMISSION_DENIED",Q[Q.UNAUTHENTICATED=16]="UNAUTHENTICATED",Q[Q.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Q[Q.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Q[Q.ABORTED=10]="ABORTED",Q[Q.OUT_OF_RANGE=11]="OUT_OF_RANGE",Q[Q.UNIMPLEMENTED=12]="UNIMPLEMENTED",Q[Q.INTERNAL=13]="INTERNAL",Q[Q.UNAVAILABLE=14]="UNAVAILABLE",Q[Q.DATA_LOSS=15]="DATA_LOSS";var zS=new ps([4294967295,4294967295],0);var ws=class{constructor(){}At(e,t){this.Rt(e,t),t.Vt()}Rt(e,t){if("nullValue"in e)this.ft(t,5);else if("booleanValue"in e)this.ft(t,10),t.gt(e.booleanValue?1:0);else if("integerValue"in e)this.ft(t,15),t.gt(Jr(e.integerValue));else if("doubleValue"in e){let r=Jr(e.doubleValue);isNaN(r)?this.ft(t,13):(this.ft(t,15),Xv(r)?t.gt(0):t.gt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.ft(t,20),typeof r=="string"&&(r=cw(r)),t.yt(`${r.seconds||""}`),t.gt(r.nanos||0)}else if("stringValue"in e)this.wt(e.stringValue,t),this.St(t);else if("bytesValue"in e)this.ft(t,30),t.bt(uw(e.bytesValue)),this.St(t);else if("referenceValue"in e)this.Dt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.ft(t,45),t.gt(r.latitude||0),t.gt(r.longitude||0)}else"mapValue"in e?fw(e)?this.ft(t,Number.MAX_SAFE_INTEGER):dw(e)?this.vt(e.mapValue,t):(this.Ct(e.mapValue,t),this.St(t)):"arrayValue"in e?(this.Ft(e.arrayValue,t),this.St(t)):Je()}wt(e,t){this.ft(t,25),this.Mt(e,t)}Mt(e,t){t.yt(e)}Ct(e,t){let r=e.fields||{};this.ft(t,55);for(let i of Object.keys(r))this.wt(i,t),this.Rt(r[i],t)}vt(e,t){var r,i;let o=e.fields||{};this.ft(t,53);let a=bf,l=((i=(r=o[a].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.ft(t,15),t.gt(Jr(l)),this.wt(a,t),this.Rt(o[a],t)}Ft(e,t){let r=e.values||[];this.ft(t,50);for(let i of r)this.Rt(i,t)}Dt(e,t){this.ft(t,37),Pn.fromName(e).path.forEach(r=>{this.ft(t,60),this.Mt(r,t)})}ft(e,t){e.gt(t)}St(e){e.gt(2)}};ws.xt=new ws;var GS=new Uint8Array(0);var Sf=41943040,Ct=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};Ct.DEFAULT_COLLECTION_PERCENTILE=10,Ct.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ct.DEFAULT=new Ct(Sf,Ct.DEFAULT_COLLECTION_PERCENTILE,Ct.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ct.DISABLED=new Ct(-1,0,0);var pw=1048576;function va(){return typeof document<"u"?document:null}var ka=class{constructor(e,t,r=1e3,i=1.5,o=6e4){this.Ti=e,this.timerId=t,this.Go=r,this.zo=i,this.jo=o,this.Ho=0,this.Jo=null,this.Yo=Date.now(),this.reset()}reset(){this.Ho=0}Zo(){this.Ho=this.jo}Xo(e){this.cancel();let t=Math.floor(this.Ho+this.e_()),r=Math.max(0,Date.now()-this.Yo),i=Math.max(0,t-r);i>0&&mt("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ho} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.Jo=this.Ti.enqueueAfterDelay(this.timerId,i,()=>(this.Yo=Date.now(),e())),this.Ho*=this.zo,this.Ho<this.Go&&(this.Ho=this.Go),this.Ho>this.jo&&(this.Ho=this.jo)}t_(){this.Jo!==null&&(this.Jo.skipDelay(),this.Jo=null)}cancel(){this.Jo!==null&&(this.Jo.cancel(),this.Jo=null)}e_(){return(Math.random()-.5)*this.Ho}};var Da=class n{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new Rn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){let a=Date.now()+r,l=new n(e,t,a,i,o);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Le(Qe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};var nf,rf;(rf=nf||(nf={}))._a="default",rf.Cache="cache";function mw(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var sf=new Map;function gw(n,e,t,r){if(e===!0&&r===!0)throw new Le(Qe.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function _w(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Je()}function yw(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Le(Qe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=_w(n);throw new Le(Qe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var Af="firestore.googleapis.com",of=!0,Es=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new Le(Qe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Af,this.ssl=of}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:of;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Sf;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<pw)throw new Le(Qe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}gw("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=mw((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new Le(Qe.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new Le(Qe.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new Le(Qe.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Ts=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Es({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Le(Qe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Le(Qe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Es(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new wa;switch(r.type){case"firstParty":return new ba(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Le(Qe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return x(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=sf.get(t);r&&(mt("ComponentProvider","Removing Datastore"),sf.delete(t),r.terminate())}(this),Promise.resolve()}};function Cf(n,e,t,r={}){var i;let o=(n=yw(n,Ts))._getSettings(),a=Object.assign(Object.assign({},o),{emulatorOptions:n._getEmulatorOptions()}),l=`${e}:${t}`;o.host!==Af&&o.host!==l&&Kv("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let h=Object.assign(Object.assign({},o),{host:l,ssl:!1,emulatorOptions:r});if(!rn(h,a)&&(n._setSettings(h),r.mockUserToken)){let d,m;if(typeof r.mockUserToken=="string")d=r.mockUserToken,m=Fe.MOCK_USER;else{d=Qn(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new Le(Qe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new Fe(g)}n._authCredentials=new Ea(new gs(d,m))}}var af="AsyncQueue",Is=class{constructor(e=Promise.resolve()){this.Vu=[],this.mu=!1,this.fu=[],this.gu=null,this.pu=!1,this.yu=!1,this.wu=[],this.a_=new ka(this,"async_queue_retry"),this.Su=()=>{let r=va();r&&mt(af,"Visibility state changed to "+r.visibilityState),this.a_.t_()},this.bu=e;let t=va();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Su)}get isShuttingDown(){return this.mu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Du(),this.vu(e)}enterRestrictedMode(e){if(!this.mu){this.mu=!0,this.yu=e||!1;let t=va();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Su)}}enqueue(e){if(this.Du(),this.mu)return new Promise(()=>{});let t=new Rn;return this.vu(()=>this.mu&&this.yu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Vu.push(e),this.Cu()))}Cu(){return x(this,null,function*(){if(this.Vu.length!==0){try{yield this.Vu[0](),this.Vu.shift(),this.a_.reset()}catch(e){if(!Yv(e))throw e;mt(af,"Operation failed with retryable error: "+e)}this.Vu.length>0&&this.a_.Xo(()=>this.Cu())}})}vu(e){let t=this.bu.then(()=>(this.pu=!0,e().catch(r=>{this.gu=r,this.pu=!1;let i=function(a){let l=a.message||"";return a.stack&&(l=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),l}(r);throw lf("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.pu=!1,r))));return this.bu=t,t}enqueueAfterDelay(e,t,r){this.Du(),this.wu.indexOf(e)>-1&&(t=0);let i=Da.createAndSchedule(this,e,t,r,o=>this.Fu(o));return this.fu.push(i),i}Du(){this.gu&&Je()}verifyOperationInProgress(){}Mu(){return x(this,null,function*(){let e;do e=this.bu,yield e;while(e!==this.bu)})}xu(e){for(let t of this.fu)if(t.timerId===e)return!0;return!1}Ou(e){return this.Mu().then(()=>{this.fu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.fu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Mu()})}Nu(e){this.wu.push(e)}Fu(e){let t=this.fu.indexOf(e);this.fu.splice(t,1)}};var xa=class extends Ts{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new Is,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return x(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Is(e),this._firestoreClient=void 0,yield e}})}};function Rf(n,e){let t=typeof n=="object"?n:$e(),r=typeof n=="string"?n:e||Pa,i=Me(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let o=tn("firestore");o&&Cf(i,...o)}return i}var KS=new RegExp("[~\\*/\\[\\]]");(function(e,t=!0){(function(i){Zr=i})(on),Ae(new Se("firestore",(r,{instanceIdentifier:i,options:o})=>{let a=r.getProvider("app").getImmediate(),l=new xa(new Ta(r.getProvider("auth-internal")),new Sa(a,r.getProvider("app-check-internal")),function(d,m){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Le(Qe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Na(d.options.projectId,m)}(a,i),a);return o=Object.assign({useFetchStreams:t},o),l._setSettings(o),l},"PUBLIC").setMultipleInstances(!0)),B(Jd,Zd,e),B(Jd,Zd,"esm2017")})();var ei=class{constructor(e){return e}},Pf="firestore",Ma=class{constructor(){return Re(Pf)}};var Fa=new we("angularfire2.firestore-instances");function vw(n,e){let t=Ce(Pf,n,e);return t&&new ei(t)}function ww(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new ei(r)}}var Ew={provide:Ma,deps:[[new K,Fa]]},Tw={provide:ei,useFactory:vw,deps:[[new K,Fa],Ne]};function Nf(n,...e){return B("angularfire",ve.full,"fst"),Ee([Tw,Ew,{provide:Fa,useFactory:ww(n),multi:!0,deps:[ce,me,Pe,ke,[new K,an],[new K,bt],...e]}])}var kf=_e(Rf,!0);var Df="@firebase/database",xf="1.0.14";var Ol="";function Iw(n){Ol=n}var za=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),be(t))}get(e){let t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:zi(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var Ga=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return Tt(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var hp=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){let e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new za(e)}}catch{}return new Ga},kn=hp("localStorage"),Ka=hp("sessionStorage");var ur=new It("@firebase/database"),bw=function(){let n=1;return function(){return n++}}(),dp=function(n){let e=wh(n),t=new yh;t.update(e);let r=t.digest();return hh.encodeByteArray(r)},fi=function(...n){let e="";for(let t=0;t<n.length;t++){let r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=fi.apply(null,r):typeof r=="object"?e+=be(r):e+=r,e+=" "}return e},Dn=null,Of=!0,Sw=function(n,e){k(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(ur.logLevel=sn.VERBOSE,Dn=ur.log.bind(ur),e&&Ka.set("logging_enabled",!0)):typeof n=="function"?Dn=n:(Dn=null,Ka.remove("logging_enabled"))},je=function(...n){if(Of===!0&&(Of=!1,Dn===null&&Ka.get("logging_enabled")===!0&&Sw(!0)),Dn){let e=fi.apply(null,n);Dn(e)}},pi=function(n){return function(...e){je(n,...e)}},Wa=function(...n){let e="FIREBASE INTERNAL ERROR: "+fi(...n);ur.error(e)},jt=function(...n){let e=`FIREBASE FATAL ERROR: ${fi(...n)}`;throw ur.error(e),new Error(e)},st=function(...n){let e="FIREBASE WARNING: "+fi(...n);ur.warn(e)},Aw=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&st("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},fp=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},Cw=function(n){if(wt()||document.readyState==="complete")n();else{let e=!1,t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},dr="[MIN_NAME]",xn="[MAX_NAME]",vr=function(n,e){if(n===e)return 0;if(n===dr||e===xn)return-1;if(e===dr||n===xn)return 1;{let t=Mf(n),r=Mf(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},Rw=function(n,e){return n===e?0:n<e?-1:1},ti=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+be(e))},Ml=function(n){if(typeof n!="object"||n===null)return be(n);let e=[];for(let r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=be(e[r]),t+=":",t+=Ml(n[e[r]]);return t+="}",t},pp=function(n,e){let t=n.length;if(t<=e)return[n];let r=[];for(let i=0;i<t;i+=e)i+e>t?r.push(n.substring(i,t)):r.push(n.substring(i,i+e));return r};function dt(n,e){for(let t in n)n.hasOwnProperty(t)&&e(t,n[t])}var mp=function(n){k(!fp(n),"Invalid JSON number");let e=11,t=52,r=(1<<e-1)-1,i,o,a,l,h;n===0?(o=0,a=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(l=Math.min(Math.floor(Math.log(n)/Math.LN2),r),o=l+r,a=Math.round(n*Math.pow(2,t-l)-Math.pow(2,t))):(o=0,a=Math.round(n/Math.pow(2,1-r-t))));let d=[];for(h=t;h;h-=1)d.push(a%2?1:0),a=Math.floor(a/2);for(h=e;h;h-=1)d.push(o%2?1:0),o=Math.floor(o/2);d.push(i?1:0),d.reverse();let m=d.join(""),g="";for(h=0;h<64;h+=8){let T=parseInt(m.substr(h,8),2).toString(16);T.length===1&&(T="0"+T),g=g+T}return g.toLowerCase()},Pw=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},Nw=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};var kw=new RegExp("^-?(0*)\\d{1,10}$"),Dw=-2147483648,xw=2147483647,Mf=function(n){if(kw.test(n)){let e=Number(n);if(e>=Dw&&e<=xw)return e}return null},mi=function(n){try{n()}catch(e){setTimeout(()=>{let t=e.stack||"";throw st("Exception was thrown by user callback.",t),e},Math.floor(0))}},Ow=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},oi=function(n,e){let t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};var Ha=class{constructor(e,t){this.appCheckProvider=t,this.appName=e.name,Ut(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){st(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}};var Qa=class{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(je("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',st(e)}},ai=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}n.OWNER="owner";return n})(),Ss="5",gp="v",_p="s",yp="r",vp="f",wp=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Ep="ls",Tp="p",Ya="ac",Ip="websocket",bp="long_polling";var As=class{constructor(e,t,r,i,o=!1,a="",l=!1,h=!1,d=null){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=o,this.persistenceKey=a,this.includeNamespaceInQueryParams=l,this.isUsingEmulator=h,this.emulatorOptions=d,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=kn.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&kn.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}};function Mw(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function Sp(n,e,t){k(typeof e=="string","typeof type must == string"),k(typeof t=="object","typeof params must == object");let r;if(e===Ip)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===bp)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);Mw(n)&&(t.ns=n.namespace);let i=[];return dt(t,(o,a)=>{i.push(o+"="+a)}),r+i.join("&")}var Xa=class{constructor(){this.counters_={}}incrementCounter(e,t=1){Tt(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return fh(this.counters_)}};var La={},Va={};function Fl(n){let e=n.toString();return La[e]||(La[e]=new Xa),La[e]}function Fw(n,e){let t=n.toString();return Va[t]||(Va[t]=e()),Va[t]}var Ja=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&mi(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var Ff="start",Lw="close",Vw="pLPCommand",Uw="pRTLPCB",Ap="id",Cp="pw",Rp="ser",Bw="cb",qw="seg",$w="ts",jw="d",zw="dframe",Pp=1870,Np=30,Gw=Pp-Np,Kw=25e3,Ww=3e4,Za=class n{constructor(e,t,r,i,o,a,l){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=o,this.transportSessionId=a,this.lastSessionId=l,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=pi(e),this.stats_=Fl(t),this.urlFn=h=>(this.appCheckToken&&(h[Ya]=this.appCheckToken),Sp(t,bp,h))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Ja(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(Ww)),Cw(()=>{if(this.isClosed_)return;this.scriptTagHolder=new el((...o)=>{let[a,l,h,d,m]=o;if(this.incrementIncomingBytes_(o),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,a===Ff)this.id=l,this.password=h;else if(a===Lw)l?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(l,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+a)},(...o)=>{let[a,l]=o;this.incrementIncomingBytes_(o),this.myPacketOrderer.handleResponse(a,l)},()=>{this.onClosed_()},this.urlFn);let r={};r[Ff]="t",r[Rp]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[Bw]=this.scriptTagHolder.uniqueCallbackIdentifier),r[gp]=Ss,this.transportSessionId&&(r[_p]=this.transportSessionId),this.lastSessionId&&(r[Ep]=this.lastSessionId),this.applicationId&&(r[Tp]=this.applicationId),this.appCheckToken&&(r[Ya]=this.appCheckToken),typeof location<"u"&&location.hostname&&wp.test(location.hostname)&&(r[yp]=vp);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){n.forceAllow_=!0}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){return wt()?!1:n.forceAllow_?!0:!n.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!Pw()&&!Nw()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let t=be(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let r=dh(t),i=pp(r,Gw);for(let o=0;o<i.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[o]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(wt())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[zw]="t",r[Ap]=e,r[Cp]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let t=be(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}},el=class n{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,wt())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=bw(),window[Vw+this.uniqueCallbackIdentifier]=e,window[Uw+this.uniqueCallbackIdentifier]=t,this.myIFrame=n.createIFrame_();let o="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(o='<script>document.domain="'+document.domain+'";<\/script>');let a="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(l){je("frame writing exception"),l.stack&&je(l.stack),je(l)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||je("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[Ap]=this.myID,e[Cp]=this.myPW,e[Rp]=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+Np+r.length<=Pp;){let a=this.pendingSegs.shift();r=r+"&"+qw+i+"="+a.seg+"&"+$w+i+"="+a.ts+"&"+jw+i+"="+a.d,i++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);let r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(Kw)),o=()=>{clearTimeout(i),r()};this.addTag(e,o)}addTag(e,t){wt()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{je("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var Hw=16384,Qw=45e3,Cs=null;typeof MozWebSocket<"u"?Cs=MozWebSocket:typeof WebSocket<"u"&&(Cs=WebSocket);var ni=(()=>{class n{constructor(t,r,i,o,a,l,h){this.connId=t,this.applicationId=i,this.appCheckToken=o,this.authToken=a,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=pi(this.connId),this.stats_=Fl(r),this.connURL=n.connectionURL_(r,l,h,o,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,o,a){let l={};return l[gp]=Ss,!wt()&&typeof location<"u"&&location.hostname&&wp.test(location.hostname)&&(l[yp]=vp),r&&(l[_p]=r),i&&(l[Ep]=i),o&&(l[Ya]=o),a&&(l[Tp]=a),Sp(t,Ip,l)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,kn.set("previous_websocket_failure",!0);try{let i;if(wt()){let o=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${Ss}/${Ol}/${process.platform}/${o}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let a=process.env,l=this.connURL.indexOf("wss://")===0?a.HTTPS_PROXY||a.https_proxy:a.HTTP_PROXY||a.http_proxy;l&&(i.proxy={origin:l})}this.mySock=new Cs(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let o=i.message||i.data;o&&this.log_(o),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let o=i.message||i.data;o&&this.log_(o),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&Cs!==null&&!n.forceDisallow_}static previouslyFailed(){return kn.isInMemoryStorage||kn.get("previous_websocket_failure")===!0}markConnectionHealthy(){kn.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=zi(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(k(this.frames===null,"We already have a frame buffer"),t.length<=6){let r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;let r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();let r=be(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=pp(r,Hw);i.length>1&&this.sendString_(String(i.length));for(let o=0;o<i.length;o++)this.sendString_(i[o])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(Qw))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4;return n})(),Yw=(()=>{class n{static get ALL_TRANSPORTS(){return[Za,ni]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(t){this.initTransports_(t)}initTransports_(t){let r=ni&&ni.isAvailable(),i=r&&!ni.previouslyFailed();if(t.webSocketOnly&&(r||st("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[ni];else{let o=this.transports_=[];for(let a of n.ALL_TRANSPORTS)a&&a.isAvailable()&&o.push(a);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}n.globalTransportInitialized_=!1;return n})(),Xw=6e4,Jw=5e3,Zw=10*1024,eE=100*1024,Ua="t",Lf="d",tE="s",Vf="r",nE="e",Uf="o",Bf="a",qf="n",$f="p",rE="h",tl=class{constructor(e,t,r,i,o,a,l,h,d,m){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=o,this.onMessage_=a,this.onReady_=l,this.onDisconnect_=h,this.onKill_=d,this.lastSessionId=m,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=pi("c:"+this.id+":"),this.transportManager_=new Yw(t),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=oi(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>eE?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>Zw?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){let t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Ua in e){let t=e[Ua];t===Bf?this.upgradeIfSecondaryHealthy_():t===Vf?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===Uf&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let t=ti("t",e),r=ti("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:$f,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Bf,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:qf,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let t=ti("t",e),r=ti("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let t=ti(Ua,e);if(Lf in e){let r=e[Lf];if(t===rE){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===qf){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===tE?this.onConnectionShutdown_(r):t===Vf?this.onReset_(r):t===nE?Wa("Server Error: "+r):t===Uf?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Wa("Unknown control packet command: "+t)}}onHandshake_(e){let t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),Ss!==r&&st("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),oi(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(Xw))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):oi(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(Jw))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:$f,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(kn.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var Rs=class{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}};var Ps=class{constructor(e){this.allowedEvents_=e,this.listeners_={},k(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});let i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let o=0;o<i.length;o++)if(i[o].callback===t&&(!r||r===i[o].context)){i.splice(o,1);return}}validateEventType_(e){k(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}};var Ns=class n extends Ps{static getInstance(){return new n}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Io()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return k(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var jf=32,zf=768,ne=class{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}};function ee(){return new ne("")}function Y(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function dn(n){return n.pieces_.length-n.pieceNum_}function le(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new ne(n.pieces_,e)}function kp(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function iE(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function Dp(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function xp(n){if(n.pieceNum_>=n.pieces_.length)return null;let e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new ne(e,0)}function De(n,e){let t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof ne)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new ne(t,0)}function H(n){return n.pieceNum_>=n.pieces_.length}function ut(n,e){let t=Y(n),r=Y(e);if(t===null)return e;if(t===r)return ut(le(n),le(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function Op(n,e){if(dn(n)!==dn(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function _t(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(dn(n)>dn(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}var nl=class{constructor(e,t){this.errorPrefix_=t,this.parts_=Dp(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=$r(this.parts_[r]);Mp(this)}};function sE(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=$r(e),Mp(n)}function oE(n){let e=n.parts_.pop();n.byteLength_-=$r(e),n.parts_.length>0&&(n.byteLength_-=1)}function Mp(n){if(n.byteLength_>zf)throw new Error(n.errorPrefix_+"has a key path longer than "+zf+" bytes ("+n.byteLength_+").");if(n.parts_.length>jf)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+jf+") or object contains a cycle "+Nn(n))}function Nn(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}var rl=class n extends Ps{static getInstance(){return new n}constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}getInitialEvent(e){return k(e==="visible","Unknown event type: "+e),[this.visible_]}};var ri=1e3,aE=60*5*1e3,Gf=30*1e3,lE=1.3,cE=3e4,uE="server_kill",Kf=3,Ll=(()=>{class n extends Rs{constructor(t,r,i,o,a,l,h,d){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=o,this.onServerInfoUpdate_=a,this.authTokenProvider_=l,this.appCheckTokenProvider_=h,this.authOverride_=d,this.id=n.nextPersistentConnectionId_++,this.log_=pi("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=ri,this.maxReconnectDelay_=aE,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,d&&!wt())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");rl.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&Ns.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){let o=++this.requestNumber_,a={r:o,a:t,b:r};this.log_(be(a)),k(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(a),i&&(this.requestCBHash_[o]=i)}get(t){this.initConnection_();let r=new To,o={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:l=>{let h=l.d;l.s==="ok"?r.resolve(h):r.reject(h)}};this.outstandingGets_.push(o),this.outstandingGetCount_++;let a=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(a),r.promise}listen(t,r,i,o){this.initConnection_();let a=t._queryIdentifier,l=t._path.toString();this.log_("Listen called for "+l+" "+a),this.listens.has(l)||this.listens.set(l,new Map),k(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),k(!this.listens.get(l).has(a),"listen() called twice for same path/queryId.");let h={onComplete:o,hashFn:r,query:t,tag:i};this.listens.get(l).set(a,h),this.connected_&&this.sendListen_(h)}sendGet_(t){let r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){let r=t.query,i=r._path.toString(),o=r._queryIdentifier;this.log_("Listen on "+i+" for "+o);let a={p:i},l="q";t.tag&&(a.q=r._queryObject,a.t=t.tag),a.h=t.hashFn(),this.sendRequest(l,a,h=>{let d=h.d,m=h.s;n.warnOnListenWarnings_(d,r),(this.listens.get(i)&&this.listens.get(i).get(o))===t&&(this.log_("listen response",h),m!=="ok"&&this.removeListen_(i,o),t.onComplete&&t.onComplete(m,d))})}static warnOnListenWarnings_(t,r){if(t&&typeof t=="object"&&Tt(t,"w")){let i=yn(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let o='".indexOn": "'+r._queryParams.getIndex().toString()+'"',a=r._path.toString();st(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${o} at ${a} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||gh(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=Gf)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let t=this.authToken_,r=mh(t)?"auth":"gauth",i={cred:t};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,o=>{let a=o.s,l=o.d||"error";this.authToken_===t&&(a==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(a,l))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{let r=t.s,i=t.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){let i=t._path.toString(),o=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+o),k(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,o)&&this.connected_&&this.sendUnlisten_(i,o,t._queryObject,r)}sendUnlisten_(t,r,i,o){this.log_("Unlisten on "+t+" for "+r);let a={p:t},l="n";o&&(a.q=i,a.t=o),this.sendRequest(l,a)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,o){let a={p:r,d:i};this.log_("onDisconnect "+t,a),this.sendRequest(t,a,l=>{o&&setTimeout(()=>{o(l.s,l.d)},Math.floor(0))})}put(t,r,i,o){this.putInternal("p",t,r,i,o)}merge(t,r,i,o){this.putInternal("m",t,r,i,o)}putInternal(t,r,i,o,a){this.initConnection_();let l={p:r,d:i};a!==void 0&&(l.h=a),this.outstandingPuts_.push({action:t,request:l,onComplete:o}),this.outstandingPutCount_++;let h=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(h):this.log_("Buffering put: "+r)}sendPut_(t){let r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,o=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,a=>{this.log_(r+" response",a),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),o&&o(a.s,a.d)})}reportStats(t){if(this.connected_){let r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let a=i.d;this.log_("reportStats","Error sending stats: "+a)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+be(t));let r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),t==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):t==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):t==="c"?this.onListenRevoked_(r.p,r.q):t==="ac"?this.onAuthRevoked_(r.s,r.d):t==="apc"?this.onAppCheckRevoked_(r.s,r.d):t==="sd"?this.onSecurityDebugPacket_(r):Wa("Unrecognized action received from server: "+be(t)+`
Are you using the latest client?`)}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){k(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=ri,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=ri,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>cE&&(this.reconnectDelay_=ri),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let t=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_),r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*lE)}this.onConnectStatus_(!1)}establishConnection_(){return x(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),o=this.id+":"+n.nextConnectionId_++,a=this.lastSessionId,l=!1,h=null,d=function(){h?h.close():(l=!0,i())},m=function(T){k(h,"sendRequest call when we're not connected not allowed."),h.sendRequest(T)};this.realtime_={close:d,sendRequest:m};let g=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[T,C]=yield Promise.all([this.authTokenProvider_.getToken(g),this.appCheckTokenProvider_.getToken(g)]);l?je("getToken() completed but was canceled"):(je("getToken() completed. Creating connection."),this.authToken_=T&&T.accessToken,this.appCheckToken_=C&&C.token,h=new tl(o,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,i,A=>{st(A+" ("+this.repoInfo_.toString()+")"),this.interrupt(uE)},a))}catch(T){this.log_("Failed to get token: "+T),l||(this.repoInfo_.nodeAdmin&&st(T),d())}}})}interrupt(t){je("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){je("Resuming connection for reason: "+t),delete this.interruptReasons_[t],So(this.interruptReasons_)&&(this.reconnectDelay_=ri,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){let r=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){let r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;r?i=r.map(a=>Ml(a)).join("$"):i="default";let o=this.removeListen_(t,i);o&&o.onComplete&&o.onComplete("permission_denied")}removeListen_(t,r){let i=new ne(t).toString(),o;if(this.listens.has(i)){let a=this.listens.get(i);o=a.get(r),a.delete(r),a.size===0&&this.listens.delete(i)}else o=void 0;return o}onAuthRevoked_(t,r){je("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=Kf&&(this.reconnectDelay_=Gf,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){je("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=Kf&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let t of this.listens.values())for(let r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){let t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){let t={},r="js";wt()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),t["sdk."+r+"."+Ol.replace(/\./g,"-")]=1,Io()?t["framework.cordova"]=1:ph()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){let t=Ns.getInstance().currentlyOnline();return So(this.interruptReasons_)&&t}}n.nextPersistentConnectionId_=0,n.nextConnectionId_=0;return n})(),X=class n{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new n(e,t)}};var fr=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){let r=new X(dr,e),i=new X(dr,t);return this.compare(r,i)!==0}minPost(){return X.MIN}};var bs,ks=class extends fr{static get __EMPTY_NODE(){return bs}static set __EMPTY_NODE(e){bs=e}compare(e,t){return vr(e.name,t.name)}isDefinedOn(e){throw Hn("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return X.MIN}maxPost(){return new X(xn,bs)}makePost(e,t){return k(typeof e=="string","KeyIndex indexValue must always be a string."),new X(e,bs)}toString(){return".key"}},hr=new ks;var lr=class{constructor(e,t,r,i,o=null){this.isReverse_=i,this.resultGenerator_=o,this.nodeStack_=[];let a=1;for(;!e.isEmpty();)if(e=e,a=t?r(e.key,t):1,i&&(a*=-1),a<0)this.isReverse_?e=e.left:e=e.right;else if(a===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},gt=(()=>{class n{constructor(t,r,i,o,a){this.key=t,this.value=r,this.color=i??n.RED,this.left=o??ht.EMPTY_NODE,this.right=a??ht.EMPTY_NODE}copy(t,r,i,o,a){return new n(t??this.key,r??this.value,i??this.color,o??this.left,a??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let o=this,a=i(t,o.key);return a<0?o=o.copy(null,null,null,o.left.insert(t,r,i),null):a===0?o=o.copy(null,r,null,null,null):o=o.copy(null,null,null,null,o.right.insert(t,r,i)),o.fixUp_()}removeMin_(){if(this.left.isEmpty())return ht.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,o;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(t,i.key)===0){if(i.right.isEmpty())return ht.EMPTY_NODE;o=i.right.min_(),i=i.copy(o.key,o.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){let t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){let t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})(),il=class{copy(e,t,r,i,o){return this}insert(e,t,r){return new gt(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},ht=class n{constructor(e,t=n.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new n(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,gt.BLACK,null,null))}remove(e){return new n(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,gt.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new lr(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new lr(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new lr(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new lr(this.root_,null,this.comparator_,!0,e)}};ht.EMPTY_NODE=new il;function hE(n,e){return vr(n.name,e.name)}function Vl(n,e){return vr(n,e)}var sl;function dE(n){sl=n}var Fp=function(n){return typeof n=="number"?"number:"+mp(n):"string:"+n},Lp=function(n){if(n.isLeafNode()){let e=n.val();k(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Tt(e,".sv"),"Priority must be a string or number.")}else k(n===sl||n.isEmpty(),"priority of unexpected type.");k(n===sl||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var Wf,pr=(()=>{class n{static set __childrenNodeConstructor(t){Wf=t}static get __childrenNodeConstructor(){return Wf}constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,k(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),Lp(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return H(t)?this:Y(t)===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return t===".priority"?this.updatePriority(r):r.isEmpty()&&t!==".priority"?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){let i=Y(t);return i===null?r:r.isEmpty()&&i!==".priority"?this:(k(i!==".priority"||dn(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(le(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+Fp(this.priorityNode_.val())+":");let r=typeof this.value_;t+=r+":",r==="number"?t+=mp(this.value_):t+=this.value_,this.lazyHash_=dp(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:(k(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){let r=typeof t.value_,i=typeof this.value_,o=n.VALUE_TYPE_ORDER.indexOf(r),a=n.VALUE_TYPE_ORDER.indexOf(i);return k(o>=0,"Unknown leaf type: "+r),k(a>=0,"Unknown leaf type: "+i),o===a?i==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:a-o}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){let r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}n.VALUE_TYPE_ORDER=["object","boolean","number","string"];return n})(),Vp,Up;function fE(n){Vp=n}function pE(n){Up=n}var ol=class extends fr{compare(e,t){let r=e.node.getPriority(),i=t.node.getPriority(),o=r.compareTo(i);return o===0?vr(e.name,t.name):o}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return X.MIN}maxPost(){return new X(xn,new pr("[PRIORITY-POST]",Up))}makePost(e,t){let r=Vp(e);return new X(t,new pr("[PRIORITY-POST]",r))}toString(){return".priority"}},Ge=new ol;var mE=Math.log(2),al=class{constructor(e){let t=o=>parseInt(Math.log(o)/mE,10),r=o=>parseInt(Array(o+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},Ds=function(n,e,t,r){n.sort(e);let i=function(h,d){let m=d-h,g,T;if(m===0)return null;if(m===1)return g=n[h],T=t?t(g):g,new gt(T,g.node,gt.BLACK,null,null);{let C=parseInt(m/2,10)+h,A=i(h,C),R=i(C+1,d);return g=n[C],T=t?t(g):g,new gt(T,g.node,gt.BLACK,A,R)}},o=function(h){let d=null,m=null,g=n.length,T=function(A,R){let P=g-A,U=g;g-=A;let $=i(P+1,U),j=n[P],q=t?t(j):j;C(new gt(q,j.node,R,null,$))},C=function(A){d?(d.left=A,d=A):(m=A,d=A)};for(let A=0;A<h.count;++A){let R=h.nextBitIsOne(),P=Math.pow(2,h.count-(A+1));R?T(P,gt.BLACK):(T(P,gt.BLACK),T(P,gt.RED))}return m},a=new al(n.length),l=o(a);return new ht(r||e,l)};var Ba,ar={},mr=class n{static get Default(){return k(ar&&Ge,"ChildrenNode.ts has not been loaded"),Ba=Ba||new n({".priority":ar},{".priority":Ge}),Ba}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){let t=yn(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof ht?t:null}hasIndex(e){return Tt(this.indexSet_,e.toString())}addIndex(e,t){k(e!==hr,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,o=t.getIterator(X.Wrap),a=o.getNext();for(;a;)i=i||e.isDefinedOn(a.node),r.push(a),a=o.getNext();let l;i?l=Ds(r,e.getCompare()):l=ar;let h=e.toString(),d=Object.assign({},this.indexSet_);d[h]=e;let m=Object.assign({},this.indexes_);return m[h]=l,new n(m,d)}addToIndexes(e,t){let r=qr(this.indexes_,(i,o)=>{let a=yn(this.indexSet_,o);if(k(a,"Missing index implementation for "+o),i===ar)if(a.isDefinedOn(e.node)){let l=[],h=t.getIterator(X.Wrap),d=h.getNext();for(;d;)d.name!==e.name&&l.push(d),d=h.getNext();return l.push(e),Ds(l,a.getCompare())}else return ar;else{let l=t.get(e.name),h=i;return l&&(h=h.remove(new X(e.name,l))),h.insert(e,e.node)}});return new n(r,this.indexSet_)}removeFromIndexes(e,t){let r=qr(this.indexes_,i=>{if(i===ar)return i;{let o=t.get(e.name);return o?i.remove(new X(e.name,o)):i}});return new n(r,this.indexSet_)}};var ii,ue=(()=>{class n{static get EMPTY_NODE(){return ii||(ii=new n(new ht(Vl),null,mr.Default))}constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&Lp(this.priorityNode_),this.children_.isEmpty()&&k(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||ii}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{let r=this.children_.get(t);return r===null?ii:r}}getChild(t){let r=Y(t);return r===null?this:this.getImmediateChild(r).getChild(le(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,r){if(k(r,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(r);{let i=new X(t,r),o,a;r.isEmpty()?(o=this.children_.remove(t),a=this.indexMap_.removeFromIndexes(i,this.children_)):(o=this.children_.insert(t,r),a=this.indexMap_.addToIndexes(i,this.children_));let l=o.isEmpty()?ii:this.priorityNode_;return new n(o,l,a)}}updateChild(t,r){let i=Y(t);if(i===null)return r;{k(Y(t)!==".priority"||dn(t)===1,".priority must be the last token in a path");let o=this.getImmediateChild(i).updateChild(le(t),r);return this.updateImmediateChild(i,o)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;let r={},i=0,o=0,a=!0;if(this.forEachChild(Ge,(l,h)=>{r[l]=h.val(t),i++,a&&n.INTEGER_REGEXP_.test(l)?o=Math.max(o,Number(l)):a=!1}),!t&&a&&o<2*i){let l=[];for(let h in r)l[h]=r[h];return l}else return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+Fp(this.getPriority().val())+":"),this.forEachChild(Ge,(r,i)=>{let o=i.hash();o!==""&&(t+=":"+r+":"+o)}),this.lazyHash_=t===""?"":dp(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){let o=this.resolveIndex_(i);if(o){let a=o.getPredecessorKey(new X(t,r));return a?a.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(t){let r=this.getFirstChildName(t);return r?new X(r,this.children_.get(r)):null}getLastChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(t){let r=this.getLastChildName(t);return r?new X(r,this.children_.get(r)):null}forEachChild(t,r){let i=this.resolveIndex_(t);return i?i.inorderTraversal(o=>r(o.name,o.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,o=>o);{let o=this.children_.getIteratorFrom(t.name,X.Wrap),a=o.peek();for(;a!=null&&r.compare(a,t)<0;)o.getNext(),a=o.peek();return o}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,o=>o);{let o=this.children_.getReverseIteratorFrom(t.name,X.Wrap),a=o.peek();for(;a!=null&&r.compare(a,t)>0;)o.getNext(),a=o.peek();return o}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===gi?-1:0}withIndex(t){if(t===hr||this.indexMap_.hasIndex(t))return this;{let r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===hr||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{let r=t;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(Ge),o=r.getIterator(Ge),a=i.getNext(),l=o.getNext();for(;a&&l;){if(a.name!==l.name||!a.node.equals(l.node))return!1;a=i.getNext(),l=o.getNext()}return a===null&&l===null}else return!1;else return!1}}resolveIndex_(t){return t===hr?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})(),ll=class extends ue{constructor(){super(new ht(Vl),ue.EMPTY_NODE,mr.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return ue.EMPTY_NODE}isEmpty(){return!1}},gi=new ll;Object.defineProperties(X,{MIN:{value:new X(dr,ue.EMPTY_NODE)},MAX:{value:new X(xn,gi)}});ks.__EMPTY_NODE=ue.EMPTY_NODE;pr.__childrenNodeConstructor=ue;dE(gi);pE(gi);var gE=!0;function ze(n,e=null){if(n===null)return ue.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),k(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){let t=n;return new pr(t,ze(e))}if(!(n instanceof Array)&&gE){let t=[],r=!1;if(dt(n,(a,l)=>{if(a.substring(0,1)!=="."){let h=ze(l);h.isEmpty()||(r=r||!h.getPriority().isEmpty(),t.push(new X(a,h)))}}),t.length===0)return ue.EMPTY_NODE;let o=Ds(t,hE,a=>a.name,Vl);if(r){let a=Ds(t,Ge.getCompare());return new ue(o,ze(e),new mr({".priority":a},{".priority":Ge}))}else return new ue(o,ze(e),mr.Default)}else{let t=ue.EMPTY_NODE;return dt(n,(r,i)=>{if(Tt(n,r)&&r.substring(0,1)!=="."){let o=ze(i);(o.isLeafNode()||!o.isEmpty())&&(t=t.updateImmediateChild(r,o))}}),t.updatePriority(ze(e))}}fE(ze);var cl=class extends fr{constructor(e){super(),this.indexPath_=e,k(!H(e)&&Y(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){let r=this.extractChild(e.node),i=this.extractChild(t.node),o=r.compareTo(i);return o===0?vr(e.name,t.name):o}makePost(e,t){let r=ze(e),i=ue.EMPTY_NODE.updateChild(this.indexPath_,r);return new X(t,i)}maxPost(){let e=ue.EMPTY_NODE.updateChild(this.indexPath_,gi);return new X(xn,e)}toString(){return Dp(this.indexPath_,0).join("/")}};var ul=class extends fr{compare(e,t){let r=e.node.compareTo(t.node);return r===0?vr(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return X.MIN}maxPost(){return X.MAX}makePost(e,t){let r=ze(e);return new X(t,r)}toString(){return".value"}},_E=new ul;function yE(n){return{type:"value",snapshotNode:n}}function vE(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function wE(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function Hf(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function EE(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}var hl=class n{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ge}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return k(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return k(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:dr}hasEnd(){return this.endSet_}getIndexEndValue(){return k(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return k(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:xn}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return k(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ge}copy(){let e=new n;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function Qf(n){let e={};if(n.isDefault())return e;let t;if(n.index_===Ge?t="$priority":n.index_===_E?t="$value":n.index_===hr?t="$key":(k(n.index_ instanceof cl,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=be(t),n.startSet_){let r=n.startAfterSet_?"startAfter":"startAt";e[r]=be(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+be(n.indexStartName_))}if(n.endSet_){let r=n.endBeforeSet_?"endBefore":"endAt";e[r]=be(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+be(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function Yf(n){let e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==Ge&&(e.i=n.index_.toString()),e}var dl=class n extends Rs{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(k(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=pi("p:rest:"),this.listens_={}}listen(e,t,r,i){let o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);let a=n.getListenId_(e,r),l={};this.listens_[a]=l;let h=Qf(e._queryParams);this.restRequest_(o+".json",h,(d,m)=>{let g=m;if(d===404&&(g=null,d=null),d===null&&this.onDataUpdate_(o,g,!1,r),yn(this.listens_,a)===l){let T;d?d===401?T="permission_denied":T="rest_error:"+d:T="ok",i(T,null)}})}unlisten(e,t){let r=n.getListenId_(e,t);delete this.listens_[r]}get(e){let t=Qf(e._queryParams),r=e._path.toString(),i=new To;return this.restRequest_(r+".json",t,(o,a)=>{let l=a;o===404&&(l=null,o=null),o===null?(this.onDataUpdate_(r,l,!1,null),i.resolve(l)):i.reject(new Error(l))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,o])=>{i&&i.accessToken&&(t.auth=i.accessToken),o&&o.token&&(t.ac=o.token);let a=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+_h(t);this.log_("Sending REST request for "+a);let l=new XMLHttpRequest;l.onreadystatechange=()=>{if(r&&l.readyState===4){this.log_("REST Response for "+a+" received. status:",l.status,"response:",l.responseText);let h=null;if(l.status>=200&&l.status<300){try{h=zi(l.responseText)}catch{st("Failed to parse JSON response for "+a+": "+l.responseText)}r(null,h)}else l.status!==401&&l.status!==404&&st("Got unsuccessful REST response for "+a+" Status: "+l.status),r(l.status);r=null}},l.open("GET",a,!0),l.send()})}};var fl=class{constructor(){this.rootNode_=ue.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}};function xs(){return{value:null,children:new Map}}function Bp(n,e,t){if(H(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{let r=Y(e);n.children.has(r)||n.children.set(r,xs());let i=n.children.get(r);e=le(e),Bp(i,e,t)}}function pl(n,e,t){n.value!==null?t(e,n.value):TE(n,(r,i)=>{let o=new ne(e.toString()+"/"+r);pl(i,o,t)})}function TE(n,e){n.children.forEach((t,r)=>{e(r,t)})}var ml=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),t=Object.assign({},e);return this.last_&&dt(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}};var Xf=10*1e3,IE=30*1e3,bE=5*60*1e3,gl=class{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new ml(e);let r=Xf+(IE-Xf)*Math.random();oi(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),t={},r=!1;dt(e,(i,o)=>{o>0&&Tt(this.statsToReport_,i)&&(t[i]=o,r=!0)}),r&&this.server_.reportStats(t),oi(this.reportStats_.bind(this),Math.floor(Math.random()*2*bE))}};var $t=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}($t||{});function qp(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function $p(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function jp(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}var _l=class n{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=$t.ACK_USER_WRITE,this.source=qp()}operationForChild(e){if(H(this.path)){if(this.affectedTree.value!=null)return k(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let t=this.affectedTree.subtree(new ne(e));return new n(ee(),t,this.revert)}}else return k(Y(this.path)===e,"operationForChild called for unrelated child."),new n(le(this.path),this.affectedTree,this.revert)}};var gr=class n{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=$t.OVERWRITE}operationForChild(e){return H(this.path)?new n(this.source,ee(),this.snap.getImmediateChild(e)):new n(this.source,le(this.path),this.snap)}};var Os=class n{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=$t.MERGE}operationForChild(e){if(H(this.path)){let t=this.children.subtree(new ne(e));return t.isEmpty()?null:t.value?new gr(this.source,ee(),t.value):new n(this.source,ee(),t)}else return k(Y(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new n(this.source,le(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var ui=class{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(H(e))return this.isFullyInitialized()&&!this.filtered_;let t=Y(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};function SE(n,e,t,r){let i=[],o=[];return e.forEach(a=>{a.type==="child_changed"&&n.index_.indexedValueChanged(a.oldSnap,a.snapshotNode)&&o.push(EE(a.childName,a.snapshotNode))}),si(n,i,"child_removed",e,r,t),si(n,i,"child_added",e,r,t),si(n,i,"child_moved",o,r,t),si(n,i,"child_changed",e,r,t),si(n,i,"value",e,r,t),i}function si(n,e,t,r,i,o){let a=r.filter(l=>l.type===t);a.sort((l,h)=>CE(n,l,h)),a.forEach(l=>{let h=AE(n,l,o);i.forEach(d=>{d.respondsTo(l.type)&&e.push(d.createEvent(h,n.query_))})})}function AE(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function CE(n,e,t){if(e.childName==null||t.childName==null)throw Hn("Should only compare child_ events.");let r=new X(e.childName,e.snapshotNode),i=new X(t.childName,t.snapshotNode);return n.index_.compare(r,i)}function zp(n,e){return{eventCache:n,serverCache:e}}function li(n,e,t,r){return zp(new ui(e,t,r),n.serverCache)}function Gp(n,e,t,r){return zp(n.eventCache,new ui(e,t,r))}function yl(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function On(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}var qa,RE=()=>(qa||(qa=new ht(Rw)),qa),Ze=class n{static fromObject(e){let t=new n(null);return dt(e,(r,i)=>{t=t.set(new ne(r),i)}),t}constructor(e,t=RE()){this.value=e,this.children=t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:ee(),value:this.value};if(H(e))return null;{let r=Y(e),i=this.children.get(r);if(i!==null){let o=i.findRootMostMatchingPathAndValue(le(e),t);return o!=null?{path:De(new ne(r),o.path),value:o.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(H(e))return this;{let t=Y(e),r=this.children.get(t);return r!==null?r.subtree(le(e)):new n(null)}}set(e,t){if(H(e))return new n(t,this.children);{let r=Y(e),o=(this.children.get(r)||new n(null)).set(le(e),t),a=this.children.insert(r,o);return new n(this.value,a)}}remove(e){if(H(e))return this.children.isEmpty()?new n(null):new n(null,this.children);{let t=Y(e),r=this.children.get(t);if(r){let i=r.remove(le(e)),o;return i.isEmpty()?o=this.children.remove(t):o=this.children.insert(t,i),this.value===null&&o.isEmpty()?new n(null):new n(this.value,o)}else return this}}get(e){if(H(e))return this.value;{let t=Y(e),r=this.children.get(t);return r?r.get(le(e)):null}}setTree(e,t){if(H(e))return t;{let r=Y(e),o=(this.children.get(r)||new n(null)).setTree(le(e),t),a;return o.isEmpty()?a=this.children.remove(r):a=this.children.insert(r,o),new n(this.value,a)}}fold(e){return this.fold_(ee(),e)}fold_(e,t){let r={};return this.children.inorderTraversal((i,o)=>{r[i]=o.fold_(De(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,ee(),t)}findOnPath_(e,t,r){let i=this.value?r(t,this.value):!1;if(i)return i;if(H(e))return null;{let o=Y(e),a=this.children.get(o);return a?a.findOnPath_(le(e),De(t,o),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,ee(),t)}foreachOnPath_(e,t,r){if(H(e))return this;{this.value&&r(t,this.value);let i=Y(e),o=this.children.get(i);return o?o.foreachOnPath_(le(e),De(t,i),r):new n(null)}}foreach(e){this.foreach_(ee(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(De(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}};var yt=class n{constructor(e){this.writeTree_=e}static empty(){return new n(new Ze(null))}};function ci(n,e,t){if(H(e))return new yt(new Ze(t));{let r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,o=r.value,a=ut(i,e);return o=o.updateChild(a,t),new yt(n.writeTree_.set(i,o))}else{let i=new Ze(t),o=n.writeTree_.setTree(e,i);return new yt(o)}}}function Jf(n,e,t){let r=n;return dt(t,(i,o)=>{r=ci(r,De(e,i),o)}),r}function Zf(n,e){if(H(e))return yt.empty();{let t=n.writeTree_.setTree(e,new Ze(null));return new yt(t)}}function vl(n,e){return Mn(n,e)!=null}function Mn(n,e){let t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(ut(t.path,e)):null}function ep(n){let e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(Ge,(r,i)=>{e.push(new X(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new X(r,i.value))}),e}function hn(n,e){if(H(e))return n;{let t=Mn(n,e);return t!=null?new yt(new Ze(t)):new yt(n.writeTree_.subtree(e))}}function wl(n){return n.writeTree_.isEmpty()}function _r(n,e){return Kp(ee(),n.writeTree_,e)}function Kp(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,o)=>{i===".priority"?(k(o.value!==null,"Priority writes must always be leaf nodes"),r=o.value):t=Kp(De(n,i),o,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(De(n,".priority"),r)),t}}function Wp(n,e){return Jp(e,n)}function PE(n,e,t,r,i){k(r>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=ci(n.visibleWrites,e,t)),n.lastWriteId=r}function NE(n,e){for(let t=0;t<n.allWrites.length;t++){let r=n.allWrites[t];if(r.writeId===e)return r}return null}function kE(n,e){let t=n.allWrites.findIndex(l=>l.writeId===e);k(t>=0,"removeWrite called with nonexistent writeId.");let r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,o=!1,a=n.allWrites.length-1;for(;i&&a>=0;){let l=n.allWrites[a];l.visible&&(a>=t&&DE(l,r.path)?i=!1:_t(r.path,l.path)&&(o=!0)),a--}if(i){if(o)return xE(n),!0;if(r.snap)n.visibleWrites=Zf(n.visibleWrites,r.path);else{let l=r.children;dt(l,h=>{n.visibleWrites=Zf(n.visibleWrites,De(r.path,h))})}return!0}else return!1}function DE(n,e){if(n.snap)return _t(n.path,e);for(let t in n.children)if(n.children.hasOwnProperty(t)&&_t(De(n.path,t),e))return!0;return!1}function xE(n){n.visibleWrites=Hp(n.allWrites,OE,ee()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function OE(n){return n.visible}function Hp(n,e,t){let r=yt.empty();for(let i=0;i<n.length;++i){let o=n[i];if(e(o)){let a=o.path,l;if(o.snap)_t(t,a)?(l=ut(t,a),r=ci(r,l,o.snap)):_t(a,t)&&(l=ut(a,t),r=ci(r,ee(),o.snap.getChild(l)));else if(o.children){if(_t(t,a))l=ut(t,a),r=Jf(r,l,o.children);else if(_t(a,t))if(l=ut(a,t),H(l))r=Jf(r,ee(),o.children);else{let h=yn(o.children,Y(l));if(h){let d=h.getChild(le(l));r=ci(r,ee(),d)}}}else throw Hn("WriteRecord should have .snap or .children")}}return r}function Qp(n,e,t,r,i){if(!r&&!i){let o=Mn(n.visibleWrites,e);if(o!=null)return o;{let a=hn(n.visibleWrites,e);if(wl(a))return t;if(t==null&&!vl(a,ee()))return null;{let l=t||ue.EMPTY_NODE;return _r(a,l)}}}else{let o=hn(n.visibleWrites,e);if(!i&&wl(o))return t;if(!i&&t==null&&!vl(o,ee()))return null;{let a=function(d){return(d.visible||i)&&(!r||!~r.indexOf(d.writeId))&&(_t(d.path,e)||_t(e,d.path))},l=Hp(n.allWrites,a,e),h=t||ue.EMPTY_NODE;return _r(l,h)}}}function ME(n,e,t){let r=ue.EMPTY_NODE,i=Mn(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Ge,(o,a)=>{r=r.updateImmediateChild(o,a)}),r;if(t){let o=hn(n.visibleWrites,e);return t.forEachChild(Ge,(a,l)=>{let h=_r(hn(o,new ne(a)),l);r=r.updateImmediateChild(a,h)}),ep(o).forEach(a=>{r=r.updateImmediateChild(a.name,a.node)}),r}else{let o=hn(n.visibleWrites,e);return ep(o).forEach(a=>{r=r.updateImmediateChild(a.name,a.node)}),r}}function FE(n,e,t,r,i){k(r||i,"Either existingEventSnap or existingServerSnap must exist");let o=De(e,t);if(vl(n.visibleWrites,o))return null;{let a=hn(n.visibleWrites,o);return wl(a)?i.getChild(t):_r(a,i.getChild(t))}}function LE(n,e,t,r){let i=De(e,t),o=Mn(n.visibleWrites,i);if(o!=null)return o;if(r.isCompleteForChild(t)){let a=hn(n.visibleWrites,i);return _r(a,r.getNode().getImmediateChild(t))}else return null}function VE(n,e){return Mn(n.visibleWrites,e)}function UE(n,e,t,r,i,o,a){let l,h=hn(n.visibleWrites,e),d=Mn(h,ee());if(d!=null)l=d;else if(t!=null)l=_r(h,t);else return[];if(l=l.withIndex(a),!l.isEmpty()&&!l.isLeafNode()){let m=[],g=a.getCompare(),T=o?l.getReverseIteratorFrom(r,a):l.getIteratorFrom(r,a),C=T.getNext();for(;C&&m.length<i;)g(C,r)!==0&&m.push(C),C=T.getNext();return m}else return[]}function BE(){return{visibleWrites:yt.empty(),allWrites:[],lastWriteId:-1}}function El(n,e,t,r){return Qp(n.writeTree,n.treePath,e,t,r)}function Yp(n,e){return ME(n.writeTree,n.treePath,e)}function tp(n,e,t,r){return FE(n.writeTree,n.treePath,e,t,r)}function Ms(n,e){return VE(n.writeTree,De(n.treePath,e))}function qE(n,e,t,r,i,o){return UE(n.writeTree,n.treePath,e,t,r,i,o)}function Ul(n,e,t){return LE(n.writeTree,n.treePath,e,t)}function Xp(n,e){return Jp(De(n.treePath,e),n.writeTree)}function Jp(n,e){return{treePath:n,writeTree:e}}var Tl=class{constructor(){this.changeMap=new Map}trackChildChange(e){let t=e.type,r=e.childName;k(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),k(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let o=i.type;if(t==="child_added"&&o==="child_removed")this.changeMap.set(r,Hf(r,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&o==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&o==="child_changed")this.changeMap.set(r,wE(r,i.oldSnap));else if(t==="child_changed"&&o==="child_added")this.changeMap.set(r,vE(r,e.snapshotNode));else if(t==="child_changed"&&o==="child_changed")this.changeMap.set(r,Hf(r,e.snapshotNode,i.oldSnap));else throw Hn("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var Il=class{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}},Zp=new Il,hi=class{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){let t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new ui(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Ul(this.writes_,e,r)}}getChildAfterChild(e,t,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:On(this.viewCache_),o=qE(this.writes_,i,t,1,r,e);return o.length===0?null:o[0]}};function $E(n,e){k(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),k(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function jE(n,e,t,r,i){let o=new Tl,a,l;if(t.type===$t.OVERWRITE){let d=t;d.source.fromUser?a=bl(n,e,d.path,d.snap,r,i,o):(k(d.source.fromServer,"Unknown source."),l=d.source.tagged||e.serverCache.isFiltered()&&!H(d.path),a=Fs(n,e,d.path,d.snap,r,i,l,o))}else if(t.type===$t.MERGE){let d=t;d.source.fromUser?a=GE(n,e,d.path,d.children,r,i,o):(k(d.source.fromServer,"Unknown source."),l=d.source.tagged||e.serverCache.isFiltered(),a=Sl(n,e,d.path,d.children,r,i,l,o))}else if(t.type===$t.ACK_USER_WRITE){let d=t;d.revert?a=HE(n,e,d.path,r,i,o):a=KE(n,e,d.path,d.affectedTree,r,i,o)}else if(t.type===$t.LISTEN_COMPLETE)a=WE(n,e,t.path,r,o);else throw Hn("Unknown operation type: "+t.type);let h=o.getChanges();return zE(e,a,h),{viewCache:a,changes:h}}function zE(n,e,t){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=yl(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&t.push(yE(yl(e)))}}function em(n,e,t,r,i,o){let a=e.eventCache;if(Ms(r,t)!=null)return e;{let l,h;if(H(t))if(k(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let d=On(e),m=d instanceof ue?d:ue.EMPTY_NODE,g=Yp(r,m);l=n.filter.updateFullNode(e.eventCache.getNode(),g,o)}else{let d=El(r,On(e));l=n.filter.updateFullNode(e.eventCache.getNode(),d,o)}else{let d=Y(t);if(d===".priority"){k(dn(t)===1,"Can't have a priority with additional path components");let m=a.getNode();h=e.serverCache.getNode();let g=tp(r,t,m,h);g!=null?l=n.filter.updatePriority(m,g):l=a.getNode()}else{let m=le(t),g;if(a.isCompleteForChild(d)){h=e.serverCache.getNode();let T=tp(r,t,a.getNode(),h);T!=null?g=a.getNode().getImmediateChild(d).updateChild(m,T):g=a.getNode().getImmediateChild(d)}else g=Ul(r,d,e.serverCache);g!=null?l=n.filter.updateChild(a.getNode(),d,g,m,i,o):l=a.getNode()}}return li(e,l,a.isFullyInitialized()||H(t),n.filter.filtersNodes())}}function Fs(n,e,t,r,i,o,a,l){let h=e.serverCache,d,m=a?n.filter:n.filter.getIndexedFilter();if(H(t))d=m.updateFullNode(h.getNode(),r,null);else if(m.filtersNodes()&&!h.isFiltered()){let C=h.getNode().updateChild(t,r);d=m.updateFullNode(h.getNode(),C,null)}else{let C=Y(t);if(!h.isCompleteForPath(t)&&dn(t)>1)return e;let A=le(t),P=h.getNode().getImmediateChild(C).updateChild(A,r);C===".priority"?d=m.updatePriority(h.getNode(),P):d=m.updateChild(h.getNode(),C,P,A,Zp,null)}let g=Gp(e,d,h.isFullyInitialized()||H(t),m.filtersNodes()),T=new hi(i,g,o);return em(n,g,t,i,T,l)}function bl(n,e,t,r,i,o,a){let l=e.eventCache,h,d,m=new hi(i,e,o);if(H(t))d=n.filter.updateFullNode(e.eventCache.getNode(),r,a),h=li(e,d,!0,n.filter.filtersNodes());else{let g=Y(t);if(g===".priority")d=n.filter.updatePriority(e.eventCache.getNode(),r),h=li(e,d,l.isFullyInitialized(),l.isFiltered());else{let T=le(t),C=l.getNode().getImmediateChild(g),A;if(H(T))A=r;else{let R=m.getCompleteChild(g);R!=null?kp(T)===".priority"&&R.getChild(xp(T)).isEmpty()?A=R:A=R.updateChild(T,r):A=ue.EMPTY_NODE}if(C.equals(A))h=e;else{let R=n.filter.updateChild(l.getNode(),g,A,T,m,a);h=li(e,R,l.isFullyInitialized(),n.filter.filtersNodes())}}}return h}function np(n,e){return n.eventCache.isCompleteForChild(e)}function GE(n,e,t,r,i,o,a){let l=e;return r.foreach((h,d)=>{let m=De(t,h);np(e,Y(m))&&(l=bl(n,l,m,d,i,o,a))}),r.foreach((h,d)=>{let m=De(t,h);np(e,Y(m))||(l=bl(n,l,m,d,i,o,a))}),l}function rp(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function Sl(n,e,t,r,i,o,a,l){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let h=e,d;H(t)?d=r:d=new Ze(null).setTree(t,r);let m=e.serverCache.getNode();return d.children.inorderTraversal((g,T)=>{if(m.hasChild(g)){let C=e.serverCache.getNode().getImmediateChild(g),A=rp(n,C,T);h=Fs(n,h,new ne(g),A,i,o,a,l)}}),d.children.inorderTraversal((g,T)=>{let C=!e.serverCache.isCompleteForChild(g)&&T.value===null;if(!m.hasChild(g)&&!C){let A=e.serverCache.getNode().getImmediateChild(g),R=rp(n,A,T);h=Fs(n,h,new ne(g),R,i,o,a,l)}}),h}function KE(n,e,t,r,i,o,a){if(Ms(i,t)!=null)return e;let l=e.serverCache.isFiltered(),h=e.serverCache;if(r.value!=null){if(H(t)&&h.isFullyInitialized()||h.isCompleteForPath(t))return Fs(n,e,t,h.getNode().getChild(t),i,o,l,a);if(H(t)){let d=new Ze(null);return h.getNode().forEachChild(hr,(m,g)=>{d=d.set(new ne(m),g)}),Sl(n,e,t,d,i,o,l,a)}else return e}else{let d=new Ze(null);return r.foreach((m,g)=>{let T=De(t,m);h.isCompleteForPath(T)&&(d=d.set(m,h.getNode().getChild(T)))}),Sl(n,e,t,d,i,o,l,a)}}function WE(n,e,t,r,i){let o=e.serverCache,a=Gp(e,o.getNode(),o.isFullyInitialized()||H(t),o.isFiltered());return em(n,a,t,r,Zp,i)}function HE(n,e,t,r,i,o){let a;if(Ms(r,t)!=null)return e;{let l=new hi(r,e,i),h=e.eventCache.getNode(),d;if(H(t)||Y(t)===".priority"){let m;if(e.serverCache.isFullyInitialized())m=El(r,On(e));else{let g=e.serverCache.getNode();k(g instanceof ue,"serverChildren would be complete if leaf node"),m=Yp(r,g)}m=m,d=n.filter.updateFullNode(h,m,o)}else{let m=Y(t),g=Ul(r,m,e.serverCache);g==null&&e.serverCache.isCompleteForChild(m)&&(g=h.getImmediateChild(m)),g!=null?d=n.filter.updateChild(h,m,g,le(t),l,o):e.eventCache.getNode().hasChild(m)?d=n.filter.updateChild(h,m,ue.EMPTY_NODE,le(t),l,o):d=h,d.isEmpty()&&e.serverCache.isFullyInitialized()&&(a=El(r,On(e)),a.isLeafNode()&&(d=n.filter.updateFullNode(d,a,o)))}return a=e.serverCache.isFullyInitialized()||Ms(r,ee())!=null,li(e,d,a,n.filter.filtersNodes())}}function QE(n,e){let t=On(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!H(e)&&!t.getImmediateChild(Y(e)).isEmpty())?t.getChild(e):null}function ip(n,e,t,r){e.type===$t.MERGE&&e.source.queryId!==null&&(k(On(n.viewCache_),"We should always have a full cache before handling merges"),k(yl(n.viewCache_),"Missing event cache, even though we have a server cache"));let i=n.viewCache_,o=jE(n.processor_,i,e,t,r);return $E(n.processor_,o.viewCache),k(o.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=o.viewCache,YE(n,o.changes,o.viewCache.eventCache.getNode(),null)}function YE(n,e,t,r){let i=r?[r]:n.eventRegistrations_;return SE(n.eventGenerator_,e,t,i)}var sp;function XE(n){k(!sp,"__referenceConstructor has already been defined"),sp=n}function Bl(n,e,t,r){let i=e.source.queryId;if(i!==null){let o=n.views.get(i);return k(o!=null,"SyncTree gave us an op for an invalid query."),ip(o,e,t,r)}else{let o=[];for(let a of n.views.values())o=o.concat(ip(a,e,t,r));return o}}function ql(n,e){let t=null;for(let r of n.views.values())t=t||QE(r,e);return t}var op;function JE(n){k(!op,"__referenceConstructor has already been defined"),op=n}var Ls=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Ze(null),this.pendingWriteTree_=BE(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function ZE(n,e,t,r,i){return PE(n.pendingWriteTree_,e,t,r,i),i?Us(n,new gr(qp(),e,t)):[]}function cr(n,e,t=!1){let r=NE(n.pendingWriteTree_,e);if(kE(n.pendingWriteTree_,e)){let o=new Ze(null);return r.snap!=null?o=o.set(ee(),!0):dt(r.children,a=>{o=o.set(new ne(a),!0)}),Us(n,new _l(r.path,o,t))}else return[]}function Vs(n,e,t){return Us(n,new gr($p(),e,t))}function eT(n,e,t){let r=Ze.fromObject(t);return Us(n,new Os($p(),e,r))}function tT(n,e,t,r){let i=im(n,r);if(i!=null){let o=sm(i),a=o.path,l=o.queryId,h=ut(a,e),d=new gr(jp(l),h,t);return om(n,a,d)}else return[]}function nT(n,e,t,r){let i=im(n,r);if(i){let o=sm(i),a=o.path,l=o.queryId,h=ut(a,e),d=Ze.fromObject(t),m=new Os(jp(l),h,d);return om(n,a,m)}else return[]}function tm(n,e,t){let i=n.pendingWriteTree_,o=n.syncPointTree_.findOnPath(e,(a,l)=>{let h=ut(a,e),d=ql(l,h);if(d)return d});return Qp(i,e,o,t,!0)}function Us(n,e){return nm(e,n.syncPointTree_,null,Wp(n.pendingWriteTree_,ee()))}function nm(n,e,t,r){if(H(n.path))return rm(n,e,t,r);{let i=e.get(ee());t==null&&i!=null&&(t=ql(i,ee()));let o=[],a=Y(n.path),l=n.operationForChild(a),h=e.children.get(a);if(h&&l){let d=t?t.getImmediateChild(a):null,m=Xp(r,a);o=o.concat(nm(l,h,d,m))}return i&&(o=o.concat(Bl(i,n,r,t))),o}}function rm(n,e,t,r){let i=e.get(ee());t==null&&i!=null&&(t=ql(i,ee()));let o=[];return e.children.inorderTraversal((a,l)=>{let h=t?t.getImmediateChild(a):null,d=Xp(r,a),m=n.operationForChild(a);m&&(o=o.concat(rm(m,l,h,d)))}),i&&(o=o.concat(Bl(i,n,r,t))),o}function im(n,e){return n.tagToQueryMap.get(e)}function sm(n){let e=n.indexOf("$");return k(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new ne(n.substr(0,e))}}function om(n,e,t){let r=n.syncPointTree_.get(e);k(r,"Missing sync point for query tag that we're tracking");let i=Wp(n.pendingWriteTree_,e);return Bl(r,t,i,null)}var Al=class n{constructor(e){this.node_=e}getImmediateChild(e){let t=this.node_.getImmediateChild(e);return new n(t)}node(){return this.node_}},Cl=class n{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){let t=De(this.path_,e);return new n(this.syncTree_,t)}node(){return tm(this.syncTree_,this.path_)}},rT=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},ap=function(n,e,t){if(!n||typeof n!="object")return n;if(k(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return iT(n[".sv"],e,t);if(typeof n[".sv"]=="object")return sT(n[".sv"],e);k(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},iT=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:k(!1,"Unexpected server value: "+n)}},sT=function(n,e,t){n.hasOwnProperty("increment")||k(!1,"Unexpected server value: "+JSON.stringify(n,null,2));let r=n.increment;typeof r!="number"&&k(!1,"Unexpected increment value: "+r);let i=e.node();if(k(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let a=i.getValue();return typeof a!="number"?r:a+r},oT=function(n,e,t,r){return $l(e,new Cl(t,n),r)},aT=function(n,e,t){return $l(n,new Al(e),t)};function $l(n,e,t){let r=n.getPriority().val(),i=ap(r,e.getImmediateChild(".priority"),t),o;if(n.isLeafNode()){let a=n,l=ap(a.getValue(),e,t);return l!==a.getValue()||i!==a.getPriority().val()?new pr(l,ze(i)):n}else{let a=n;return o=a,i!==a.getPriority().val()&&(o=o.updatePriority(new pr(i))),a.forEachChild(Ge,(l,h)=>{let d=$l(h,e.getImmediateChild(l),t);d!==h&&(o=o.updateImmediateChild(l,d))}),o}}var di=class{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}};function jl(n,e){let t=e instanceof ne?e:new ne(e),r=n,i=Y(t);for(;i!==null;){let o=yn(r.node.children,i)||{children:{},childCount:0};r=new di(i,r,o),t=le(t),i=Y(t)}return r}function wr(n){return n.node.value}function am(n,e){n.node.value=e,Rl(n)}function lm(n){return n.node.childCount>0}function lT(n){return wr(n)===void 0&&!lm(n)}function Bs(n,e){dt(n.node.children,(t,r)=>{e(new di(t,n,r))})}function cm(n,e,t,r){t&&!r&&e(n),Bs(n,i=>{cm(i,e,!0,r)}),t&&r&&e(n)}function cT(n,e,t){let r=t?n:n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function _i(n){return new ne(n.parent===null?n.name:_i(n.parent)+"/"+n.name)}function Rl(n){n.parent!==null&&uT(n.parent,n.name,n)}function uT(n,e,t){let r=lT(t),i=Tt(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,Rl(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,Rl(n))}var hT=/[\[\].#$\/\u0000-\u001F\u007F]/,dT=/[\[\].#$\u0000-\u001F\u007F]/,$a=10*1024*1024,um=function(n){return typeof n=="string"&&n.length!==0&&!hT.test(n)},fT=function(n){return typeof n=="string"&&n.length!==0&&!dT.test(n)},pT=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),fT(n)};var hm=function(n,e,t){let r=t instanceof ne?new nl(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+Nn(r));if(typeof e=="function")throw new Error(n+"contains a function "+Nn(r)+" with contents = "+e.toString());if(fp(e))throw new Error(n+"contains "+e.toString()+" "+Nn(r));if(typeof e=="string"&&e.length>$a/3&&$r(e)>$a)throw new Error(n+"contains a string greater than "+$a+" utf8 bytes "+Nn(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,o=!1;if(dt(e,(a,l)=>{if(a===".value")i=!0;else if(a!==".priority"&&a!==".sv"&&(o=!0,!um(a)))throw new Error(n+" contains an invalid key ("+a+") "+Nn(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);sE(r,a),hm(n,l,r),oE(r)}),i&&o)throw new Error(n+' contains ".value" child '+Nn(r)+" in addition to actual children.")}};var mT=function(n,e){let t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!um(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!pT(t))throw new Error(vh(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var Pl=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function gT(n,e){let t=null;for(let r=0;r<e.length;r++){let i=e[r],o=i.getPath();t!==null&&!Op(o,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:o}),t.events.push(i)}t&&n.eventLists_.push(t)}function Fn(n,e,t){gT(n,t),_T(n,r=>_t(r,e)||_t(e,r))}function _T(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){let i=n.eventLists_[r];if(i){let o=i.path;e(o)?(yT(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function yT(n){for(let e=0;e<n.events.length;e++){let t=n.events[e];if(t!==null){n.events[e]=null;let r=t.getEventRunner();Dn&&je("event: "+t.toString()),mi(r)}}}var vT="repo_interrupt",wT=25,Nl=class{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Pl,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=xs(),this.transactionQueueTree_=new di,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function ET(n,e,t){if(n.stats_=Fl(n.repoInfo_),n.forceRestClient_||Ow())n.server_=new dl(n.repoInfo_,(r,i,o,a)=>{lp(n,r,i,o,a)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>cp(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{be(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new Ll(n.repoInfo_,e,(r,i,o,a)=>{lp(n,r,i,o,a)},r=>{cp(n,r)},r=>{IT(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=Fw(n.repoInfo_,()=>new gl(n.stats_,n.server_)),n.infoData_=new fl,n.infoSyncTree_=new Ls({startListening:(r,i,o,a)=>{let l=[],h=n.infoData_.getNode(r._path);return h.isEmpty()||(l=Vs(n.infoSyncTree_,r._path,h),setTimeout(()=>{a("ok")},0)),l},stopListening:()=>{}}),zl(n,"connected",!1),n.serverSyncTree_=new Ls({startListening:(r,i,o,a)=>(n.server_.listen(r,o,i,(l,h)=>{let d=a(l,h);Fn(n.eventQueue_,r._path,d)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}function TT(n){let t=n.infoData_.getNode(new ne(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function dm(n){return rT({timestamp:TT(n)})}function lp(n,e,t,r,i){n.dataUpdateCount++;let o=new ne(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let a=[];if(i)if(r){let h=qr(t,d=>ze(d));a=nT(n.serverSyncTree_,o,h,i)}else{let h=ze(t);a=tT(n.serverSyncTree_,o,h,i)}else if(r){let h=qr(t,d=>ze(d));a=eT(n.serverSyncTree_,o,h)}else{let h=ze(t);a=Vs(n.serverSyncTree_,o,h)}let l=o;a.length>0&&(l=Kl(n,o)),Fn(n.eventQueue_,l,a)}function cp(n,e){zl(n,"connected",e),e===!1&&ST(n)}function IT(n,e){dt(e,(t,r)=>{zl(n,t,r)})}function zl(n,e,t){let r=new ne("/.info/"+e),i=ze(t);n.infoData_.updateSnapshot(r,i);let o=Vs(n.infoSyncTree_,r,i);Fn(n.eventQueue_,r,o)}function bT(n){return n.nextWriteId_++}function ST(n){fm(n,"onDisconnectEvents");let e=dm(n),t=xs();pl(n.onDisconnect_,ee(),(i,o)=>{let a=oT(i,o,n.serverSyncTree_,e);Bp(t,i,a)});let r=[];pl(t,ee(),(i,o)=>{r=r.concat(Vs(n.serverSyncTree_,i,o));let a=PT(n,i);Kl(n,a)}),n.onDisconnect_=xs(),Fn(n.eventQueue_,ee(),r)}function AT(n){n.persistentConnection_&&n.persistentConnection_.interrupt(vT)}function fm(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),je(t,...e)}function pm(n,e,t){return tm(n.serverSyncTree_,e,t)||ue.EMPTY_NODE}function Gl(n,e=n.transactionQueueTree_){if(e||qs(n,e),wr(e)){let t=gm(n,e);k(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&CT(n,_i(e),t)}else lm(e)&&Bs(e,t=>{Gl(n,t)})}function CT(n,e,t){let r=t.map(d=>d.currentWriteId),i=pm(n,e,r),o=i,a=i.hash();for(let d=0;d<t.length;d++){let m=t[d];k(m.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),m.status=1,m.retryCount++;let g=ut(e,m.path);o=o.updateChild(g,m.currentOutputSnapshotRaw)}let l=o.val(!0),h=e;n.server_.put(h.toString(),l,d=>{fm(n,"transaction put response",{path:h.toString(),status:d});let m=[];if(d==="ok"){let g=[];for(let T=0;T<t.length;T++)t[T].status=2,m=m.concat(cr(n.serverSyncTree_,t[T].currentWriteId)),t[T].onComplete&&g.push(()=>t[T].onComplete(null,!0,t[T].currentOutputSnapshotResolved)),t[T].unwatcher();qs(n,jl(n.transactionQueueTree_,e)),Gl(n,n.transactionQueueTree_),Fn(n.eventQueue_,e,m);for(let T=0;T<g.length;T++)mi(g[T])}else{if(d==="datastale")for(let g=0;g<t.length;g++)t[g].status===3?t[g].status=4:t[g].status=0;else{st("transaction at "+h.toString()+" failed: "+d);for(let g=0;g<t.length;g++)t[g].status=4,t[g].abortReason=d}Kl(n,e)}},a)}function Kl(n,e){let t=mm(n,e),r=_i(t),i=gm(n,t);return RT(n,i,r),r}function RT(n,e,t){if(e.length===0)return;let r=[],i=[],a=e.filter(l=>l.status===0).map(l=>l.currentWriteId);for(let l=0;l<e.length;l++){let h=e[l],d=ut(t,h.path),m=!1,g;if(k(d!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),h.status===4)m=!0,g=h.abortReason,i=i.concat(cr(n.serverSyncTree_,h.currentWriteId,!0));else if(h.status===0)if(h.retryCount>=wT)m=!0,g="maxretry",i=i.concat(cr(n.serverSyncTree_,h.currentWriteId,!0));else{let T=pm(n,h.path,a);h.currentInputSnapshot=T;let C=e[l].update(T.val());if(C!==void 0){hm("transaction failed: Data returned ",C,h.path);let A=ze(C);typeof C=="object"&&C!=null&&Tt(C,".priority")||(A=A.updatePriority(T.getPriority()));let P=h.currentWriteId,U=dm(n),$=aT(A,T,U);h.currentOutputSnapshotRaw=A,h.currentOutputSnapshotResolved=$,h.currentWriteId=bT(n),a.splice(a.indexOf(P),1),i=i.concat(ZE(n.serverSyncTree_,h.path,$,h.currentWriteId,h.applyLocally)),i=i.concat(cr(n.serverSyncTree_,P,!0))}else m=!0,g="nodata",i=i.concat(cr(n.serverSyncTree_,h.currentWriteId,!0))}Fn(n.eventQueue_,t,i),i=[],m&&(e[l].status=2,function(T){setTimeout(T,Math.floor(0))}(e[l].unwatcher),e[l].onComplete&&(g==="nodata"?r.push(()=>e[l].onComplete(null,!1,e[l].currentInputSnapshot)):r.push(()=>e[l].onComplete(new Error(g),!1,null))))}qs(n,n.transactionQueueTree_);for(let l=0;l<r.length;l++)mi(r[l]);Gl(n,n.transactionQueueTree_)}function mm(n,e){let t,r=n.transactionQueueTree_;for(t=Y(e);t!==null&&wr(r)===void 0;)r=jl(r,t),e=le(e),t=Y(e);return r}function gm(n,e){let t=[];return _m(n,e,t),t.sort((r,i)=>r.order-i.order),t}function _m(n,e,t){let r=wr(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);Bs(e,i=>{_m(n,i,t)})}function qs(n,e){let t=wr(e);if(t){let r=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[r]=t[i],r++);t.length=r,am(e,t.length>0?t:void 0)}Bs(e,r=>{qs(n,r)})}function PT(n,e){let t=_i(mm(n,e)),r=jl(n.transactionQueueTree_,e);return cT(r,i=>{ja(n,i)}),ja(n,r),cm(r,i=>{ja(n,i)}),t}function ja(n,e){let t=wr(e);if(t){let r=[],i=[],o=-1;for(let a=0;a<t.length;a++)t[a].status===3||(t[a].status===1?(k(o===a-1,"All SENT items should be at beginning of queue."),o=a,t[a].status=3,t[a].abortReason="set"):(k(t[a].status===0,"Unexpected transaction status in abort"),t[a].unwatcher(),i=i.concat(cr(n.serverSyncTree_,t[a].currentWriteId,!0)),t[a].onComplete&&r.push(t[a].onComplete.bind(null,new Error("set"),!1,null))));o===-1?am(e,void 0):t.length=o+1,Fn(n.eventQueue_,_i(e),i);for(let a=0;a<r.length;a++)mi(r[a])}}function NT(n){let e="",t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function kT(n){let e={};n.charAt(0)==="?"&&(n=n.substring(1));for(let t of n.split("&")){if(t.length===0)continue;let r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):st(`Invalid query segment '${t}' in query '${n}'`)}return e}var up=function(n,e){let t=DT(n),r=t.namespace;t.domain==="firebase.com"&&jt(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&jt("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||Aw();let i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new As(t.host,t.secure,r,i,e,"",r!==t.subdomain),path:new ne(t.pathString)}},DT=function(n){let e="",t="",r="",i="",o="",a=!0,l="https",h=443;if(typeof n=="string"){let d=n.indexOf("//");d>=0&&(l=n.substring(0,d-1),n=n.substring(d+2));let m=n.indexOf("/");m===-1&&(m=n.length);let g=n.indexOf("?");g===-1&&(g=n.length),e=n.substring(0,Math.min(m,g)),m<g&&(i=NT(n.substring(m,g)));let T=kT(n.substring(Math.min(n.length,g)));d=e.indexOf(":"),d>=0?(a=l==="https"||l==="wss",h=parseInt(e.substring(d+1),10)):d=e.length;let C=e.slice(0,d);if(C.toLowerCase()==="localhost")t="localhost";else if(C.split(".").length<=2)t=C;else{let A=e.indexOf(".");r=e.substring(0,A).toLowerCase(),t=e.substring(A+1),o=r}"ns"in T&&(o=T.ns)}return{host:e,port:h,domain:t,subdomain:r,secure:a,scheme:l,pathString:i,namespace:o}};var kl=class n{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return H(this._path)?null:kp(this._path)}get ref(){return new yr(this._repo,this._path)}get _queryIdentifier(){let e=Yf(this._queryParams),t=Ml(e);return t==="{}"?"default":t}get _queryObject(){return Yf(this._queryParams)}isEqual(e){if(e=ye(e),!(e instanceof n))return!1;let t=this._repo===e._repo,r=Op(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+iE(this._path)}};var yr=class n extends kl{constructor(e,t){super(e,t,new hl,!1)}get parent(){let e=xp(this._path);return e===null?null:new n(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}};XE(yr);JE(yr);var xT="FIREBASE_DATABASE_EMULATOR_HOST",Dl={},OT=!1;function MT(n,e,t,r){n.repoInfo_=new As(e,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0,t),r&&(n.authTokenProvider_=r)}function FT(n,e,t,r,i){let o=r||n.options.databaseURL;o===void 0&&(n.options.projectId||jt("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),je("Using default host for project ",n.options.projectId),o=`${n.options.projectId}-default-rtdb.firebaseio.com`);let a=up(o,i),l=a.repoInfo,h,d;typeof process<"u"&&process.env&&(d=process.env[xT]),d?(h=!0,o=`http://${d}?ns=${l.namespace}`,a=up(o,i),l=a.repoInfo):h=!a.repoInfo.secure;let m=i&&h?new ai(ai.OWNER):new Qa(n.name,n.options,e);mT("Invalid Firebase Database URL",a),H(a.path)||jt("Database URL must point to the root of a Firebase Database (not including a child path).");let g=VT(l,n,m,new Ha(n,t));return new xl(g,n)}function LT(n,e){let t=Dl[e];(!t||t[n.key]!==n)&&jt(`Database ${e}(${n.repoInfo_}) has already been deleted.`),AT(n),delete t[n.key]}function VT(n,e,t,r){let i=Dl[e.name];i||(i={},Dl[e.name]=i);let o=i[n.toURLString()];return o&&jt("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new Nl(n,OT,t,r),i[n.toURLString()]=o,o}var xl=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(ET(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new yr(this._repo,ee())),this._rootInternal}_delete(){return this._rootInternal!==null&&(LT(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&jt("Cannot call "+e+" on a deleted database.")}};function ym(n=$e(),e){let t=Me(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){let r=tn("database");r&&vm(t,...r)}return t}function vm(n,e,t,r={}){n=ye(n),n._checkNotDeleted("useEmulator");let i=`${e}:${t}`,o=n._repoInternal;if(n._instanceStarted){if(i===n._repoInternal.repoInfo_.host&&rn(r,o.repoInfo_.emulatorOptions))return;jt("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let a;if(o.repoInfo_.nodeAdmin)r.mockUserToken&&jt('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),a=new ai(ai.OWNER);else if(r.mockUserToken){let l=typeof r.mockUserToken=="string"?r.mockUserToken:Qn(r.mockUserToken,n.app.options.projectId);a=new ai(l)}MT(o,i,r,a)}function UT(n){Iw(on),Ae(new Se("database",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return FT(r,i,o,t)},"PUBLIC").setMultipleInstances(!0)),B(Df,xf,n),B(Df,xf,"esm2017")}Ll.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};Ll.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};UT();var yi=class{constructor(e){return e}},wm="database",Wl=class{constructor(){return Re(wm)}};var Hl=new we("angularfire2.database-instances");function BT(n,e){let t=Ce(wm,n,e);return t&&new yi(t)}function qT(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new yi(r)}}var $T={provide:Wl,deps:[[new K,Hl]]},jT={provide:yi,useFactory:BT,deps:[[new K,Hl],Ne]};function Em(n,...e){return B("angularfire",ve.full,"rtdb"),Ee([jT,$T,{provide:Hl,useFactory:qT(n),multi:!0,deps:[ce,me,Pe,ke,[new K,an],[new K,bt],...e]}])}var Tm=_e(ym,!0);var Sm="functions";var Ql=class{constructor(e,t,r,i){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,Ut(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||t.get().then(o=>this.auth=o,()=>{}),this.messaging||r.get().then(o=>this.messaging=o,()=>{}),this.appCheck||i?.get().then(o=>this.appCheck=o,()=>{})}getAuthToken(){return x(this,null,function*(){if(this.auth)try{let e=yield this.auth.getToken();return e?.accessToken}catch{return}})}getMessagingToken(){return x(this,null,function*(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return yield this.messaging.getToken()}catch{return}})}getAppCheckToken(e){return x(this,null,function*(){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){let t=e?yield this.appCheck.getLimitedUseToken():yield this.appCheck.getToken();return t.error?null:t.token}return null})}getContext(e){return x(this,null,function*(){let t=yield this.getAuthToken(),r=yield this.getMessagingToken(),i=yield this.getAppCheckToken(e);return{authToken:t,messagingToken:r,appCheckToken:i}})}};var Yl="us-central1";var Xl=class{constructor(e,t,r,i,o=Yl,a=(...l)=>fetch(...l)){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new Ql(e,t,r,i),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{let l=new URL(o);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=Yl}catch{this.customDomain=null,this.region=o}}_delete(){return this.deleteService()}_url(e){let t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}};function zT(n,e,t){n.emulatorOrigin=`http://${e}:${t}`}var Im="@firebase/functions",bm="0.12.3";var GT="auth-internal",KT="app-check-internal",WT="messaging-internal";function HT(n){let e=(t,{instanceIdentifier:r})=>{let i=t.getProvider("app").getImmediate(),o=t.getProvider(GT),a=t.getProvider(WT),l=t.getProvider(KT);return new Xl(i,o,a,l,r)};Ae(new Se(Sm,e,"PUBLIC").setMultipleInstances(!0)),B(Im,bm,n),B(Im,bm,"esm2017")}function Am(n=$e(),e=Yl){let r=Me(ye(n),Sm).getImmediate({identifier:e}),i=tn("functions");return i&&Cm(r,...i),r}function Cm(n,e,t){zT(ye(n),e,t)}HT();var vi=class{constructor(e){return e}},Rm="functions",Jl=class{constructor(){return Re(Rm)}};var Zl=new we("angularfire2.functions-instances");function QT(n,e){let t=Ce(Rm,n,e);return t&&new vi(t)}function YT(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new vi(r)}}var XT={provide:Jl,deps:[[new K,Zl]]},JT={provide:vi,useFactory:QT,deps:[[new K,Zl],Ne]};function Pm(n,...e){return B("angularfire",ve.full,"fn"),Ee([JT,XT,{provide:Zl,useFactory:YT(n),multi:!0,deps:[ce,me,Pe,ke,[new K,an],[new K,bt],...e]}])}var Nm=_e(Am,!0);var ZT="/firebase-messaging-sw.js",eI="/firebase-cloud-messaging-push-scope",Lm="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",tI="https://fcmregistrations.googleapis.com/v1",Vm="google.c.a.c_id",nI="google.c.a.c_l",rI="google.c.a.ts",iI="google.c.a.e",km=1e4;var $s=function(n){return n.PUSH_RECEIVED="push-received",n.NOTIFICATION_CLICKED="notification-clicked",n}($s||{});function zt(n){let e=new Uint8Array(n);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function sI(n){let e="=".repeat((4-n.length%4)%4),t=(n+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(t),i=new Uint8Array(r.length);for(let o=0;o<r.length;++o)i[o]=r.charCodeAt(o);return i}var ec="fcm_token_details_db",oI=5,Dm="fcm_token_object_Store";function aI(n){return x(this,null,function*(){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(o=>o.name).includes(ec))return null;let e=null;return(yield Ao(ec,oI,{upgrade:(r,i,o,a)=>x(this,null,function*(){var l;if(i<2||!r.objectStoreNames.contains(Dm))return;let h=a.objectStore(Dm),d=yield h.index("fcmSenderId").get(n);if(yield h.clear(),!!d){if(i===2){let m=d;if(!m.auth||!m.p256dh||!m.endpoint)return;e={token:m.fcmToken,createTime:(l=m.createTime)!==null&&l!==void 0?l:Date.now(),subscriptionOptions:{auth:m.auth,p256dh:m.p256dh,endpoint:m.endpoint,swScope:m.swScope,vapidKey:typeof m.vapidKey=="string"?m.vapidKey:zt(m.vapidKey)}}}else if(i===3){let m=d;e={token:m.fcmToken,createTime:m.createTime,subscriptionOptions:{auth:zt(m.auth),p256dh:zt(m.p256dh),endpoint:m.endpoint,swScope:m.swScope,vapidKey:zt(m.vapidKey)}}}else if(i===4){let m=d;e={token:m.fcmToken,createTime:m.createTime,subscriptionOptions:{auth:zt(m.auth),p256dh:zt(m.p256dh),endpoint:m.endpoint,swScope:m.swScope,vapidKey:zt(m.vapidKey)}}}}})})).close(),yield Gi(ec),yield Gi("fcm_vapid_details_db"),yield Gi("undefined"),lI(e)?e:null})}function lI(n){if(!n||!n.subscriptionOptions)return!1;let{subscriptionOptions:e}=n;return typeof n.createTime=="number"&&n.createTime>0&&typeof n.token=="string"&&n.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}var cI="firebase-messaging-database",uI=1,wi="firebase-messaging-store",tc=null;function Um(){return tc||(tc=Ao(cI,uI,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(wi)}}})),tc}function hI(n){return x(this,null,function*(){let e=Bm(n),r=yield(yield Um()).transaction(wi).objectStore(wi).get(e);if(r)return r;{let i=yield aI(n.appConfig.senderId);if(i)return yield ic(n,i),i}})}function ic(n,e){return x(this,null,function*(){let t=Bm(n),i=(yield Um()).transaction(wi,"readwrite");return yield i.objectStore(wi).put(e,t),yield i.done,e})}function Bm({appConfig:n}){return n.appId}var dI={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},Ye=new Xn("messaging","Messaging",dI);function fI(n,e){return x(this,null,function*(){let t=yield oc(n),r=qm(e),i={method:"POST",headers:t,body:JSON.stringify(r)},o;try{o=yield(yield fetch(sc(n.appConfig),i)).json()}catch(a){throw Ye.create("token-subscribe-failed",{errorInfo:a?.toString()})}if(o.error){let a=o.error.message;throw Ye.create("token-subscribe-failed",{errorInfo:a})}if(!o.token)throw Ye.create("token-subscribe-no-token");return o.token})}function pI(n,e){return x(this,null,function*(){let t=yield oc(n),r=qm(e.subscriptionOptions),i={method:"PATCH",headers:t,body:JSON.stringify(r)},o;try{o=yield(yield fetch(`${sc(n.appConfig)}/${e.token}`,i)).json()}catch(a){throw Ye.create("token-update-failed",{errorInfo:a?.toString()})}if(o.error){let a=o.error.message;throw Ye.create("token-update-failed",{errorInfo:a})}if(!o.token)throw Ye.create("token-update-no-token");return o.token})}function mI(n,e){return x(this,null,function*(){let r={method:"DELETE",headers:yield oc(n)};try{let o=yield(yield fetch(`${sc(n.appConfig)}/${e}`,r)).json();if(o.error){let a=o.error.message;throw Ye.create("token-unsubscribe-failed",{errorInfo:a})}}catch(i){throw Ye.create("token-unsubscribe-failed",{errorInfo:i?.toString()})}})}function sc({projectId:n}){return`${tI}/projects/${n}/registrations`}function oc(t){return x(this,arguments,function*({appConfig:n,installations:e}){let r=yield e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":`FIS ${r}`})})}function qm({p256dh:n,auth:e,endpoint:t,vapidKey:r}){let i={web:{endpoint:t,auth:e,p256dh:n}};return r!==Lm&&(i.web.applicationPubKey=r),i}var gI=7*24*60*60*1e3;function _I(n){return x(this,null,function*(){let e=yield vI(n.swRegistration,n.vapidKey),t={vapidKey:n.vapidKey,swScope:n.swRegistration.scope,endpoint:e.endpoint,auth:zt(e.getKey("auth")),p256dh:zt(e.getKey("p256dh"))},r=yield hI(n.firebaseDependencies);if(r){if(wI(r.subscriptionOptions,t))return Date.now()>=r.createTime+gI?yI(n,{token:r.token,createTime:Date.now(),subscriptionOptions:t}):r.token;try{yield mI(n.firebaseDependencies,r.token)}catch(i){console.warn(i)}return xm(n.firebaseDependencies,t)}else return xm(n.firebaseDependencies,t)})}function yI(n,e){return x(this,null,function*(){try{let t=yield pI(n.firebaseDependencies,e),r=Object.assign(Object.assign({},e),{token:t,createTime:Date.now()});return yield ic(n.firebaseDependencies,r),t}catch(t){throw t}})}function xm(n,e){return x(this,null,function*(){let r={token:yield fI(n,e),createTime:Date.now(),subscriptionOptions:e};return yield ic(n,r),r.token})}function vI(n,e){return x(this,null,function*(){let t=yield n.pushManager.getSubscription();return t||n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:sI(e)})})}function wI(n,e){let t=e.vapidKey===n.vapidKey,r=e.endpoint===n.endpoint,i=e.auth===n.auth,o=e.p256dh===n.p256dh;return t&&r&&i&&o}function Om(n){let e={from:n.from,collapseKey:n.collapse_key,messageId:n.fcmMessageId};return EI(e,n),TI(e,n),II(e,n),e}function EI(n,e){if(!e.notification)return;n.notification={};let t=e.notification.title;t&&(n.notification.title=t);let r=e.notification.body;r&&(n.notification.body=r);let i=e.notification.image;i&&(n.notification.image=i);let o=e.notification.icon;o&&(n.notification.icon=o)}function TI(n,e){e.data&&(n.data=e.data)}function II(n,e){var t,r,i,o,a;if(!e.fcmOptions&&!(!((t=e.notification)===null||t===void 0)&&t.click_action))return;n.fcmOptions={};let l=(i=(r=e.fcmOptions)===null||r===void 0?void 0:r.link)!==null&&i!==void 0?i:(o=e.notification)===null||o===void 0?void 0:o.click_action;l&&(n.fcmOptions.link=l);let h=(a=e.fcmOptions)===null||a===void 0?void 0:a.analytics_label;h&&(n.fcmOptions.analyticsLabel=h)}function bI(n){return typeof n=="object"&&!!n&&Vm in n}SI("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");function SI(n,e){let t=[];for(let r=0;r<n.length;r++)t.push(n.charAt(r)),r<e.length&&t.push(e.charAt(r));return t.join("")}function AI(n){if(!n||!n.options)throw nc("App Configuration Object");if(!n.name)throw nc("App Name");let e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=n;for(let r of e)if(!t[r])throw nc(r);return{appName:n.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}function nc(n){return Ye.create("missing-app-config-values",{valueName:n})}var rc=class{constructor(e,t,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;let i=AI(e);this.firebaseDependencies={app:e,appConfig:i,installations:t,analyticsProvider:r}}_delete(){return Promise.resolve()}};function CI(n){return x(this,null,function*(){try{n.swRegistration=yield navigator.serviceWorker.register(ZT,{scope:eI}),n.swRegistration.update().catch(()=>{}),yield RI(n.swRegistration)}catch(e){throw Ye.create("failed-service-worker-registration",{browserErrorMessage:e?.message})}})}function RI(n){return x(this,null,function*(){return new Promise((e,t)=>{let r=setTimeout(()=>t(new Error(`Service worker not registered after ${km} ms`)),km),i=n.installing||n.waiting;n.active?(clearTimeout(r),e()):i?i.onstatechange=o=>{var a;((a=o.target)===null||a===void 0?void 0:a.state)==="activated"&&(i.onstatechange=null,clearTimeout(r),e())}:(clearTimeout(r),t(new Error("No incoming service worker found.")))})})}function PI(n,e){return x(this,null,function*(){if(!e&&!n.swRegistration&&(yield CI(n)),!(!e&&n.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw Ye.create("invalid-sw-registration");n.swRegistration=e}})}function NI(n,e){return x(this,null,function*(){e?n.vapidKey=e:n.vapidKey||(n.vapidKey=Lm)})}function kI(n,e){return x(this,null,function*(){if(!navigator)throw Ye.create("only-available-in-window");if(Notification.permission==="default"&&(yield Notification.requestPermission()),Notification.permission!=="granted")throw Ye.create("permission-blocked");return yield NI(n,e?.vapidKey),yield PI(n,e?.serviceWorkerRegistration),_I(n)})}function DI(n,e,t){return x(this,null,function*(){let r=xI(e);(yield n.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:t[Vm],message_name:t[nI],message_time:t[rI],message_device_time:Math.floor(Date.now()/1e3)})})}function xI(n){switch(n){case $s.NOTIFICATION_CLICKED:return"notification_open";case $s.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function OI(n,e){return x(this,null,function*(){let t=e.data;if(!t.isFirebaseMessaging)return;n.onMessageHandler&&t.messageType===$s.PUSH_RECEIVED&&(typeof n.onMessageHandler=="function"?n.onMessageHandler(Om(t)):n.onMessageHandler.next(Om(t)));let r=t.data;bI(r)&&r[iI]==="1"&&(yield DI(n,t.messageType,r))})}var Mm="@firebase/messaging",Fm="0.12.17";var MI=n=>{let e=new rc(n.getProvider("app").getImmediate(),n.getProvider("installations-internal").getImmediate(),n.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",t=>OI(e,t)),e},FI=n=>{let e=n.getProvider("messaging").getImmediate();return{getToken:r=>kI(e,r)}};function LI(){Ae(new Se("messaging",MI,"PUBLIC")),Ae(new Se("messaging-internal",FI,"PRIVATE")),B(Mm,Fm),B(Mm,Fm,"esm2017")}function $m(){return x(this,null,function*(){try{yield Yn()}catch{return!1}return typeof window<"u"&&nn()&&Br()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})}function jm(n=$e()){return $m().then(e=>{if(!e)throw Ye.create("unsupported-browser")},e=>{throw Ye.create("indexed-db-unsupported")}),Me(ye(n),"messaging").getImmediate()}LI();var Ei=class{constructor(e){return e}},zm="messaging",ac=class{constructor(){return Re(zm)}};var lc=new we("angularfire2.messaging-instances");function VI(n,e,t){if(Wn(t))return null;let r=Ce(zm,n,e);return r&&new Ei(r)}function UI(n){return(e,t,r)=>{if(Wn(r))return null;let i=e.runOutsideAngular(()=>n(t));return new Ei(i)}}var BI={provide:ac,deps:[[new K,lc]]},qI={provide:Ei,useFactory:VI,deps:[[new K,lc],Ne,lt]};function Gm(n,...e){return B("angularfire",ve.full,"fcm"),Ee([qI,BI,{provide:lc,useFactory:UI(n),multi:!0,deps:[ce,me,lt,Pe,ke,...e]}])}var Km=_e(jm,!0);var Ti=class{constructor(e){return e}},Wm="performance",cc=class{constructor(){return Re(Wm)}};var uc=new we("angularfire2.performance-instances");function $I(n,e,t){if(!Kn(t))return null;let r=Ce(Wm,n,e);return r&&new Ti(r)}function jI(n){return(e,t,r)=>{if(!Kn(t))return null;let i=e.runOutsideAngular(()=>n(r));return new Ti(i)}}var zI={provide:cc,deps:[[new K,uc]]},GI={provide:Ti,useFactory:$I,deps:[[new K,uc],Ne,lt]};function Hm(n,...e){return B("angularfire",ve.full,"perf"),Ee([GI,zI,{provide:uc,useFactory:jI(n),multi:!0,deps:[ce,lt,me,Pe,ke,...e]}])}var Qm=_e(zh,!0);var tg="firebasestorage.googleapis.com",KI="storageBucket",WI=2*60*1e3,HI=10*60*1e3;var Pt=class n extends Et{constructor(e,t,r=0){super(hc(e),`Firebase Storage: ${t} (${hc(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,n.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return hc(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},Kt=function(n){return n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment",n}(Kt||{});function hc(n){return"storage/"+n}function QI(){let n="An unknown error occurred, please check the error payload for server response.";return new Pt(Kt.UNKNOWN,n)}function YI(){return new Pt(Kt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function XI(){return new Pt(Kt.CANCELED,"User canceled the upload/download.")}function JI(n){return new Pt(Kt.INVALID_URL,"Invalid URL '"+n+"'.")}function ZI(n){return new Pt(Kt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function Ym(n){return new Pt(Kt.INVALID_ARGUMENT,n)}function ng(){return new Pt(Kt.APP_DELETED,"The Firebase app was deleted.")}function eb(n){return new Pt(Kt.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}var Gt=class n{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=n.makeFromUrl(e,t)}catch{return new n(e,"")}if(r.path==="")return r;throw ZI(e)}static makeFromUrl(e,t){let r=null,i="([A-Za-z0-9.\\-_]+)";function o(q){q.path.charAt(q.path.length-1)==="/"&&(q.path_=q.path_.slice(0,-1))}let a="(/(.*))?$",l=new RegExp("^gs://"+i+a,"i"),h={bucket:1,path:3};function d(q){q.path_=decodeURIComponent(q.path)}let m="v[A-Za-z0-9_]+",g=t.replace(/[.]/g,"\\."),T="(/([^?#]*).*)?$",C=new RegExp(`^https?://${g}/${m}/b/${i}/o${T}`,"i"),A={bucket:1,path:3},R=t===tg?"(?:storage.googleapis.com|storage.cloud.google.com)":t,P="([^?#]*)",U=new RegExp(`^https?://${R}/${i}/${P}`,"i"),j=[{regex:l,indices:h,postModify:o},{regex:C,indices:A,postModify:d},{regex:U,indices:{bucket:1,path:2},postModify:d}];for(let q=0;q<j.length;q++){let Ve=j[q],ie=Ve.regex.exec(e);if(ie){let w=ie[Ve.indices.bucket],p=ie[Ve.indices.path];p||(p=""),r=new n(w,p),Ve.postModify(r);break}}if(r==null)throw JI(e);return r}},dc=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function tb(n,e,t){let r=1,i=null,o=null,a=!1,l=0;function h(){return l===2}let d=!1;function m(...P){d||(d=!0,e.apply(null,P))}function g(P){i=setTimeout(()=>{i=null,n(C,h())},P)}function T(){o&&clearTimeout(o)}function C(P,...U){if(d){T();return}if(P){T(),m.call(null,P,...U);return}if(h()||a){T(),m.call(null,P,...U);return}r<64&&(r*=2);let j;l===1?(l=2,j=0):j=(r+Math.random())*1e3,g(j)}let A=!1;function R(P){A||(A=!0,T(),!d&&(i!==null?(P||(l=2),clearTimeout(i),g(0)):P||(l=1)))}return g(0),o=setTimeout(()=>{a=!0,R(!0)},t),R}function nb(n){n(!1)}function rb(n){return n!==void 0}function Xm(n,e,t,r){if(r<e)throw Ym(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw Ym(`Invalid value for '${n}'. Expected ${t} or less.`)}function ib(n){let e=encodeURIComponent,t="?";for(let r in n)if(n.hasOwnProperty(r)){let i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var fc=function(n){return n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",n}(fc||{});function sb(n,e){let t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,o=e.indexOf(n)!==-1;return t||i||o}var pc=class{constructor(e,t,r,i,o,a,l,h,d,m,g,T=!0){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=o,this.additionalRetryCodes_=a,this.callback_=l,this.errorCallback_=h,this.timeout_=d,this.progressCallback_=m,this.connectionFactory_=g,this.retry=T,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((C,A)=>{this.resolve_=C,this.reject_=A,this.start_()})}start_(){let e=(r,i)=>{if(i){r(!1,new Er(!1,null,!0));return}let o=this.connectionFactory_();this.pendingConnection_=o;let a=l=>{let h=l.loaded,d=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(h,d)};this.progressCallback_!==null&&o.addUploadProgressListener(a),o.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&o.removeUploadProgressListener(a),this.pendingConnection_=null;let l=o.getErrorCode()===fc.NO_ERROR,h=o.getStatus();if(!l||sb(h,this.additionalRetryCodes_)&&this.retry){let m=o.getErrorCode()===fc.ABORT;r(!1,new Er(!1,null,m));return}let d=this.successCodes_.indexOf(h)!==-1;r(!0,new Er(d,o))})},t=(r,i)=>{let o=this.resolve_,a=this.reject_,l=i.connection;if(i.wasSuccessCode)try{let h=this.callback_(l,l.getResponse());rb(h)?o(h):o()}catch(h){a(h)}else if(l!==null){let h=QI();h.serverResponse=l.getErrorText(),this.errorCallback_?a(this.errorCallback_(l,h)):a(h)}else if(i.canceled){let h=this.appDelete_?ng():XI();a(h)}else{let h=YI();a(h)}};this.canceled_?t(!1,new Er(!1,null,!0)):this.backoffId_=tb(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&nb(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},Er=class{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}};function ob(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function ab(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function lb(n,e){e&&(n["X-Firebase-GMPID"]=e)}function cb(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function ub(n,e,t,r,i,o,a=!0){let l=ib(n.urlParams),h=n.url+l,d=Object.assign({},n.headers);return lb(d,e),ob(d,t),ab(d,o),cb(d,r),new pc(h,n.method,d,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,a)}function hb(n){if(n.length===0)return null;let e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function db(n){let e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}var hP=256*1024;var mc=class n{constructor(e,t){this._service=e,t instanceof Gt?this._location=t:this._location=Gt.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new n(e,t)}get root(){let e=new Gt(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return db(this._location.path)}get storage(){return this._service}get parent(){let e=hb(this._location.path);if(e===null)return null;let t=new Gt(this._location.bucket,e);return new n(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw eb(e)}};function Jm(n,e){let t=e?.[KI];return t==null?null:Gt.makeFromBucketSpec(t,n)}function fb(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";let{mockUserToken:i}=r;i&&(n._overrideAuthToken=typeof i=="string"?i:Qn(i,n.app.options.projectId))}var gc=class{constructor(e,t,r,i,o){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=o,this._bucket=null,this._host=tg,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=WI,this._maxUploadRetryTime=HI,this._requests=new Set,i!=null?this._bucket=Gt.makeFromBucketSpec(i,this._host):this._bucket=Jm(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Gt.makeFromBucketSpec(this._url,e):this._bucket=Jm(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Xm("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Xm("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return x(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let t=yield e.getToken();if(t!==null)return t.accessToken}return null})}_getAppCheckToken(){return x(this,null,function*(){if(Ut(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new mc(this,e)}_makeRequest(e,t,r,i,o=!0){if(this._deleted)return new dc(ng());{let a=ub(e,this._appId,r,i,t,this._firebaseVersion,o);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}makeRequestWithTokens(e,t){return x(this,null,function*(){let[r,i]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()})}},Zm="@firebase/storage",eg="0.13.7";var rg="storage";function ig(n=$e(),e){n=ye(n);let r=Me(n,rg).getImmediate({identifier:e}),i=tn("storage");return i&&sg(r,...i),r}function sg(n,e,t,r={}){fb(n,e,t,r)}function pb(n,{instanceIdentifier:e}){let t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new gc(t,r,i,e,on)}function mb(){Ae(new Se(rg,pb,"PUBLIC").setMultipleInstances(!0)),B(Zm,eg,""),B(Zm,eg,"esm2017")}mb();var Ii=class{constructor(e){return e}},og="storage",_c=class{constructor(){return Re(og)}};var yc=new we("angularfire2.storage-instances");function gb(n,e){let t=Ce(og,n,e);return t&&new Ii(t)}function _b(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Ii(r)}}var yb={provide:_c,deps:[[new K,yc]]},vb={provide:Ii,useFactory:gb,deps:[[new K,yc],Ne]};function ag(n,...e){return B("angularfire",ve.full,"gcs"),Ee([vb,yb,{provide:yc,useFactory:_b(n),multi:!0,deps:[ce,me,Pe,ke,[new K,an],[new K,bt],...e]}])}var lg=_e(ig,!0);var vc="@firebase/remote-config",cg="0.6.0";var hg="remote-config",ug=100;var wb={"already-initialized":"Remote Config already initialized","registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser","custom-signal-max-allowed-signals":"Setting more than {$maxSignals} custom signals is not supported."},et=new Xn("remoteconfig","Remote Config",wb);function dg(n=$e(),e={}){var t,r;n=ye(n);let i=Me(n,hg);if(i.isInitialized()){let a=i.getOptions();if(rn(a,e))return i.getImmediate();throw et.create("already-initialized")}i.initialize({options:e});let o=i.getImmediate();return e.initialFetchResponse&&(o._initializePromise=Promise.all([o._storage.setLastSuccessfulFetchResponse(e.initialFetchResponse),o._storage.setActiveConfigEtag(((t=e.initialFetchResponse)===null||t===void 0?void 0:t.eTag)||""),o._storageCache.setLastSuccessfulFetchTimestampMillis(Date.now()),o._storageCache.setLastFetchStatus("success"),o._storageCache.setActiveConfig(((r=e.initialFetchResponse)===null||r===void 0?void 0:r.config)||{})]).then(),o._isInitializationComplete=!0),o}function fg(n){let e=ye(n);return e._initializePromise||(e._initializePromise=e._storageCache.loadFromStorage().then(()=>{e._isInitializationComplete=!0})),e._initializePromise}var wc=class{constructor(e,t,r,i){this.client=e,this.storage=t,this.storageCache=r,this.logger=i}isCachedDataFresh(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;let r=Date.now()-t,i=r<=e;return this.logger.debug(`Config fetch cache check. Cache age millis: ${r}. Cache max age millis (minimumFetchIntervalMillis setting): ${e}. Is cache hit: ${i}.`),i}fetch(e){return x(this,null,function*(){let[t,r]=yield Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()]);if(r&&this.isCachedDataFresh(e.cacheMaxAgeMillis,t))return r;e.eTag=r&&r.eTag;let i=yield this.client.fetch(e),o=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return i.status===200&&o.push(this.storage.setLastSuccessfulFetchResponse(i)),yield Promise.all(o),i})}};function Eb(n=navigator){return n.languages&&n.languages[0]||n.language}var Ec=class{constructor(e,t,r,i,o,a){this.firebaseInstallations=e,this.sdkVersion=t,this.namespace=r,this.projectId=i,this.apiKey=o,this.appId=a}fetch(e){return x(this,null,function*(){let[t,r]=yield Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()]),o=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${this.projectId}/namespaces/${this.namespace}:fetch?key=${this.apiKey}`,a={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},l={sdk_version:this.sdkVersion,app_instance_id:t,app_instance_id_token:r,app_id:this.appId,language_code:Eb(),custom_signals:e.customSignals},h={method:"POST",headers:a,body:JSON.stringify(l)},d=fetch(o,h),m=new Promise((P,U)=>{e.signal.addEventListener(()=>{let $=new Error("The operation was aborted.");$.name="AbortError",U($)})}),g;try{yield Promise.race([d,m]),g=yield d}catch(P){let U="fetch-client-network";throw P?.name==="AbortError"&&(U="fetch-timeout"),et.create(U,{originalErrorMessage:P?.message})}let T=g.status,C=g.headers.get("ETag")||void 0,A,R;if(g.status===200){let P;try{P=yield g.json()}catch(U){throw et.create("fetch-client-parse",{originalErrorMessage:U?.message})}A=P.entries,R=P.state}if(R==="INSTANCE_STATE_UNSPECIFIED"?T=500:R==="NO_CHANGE"?T=304:(R==="NO_TEMPLATE"||R==="EMPTY_CONFIG")&&(A={}),T!==304&&T!==200)throw et.create("fetch-status",{httpStatus:T});return{status:T,eTag:C,config:A}})}};function Tb(n,e){return new Promise((t,r)=>{let i=Math.max(e-Date.now(),0),o=setTimeout(t,i);n.addEventListener(()=>{clearTimeout(o),r(et.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function Ib(n){if(!(n instanceof Et)||!n.customData)return!1;let e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}var Tc=class{constructor(e,t){this.client=e,this.storage=t}fetch(e){return x(this,null,function*(){let t=(yield this.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return this.attemptFetch(e,t)})}attemptFetch(i,o){return x(this,arguments,function*(e,{throttleEndTimeMillis:t,backoffCount:r}){yield Tb(e.signal,t);try{let a=yield this.client.fetch(e);return yield this.storage.deleteThrottleMetadata(),a}catch(a){if(!Ib(a))throw a;let l={throttleEndTimeMillis:Date.now()+jr(r),backoffCount:r+1};return yield this.storage.setThrottleMetadata(l),this.attemptFetch(e,l)}})}};var bb=60*1e3,Sb=12*60*60*1e3,Ic=class{get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}constructor(e,t,r,i,o){this.app=e,this._client=t,this._storageCache=r,this._storage=i,this._logger=o,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:bb,minimumFetchIntervalMillis:Sb},this.defaultConfig={}}};function js(n,e){let t=n.target.error||void 0;return et.create(e,{originalErrorMessage:t&&t?.message})}var fn="app_namespace_store",Ab="firebase_remote_config",Cb=1;function Rb(){return new Promise((n,e)=>{try{let t=indexedDB.open(Ab,Cb);t.onerror=r=>{e(js(r,"storage-open"))},t.onsuccess=r=>{n(r.target.result)},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(fn,{keyPath:"compositeKey"})}}}catch(t){e(et.create("storage-open",{originalErrorMessage:t?.message}))}})}var zs=class{getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(e){return this.set("last_fetch_status",e)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(e){return this.set("last_successful_fetch_timestamp_millis",e)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(e){return this.set("last_successful_fetch_response",e)}getActiveConfig(){return this.get("active_config")}setActiveConfig(e){return this.set("active_config",e)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(e){return this.set("active_config_etag",e)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(e){return this.set("throttle_metadata",e)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}getCustomSignals(){return this.get("custom_signals")}},bc=class extends zs{constructor(e,t,r,i=Rb()){super(),this.appId=e,this.appName=t,this.namespace=r,this.openDbPromise=i}setCustomSignals(e){return x(this,null,function*(){let r=(yield this.openDbPromise).transaction([fn],"readwrite"),i=yield this.getWithTransaction("custom_signals",r),o=pg(e,i||{});return yield this.setWithTransaction("custom_signals",o,r),o})}getWithTransaction(e,t){return x(this,null,function*(){return new Promise((r,i)=>{let o=t.objectStore(fn),a=this.createCompositeKey(e);try{let l=o.get(a);l.onerror=h=>{i(js(h,"storage-get"))},l.onsuccess=h=>{let d=h.target.result;r(d?d.value:void 0)}}catch(l){i(et.create("storage-get",{originalErrorMessage:l?.message}))}})})}setWithTransaction(e,t,r){return x(this,null,function*(){return new Promise((i,o)=>{let a=r.objectStore(fn),l=this.createCompositeKey(e);try{let h=a.put({compositeKey:l,value:t});h.onerror=d=>{o(js(d,"storage-set"))},h.onsuccess=()=>{i()}}catch(h){o(et.create("storage-set",{originalErrorMessage:h?.message}))}})})}get(e){return x(this,null,function*(){let r=(yield this.openDbPromise).transaction([fn],"readonly");return this.getWithTransaction(e,r)})}set(e,t){return x(this,null,function*(){let i=(yield this.openDbPromise).transaction([fn],"readwrite");return this.setWithTransaction(e,t,i)})}delete(e){return x(this,null,function*(){let t=yield this.openDbPromise;return new Promise((r,i)=>{let a=t.transaction([fn],"readwrite").objectStore(fn),l=this.createCompositeKey(e);try{let h=a.delete(l);h.onerror=d=>{i(js(d,"storage-delete"))},h.onsuccess=()=>{r()}}catch(h){i(et.create("storage-delete",{originalErrorMessage:h?.message}))}})})}createCompositeKey(e){return[this.appId,this.appName,this.namespace,e].join()}},Sc=class extends zs{constructor(){super(...arguments),this.storage={}}get(e){return x(this,null,function*(){return Promise.resolve(this.storage[e])})}set(e,t){return x(this,null,function*(){return this.storage[e]=t,Promise.resolve(void 0)})}delete(e){return x(this,null,function*(){return this.storage[e]=void 0,Promise.resolve()})}setCustomSignals(e){return x(this,null,function*(){let t=this.storage.custom_signals||{};return this.storage.custom_signals=pg(e,t),Promise.resolve(this.storage.custom_signals)})}};function pg(n,e){let t=Object.assign(Object.assign({},e),n),r=Object.fromEntries(Object.entries(t).filter(([i,o])=>o!==null).map(([i,o])=>typeof o=="number"?[i,o.toString()]:[i,o]));if(Object.keys(r).length>ug)throw et.create("custom-signal-max-allowed-signals",{maxSignals:ug});return r}var Ac=class{constructor(e){this.storage=e}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}getCustomSignals(){return this.customSignals}loadFromStorage(){return x(this,null,function*(){let e=this.storage.getLastFetchStatus(),t=this.storage.getLastSuccessfulFetchTimestampMillis(),r=this.storage.getActiveConfig(),i=this.storage.getCustomSignals(),o=yield e;o&&(this.lastFetchStatus=o);let a=yield t;a&&(this.lastSuccessfulFetchTimestampMillis=a);let l=yield r;l&&(this.activeConfig=l);let h=yield i;h&&(this.customSignals=h)})}setLastFetchStatus(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}setLastSuccessfulFetchTimestampMillis(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}setActiveConfig(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}setCustomSignals(e){return x(this,null,function*(){this.customSignals=yield this.storage.setCustomSignals(e)})}};function Pb(){Ae(new Se(hg,n,"PUBLIC").setMultipleInstances(!0)),B(vc,cg),B(vc,cg,"esm2017");function n(e,{options:t}){let r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate(),{projectId:o,apiKey:a,appId:l}=r.options;if(!o)throw et.create("registration-project-id");if(!a)throw et.create("registration-api-key");if(!l)throw et.create("registration-app-id");let h=t?.templateId||"firebase",d=nn()?new bc(l,r.name,h):new Sc,m=new Ac(d),g=new It(vc);g.logLevel=sn.ERROR;let T=new Ec(i,on,h,o,a,l),C=new Tc(T,d),A=new wc(C,d,m,g),R=new Ic(r,A,m,d,g);return fg(R),R}}Pb();var bi=class{constructor(e){return e}},mg="remote-config",Cc=class{constructor(){return Re(mg)}};var Rc=new we("angularfire2.remote-config-instances");function Nb(n,e,t){if(Wn(t))return null;let r=Ce(mg,n,e);return r&&new bi(r)}function kb(n){return(e,t,r)=>{if(Wn(r))return null;let i=e.runOutsideAngular(()=>n(t));return new bi(i)}}var Db={provide:Cc,deps:[[new K,Rc]]},xb={provide:bi,useFactory:Nb,deps:[[new K,Rc],Ne,lt]};function gg(n,...e){return B("angularfire",ve.full,"rc"),Ee([xb,Db,{provide:Rc,useFactory:kb(n),multi:!0,deps:[ce,me,lt,Pe,ke,...e]}])}var _g=_e(dg,!0);var yg="@firebase/vertexai",vg="1.2.0";var wg="vertexAI",Eg="us-central1";var yN=180*1e3;var Pc=class{constructor(e,t,r,i){var o;this.app=e,this.options=i;let a=r?.getImmediate({optional:!0}),l=t?.getImmediate({optional:!0});this.auth=l||null,this.appCheck=a||null,this.location=((o=this.options)===null||o===void 0?void 0:o.location)||Eg}_delete(){return Promise.resolve()}};var vN=new It("@firebase/vertexai");var Nc=function(n){return n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n}(Nc||{});var wN=[Nc.RECITATION,Nc.SAFETY];function Tg(n=$e(),e){return n=ye(n),Me(n,wg).getImmediate({identifier:e?.location||Eg})}function Ob(){Ae(new Se(wg,(n,{instanceIdentifier:e})=>{let t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new Pc(t,r,i,{location:e})},"PUBLIC").setMultipleInstances(!0)),B(yg,vg),B(yg,vg,"esm2017")}Ob();var Si=class{constructor(e){return e}},Ig="vertexai",kc=class{constructor(){return Re(Ig)}};var Dc=new we("angularfire2.vertexai-instances");function Mb(n,e){let t=Ce(Ig,n,e);return t&&new Si(t)}function Fb(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Si(r)}}var Lb={provide:kc,deps:[[new K,Dc]]},Vb={provide:Si,useFactory:Mb,deps:[[new K,Dc],Ne]};function bg(n,...e){return B("angularfire",ve.full,"vertexai"),Ee([Vb,Lb,{provide:Dc,useFactory:Fb(n),multi:!0,deps:[ce,me,Pe,ke,[new K,bt],...e]}])}var Sg=_e(Tg,!0);var Ub={projectId:"graduation-project-704b9",appId:"1:159614579205:web:c0dfd56cf057d7635ce26c",storageBucket:"graduation-project-704b9.appspot.com",apiKey:"AIzaSyCJhh6RhbGA52js5L1blEEU0EF_pTy1-JU",authDomain:"graduation-project-704b9.firebaseapp.com",messagingSenderId:"159614579205",measurementId:"G-K9DF60BE90"},Ag={providers:[Xu({eventCoalescing:!0}),uh(Gh),wd(),Eh(()=>Ih(Ub)),Rh(()=>Nh()),Bd(()=>Ld()),Nf(()=>kf()),Em(()=>Tm()),Pm(()=>Nm()),Gm(()=>Km()),Hm(()=>Qm()),ag(()=>lg()),gg(()=>_g()),bg(()=>Sg()),Sh(()=>{let n=new bh("your-site-key");return Ah(Th(),{provider:n,isTokenAutoRefreshEnabled:!0})}),Ud,_a,eh(th())]};rh(Yi,Ag).catch(n=>console.error(n));
