import{a as ph}from"./chunk-ZT4VD254.js";import{a as fh}from"./chunk-66COIVHF.js";import{a as dh}from"./chunk-L7OXOPEK.js";import{a as fe,b as we,c as Ee,d as Te,e as he,f as Ie,g as Se,h as nh,i as sh,j as rh,k as ih,l as yt,m as oh,n as ah,o as lh,p as Qt,q as ch,r as uh,s as hh,t as Or}from"./chunk-P5PUGBH6.js";import{$ as Fe,A as Yu,B as Xu,C as gt,D as hn,E as mo,F as ks,G as Kt,H as Ju,K as Zu,M as eh,N as th,O as Ds,P as xs,Q as de,R as ye,S as Wt,T as _t,U as go,V as xr,W as ve,X as Re,Y as Pt,Z as Ht,a as k,b as Un,ba as V,c as Ku,d as Wu,f as Hu,i as zt,k as ho,l as Bn,n as fo,p as po,q as Qu,s as pt,t as Gt,u as qn,v as Ns,w as mt,x as $n,y as Dr,z as _e}from"./chunk-7E5E4JX3.js";import{a as Fu,b as Vu,c as Lu,d as Uu,e as Bu,f as qu,g as Vn,h as $u,i as ju,j as zu}from"./chunk-HF5DDPS3.js";import"./chunk-K65C4JJG.js";import{i as j,j as ft,m as Gu,n as co,r as Ln,s as uo,t as kr}from"./chunk-YOCB2I3H.js";import{$ as Ce,A as ro,Aa as nt,Ba as oo,Ea as Au,H as Eu,K as Tu,Ka as an,Lb as ao,Mb as lo,N as Iu,Na as Cu,Oa as Ru,Q as Su,Qa as Pu,R as io,Sb as ku,U as H,Va as Nu,W as Rt,Z as me,Za as Nr,aa as bu,ba as $,ca as ge,db as ln,dc as Du,ia as Dn,ib as pe,ja as xn,jb as Me,jc as xu,kb as cn,lb as Cs,mb as Rs,mc as Ou,na as ue,o as As,ob as Ps,oc as Mu,pb as On,qb as jt,qc as Mn,rc as Fn,s as so,sa as re,u as wu,yb as un}from"./chunk-KARPGTJI.js";import{a as Ct,b as no,c as vu,e as D}from"./chunk-ACKELEN3.js";function Ag(n,e){if(n&1){let t=Ps();Cs(0),pe(1,"sign-up",23),On("visibleChange",function(r){Dn(t);let o=jt();return xn(o.visibleSignUp=r)}),Me(),Rs()}if(n&2){let t=jt();an(),ln("visible",t.visibleSignUp)}}function Cg(n,e){if(n&1){let t=Ps();Cs(0),pe(1,"login",23),On("visibleChange",function(r){Dn(t);let o=jt();return xn(o.visibleLogin=r)}),Me(),Rs()}if(n&2){let t=jt();an(),ln("visible",t.visibleLogin)}}function Rg(n,e){if(n&1){let t=Ps();Cs(0),pe(1,"li",10)(2,"button",24),On("click",function(){Dn(t);let r=jt();return xn(r.visibleSignUp=!0)}),pe(3,"a",25),un(4,"Sign Up"),Me()()(),pe(5,"li",10)(6,"button",26),On("click",function(){Dn(t);let r=jt();return xn(r.visibleLogin=!0)}),pe(7,"a",25),un(8,"Login"),Me()()(),Rs()}}function Pg(n,e){if(n&1){let t=Ps();Cs(0),pe(1,"li",10)(2,"button",26),On("click",function(){Dn(t);let r=jt();return xn(r.logout())}),pe(3,"a",25),un(4,"Log Out"),Me()()(),Rs()}}var Mr=class n{constructor(e){this.router=e;this.user$=this.authService.user$}title="career-path-project";visibleSignUp=!1;visibleLogin=!1;authService=bu(Or);user$;logout(){this.authService.logout().subscribe(()=>{this.router.navigate(["/home"])})}static \u0275fac=function(t){return new(t||n)(Pu(Vn))};static \u0275cmp=Nu({type:n,selectors:[["app-root"]],decls:34,vars:8,consts:[[1,"content-wrapper"],[4,"ngIf"],[1,"nav","navbar","navbar-expand-sm","navbar-light","bg-light"],[1,"container"],["href","#",1,"navbar-brand"],["width","40","src","assets/images/career-goals.png","alt","Career Path"],["type","button","data-bs-toggle","collapse","data-bs-target","#collapsibleNavId","aria-controls","collapsibleNavId","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler","d-lg-none"],[1,"navbar-toggler-icon"],["id","collapsibleNavId",1,"collapse","navbar-collapse"],[1,"navbar-nav","ms-auto","mt-2","mt-lg-0","d-flex","align-items-center"],[1,"nav-item"],["routerLink","/home","routerLinkActive","active",1,"nav-link","active","home"],[1,"parent","container-fluid"],[1,"footer"],[1,"footer__container"],[1,"footer__social"],["href","#","aria-label","Facebook"],["width","30","src","assets/images/icons8-facebook.svg","alt","Facebook"],["href","#","aria-label","Twitter"],["width","30","src","assets/images/icons8-instagram.svg","alt","Instagram"],["href","#","aria-label","LinkedIn"],["width","30","src","assets/images/icons8-linkedin.svg","alt","LinkedIn"],[1,"footer__bottom"],[3,"visibleChange","visible"],[1,"btn","sign","button",3,"click"],[1,"nav-link"],[1,"btn","login","button",3,"click"]],template:function(t,s){t&1&&(pe(0,"div",0),Nr(1,Ag,2,1,"ng-container",1)(2,Cg,2,1,"ng-container",1),pe(3,"nav",2)(4,"div",3)(5,"a",4),cn(6,"img",5),Me(),pe(7,"button",6),cn(8,"span",7),Me(),pe(9,"div",8)(10,"ul",9)(11,"li",10)(12,"a",11),un(13,"Home"),Me()(),Nr(14,Rg,9,0,"ng-container",1),ao(15,"async"),Nr(16,Pg,5,0,"ng-container",1),ao(17,"async"),Me()()()()(),pe(18,"div",12),cn(19,"router-outlet"),Me(),pe(20,"footer",13)(21,"div",14)(22,"div",15)(23,"h4"),un(24,"Follow Us"),Me(),pe(25,"a",16),cn(26,"img",17),Me(),pe(27,"a",18),cn(28,"img",19),Me(),pe(29,"a",20),cn(30,"img",21),Me()()(),pe(31,"div",22)(32,"p"),un(33,"\xA9 2025 Third Eye. All rights reserved."),Me()()()),t&2&&(an(),ln("ngIf",s.visibleSignUp),an(),ln("ngIf",s.visibleLogin),an(12),ln("ngIf",!lo(15,4,s.user$)),an(2),ln("ngIf",lo(17,6,s.user$)))},dependencies:[Bu,$u,ju,dh,fh,Mu,xu,Ou],styles:[".nav[_ngcontent-%COMP%]{position:sticky;top:0;right:0;width:100%;background:#81818147;display:flex;justify-content:center;box-shadow:0 2px 5px #bec9d4;z-index:1000}.nav__link[_ngcontent-%COMP%]{text-decoration:none;color:#240404;padding:.625rem 1.25rem;margin:0 .625rem;border-radius:.3125rem;transition:all .3s ease}.nav__link[_ngcontent-%COMP%]:hover{background:#fff3;transform:scale(1.05)}.button[_ngcontent-%COMP%]{padding:1px;margin:2px;border-radius:11px;box-shadow:0 6px 6px #00000030;width:100px;transition:background-color .3s ease}.sign[_ngcontent-%COMP%]{background-color:#3c8fffe6}.sign[_ngcontent-%COMP%]:hover{background-color:#fff;border:1px solid #3c8fffe6;transition:.5s}.sign[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff}.sign[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#3c8fffe6}.login[_ngcontent-%COMP%]{border:1px solid #3c8fffe6}.login[_ngcontent-%COMP%]:hover{background-color:#3c8fffe6;transition:.5s}.login[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#3c8fffe6}.login[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#fff}.home[_ngcontent-%COMP%]{background-color:#eee;border-radius:10px;margin-right:10px;box-shadow:0 6px 6px #00000030;transition:.5s}.home[_ngcontent-%COMP%]:hover{background-color:#aaa;transform:scale(1.08)}.footer[_ngcontent-%COMP%]{background:#0b4c8a;color:#fff;padding:2.5rem 1rem}.footer__container[_ngcontent-%COMP%]{display:flex;justify-content:space-around;flex-wrap:wrap;max-width:68.75rem;margin:0 auto;text-align:center}.footer__about[_ngcontent-%COMP%], .footer__links[_ngcontent-%COMP%], .footer__social[_ngcontent-%COMP%]{flex:1;min-width:15rem;margin-bottom:1.5rem}.footer__title[_ngcontent-%COMP%]{font-size:1.5rem;margin-bottom:.5rem}.footer__description[_ngcontent-%COMP%]{font-size:1rem;color:#ddd}.footer__links[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .footer__social[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin-bottom:.75rem}.footer__links[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;display:flex;justify-content:center;align-items:center;gap:30px}.footer__links[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:.5rem}.footer__links[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;color:#ddd;transition:color .3s}.footer__links[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#ffdd57}.footer__social[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-size:1.5rem;color:#fff;margin:0 .5rem;transition:color .3s}.footer__social[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#ffdd57}.footer__bottom[_ngcontent-%COMP%]{text-align:center;padding-top:1.5rem;font-size:.9rem;border-top:1px solid #ddd}"]})};var jn=class n{constructor(e,t){this.authService=e;this.router=t}canActivate(){return this.authService.isLoggedIn()?!0:(this.router.navigate(["/home"]),!1)}static \u0275fac=function(t){return new(t||n)(Ce(Or),Ce(Vn))};static \u0275prov=Rt({token:n,factory:n.\u0275fac,providedIn:"root"})};var gh=[{path:"",loadComponent:()=>import("./chunk-IYLSSI3M.js").then(n=>n.HomeComponent)},{path:"home",loadComponent:()=>import("./chunk-IYLSSI3M.js").then(n=>n.HomeComponent)},{path:"login",loadComponent:()=>import("./chunk-UNI4JIBJ.js").then(n=>n.LoginComponent)},{path:"sign-up",loadComponent:()=>import("./chunk-DNFUQ3AG.js").then(n=>n.SignUpComponent)},{path:"select-university",loadComponent:()=>import("./chunk-SJ2SBNBB.js").then(n=>n.SelcetUniversityComponent),canActivate:[jn]},{path:"features",loadComponent:()=>import("./chunk-4IJKY2R2.js").then(n=>n.FeaturesComponent)},{path:"career-path",loadComponent:()=>import("./chunk-ORGLPH4U.js").then(n=>n.CarerComponent),canActivate:[jn]},{path:"roadmap",loadComponent:()=>import("./chunk-42HPUUS2.js").then(n=>n.RoadmapComponent),canActivate:[jn]}];function _h(n){return new H(3e3,!1)}function Ng(){return new H(3100,!1)}function kg(){return new H(3101,!1)}function Dg(n){return new H(3001,!1)}function xg(n){return new H(3003,!1)}function Og(n){return new H(3004,!1)}function Mg(n,e){return new H(3005,!1)}function Fg(){return new H(3006,!1)}function Vg(){return new H(3007,!1)}function Lg(n,e){return new H(3008,!1)}function Ug(n){return new H(3002,!1)}function Bg(n,e,t,s,r){return new H(3010,!1)}function qg(){return new H(3011,!1)}function $g(){return new H(3012,!1)}function jg(){return new H(3200,!1)}function zg(){return new H(3202,!1)}function Gg(){return new H(3013,!1)}function Kg(n){return new H(3014,!1)}function Wg(n){return new H(3015,!1)}function Hg(n){return new H(3016,!1)}function Qg(n,e){return new H(3404,!1)}function Yg(n){return new H(3502,!1)}function Xg(n){return new H(3503,!1)}function Jg(){return new H(3300,!1)}function Zg(n){return new H(3504,!1)}function e_(n){return new H(3301,!1)}function t_(n,e){return new H(3302,!1)}function n_(n){return new H(3303,!1)}function s_(n,e){return new H(3400,!1)}function r_(n){return new H(3401,!1)}function i_(n){return new H(3402,!1)}function o_(n,e){return new H(3505,!1)}function Yt(n){switch(n.length){case 0:return new Ln;case 1:return n[0];default:return new uo(n)}}function kh(n,e,t=new Map,s=new Map){let r=[],o=[],a=-1,l=null;if(e.forEach(h=>{let d=h.get("offset"),m=d==a,g=m&&l||new Map;h.forEach((T,C)=>{let A=C,R=T;if(C!=="offset")switch(A=n.normalizePropertyName(A,r),R){case kr:R=t.get(C);break;case ft:R=s.get(C);break;default:R=n.normalizeStyleValue(C,A,R,r);break}g.set(A,R)}),m||o.push(g),l=g,a=d}),r.length)throw Yg(r);return o}function Lo(n,e,t,s){switch(e){case"start":n.onStart(()=>s(t&&_o(t,"start",n)));break;case"done":n.onDone(()=>s(t&&_o(t,"done",n)));break;case"destroy":n.onDestroy(()=>s(t&&_o(t,"destroy",n)));break}}function _o(n,e,t){let s=t.totalTime,r=!!t.disabled,o=Uo(n.element,n.triggerName,n.fromState,n.toState,e||n.phaseName,s??n.totalTime,r),a=n._data;return a!=null&&(o._data=a),o}function Uo(n,e,t,s,r="",o=0,a){return{element:n,triggerName:e,fromState:t,toState:s,phaseName:r,totalTime:o,disabled:!!a}}function Xe(n,e,t){let s=n.get(e);return s||n.set(e,s=t),s}function yh(n){let e=n.indexOf(":"),t=n.substring(1,e),s=n.slice(e+1);return[t,s]}var a_=typeof document>"u"?null:document.documentElement;function Bo(n){let e=n.parentNode||n.host||null;return e===a_?null:e}function l_(n){return n.substring(1,6)=="ebkit"}var dn=null,vh=!1;function c_(n){dn||(dn=u_()||{},vh=dn.style?"WebkitAppearance"in dn.style:!1);let e=!0;return dn.style&&!l_(n)&&(e=n in dn.style,!e&&vh&&(e="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in dn.style)),e}function u_(){return typeof document<"u"?document.body:null}function Dh(n,e){for(;e;){if(e===n)return!0;e=Bo(e)}return!1}function xh(n,e,t){if(t)return Array.from(n.querySelectorAll(e));let s=n.querySelector(e);return s?[s]:[]}var qo=(()=>{class n{validateStyleProperty(t){return c_(t)}containsElement(t,s){return Dh(t,s)}getParentElement(t){return Bo(t)}query(t,s,r){return xh(t,s,r)}computeStyle(t,s,r){return r||""}animate(t,s,r,o,a,l=[],h){return new Ln(r,o)}static \u0275fac=function(s){return new(s||n)};static \u0275prov=Rt({token:n,factory:n.\u0275fac})}return n})(),mn=class{static NOOP=new qo},gn=class{};var h_=1e3,Oh="{{",d_="}}",Mh="ng-enter",Io="ng-leave",Vr="ng-trigger",$r=".ng-trigger",wh="ng-animating",So=".ng-animating";function Nt(n){if(typeof n=="number")return n;let e=n.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:bo(parseFloat(e[1]),e[2])}function bo(n,e){switch(e){case"s":return n*h_;default:return n}}function jr(n,e,t){return n.hasOwnProperty("duration")?n:f_(n,e,t)}function f_(n,e,t){let s=/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i,r,o=0,a="";if(typeof n=="string"){let l=n.match(s);if(l===null)return e.push(_h(n)),{duration:0,delay:0,easing:""};r=bo(parseFloat(l[1]),l[2]);let h=l[3];h!=null&&(o=bo(parseFloat(h),l[4]));let d=l[5];d&&(a=d)}else r=n;if(!t){let l=!1,h=e.length;r<0&&(e.push(Ng()),l=!0),o<0&&(e.push(kg()),l=!0),l&&e.splice(h,0,_h(n))}return{duration:r,delay:o,easing:a}}function p_(n){return n.length?n[0]instanceof Map?n:n.map(e=>new Map(Object.entries(e))):[]}function vt(n,e,t){e.forEach((s,r)=>{let o=$o(r);t&&!t.has(r)&&t.set(r,n.style[o]),n.style[o]=s})}function pn(n,e){e.forEach((t,s)=>{let r=$o(s);n.style[r]=""})}function Os(n){return Array.isArray(n)?n.length==1?n[0]:Gu(n):n}function m_(n,e,t){let s=e.params||{},r=Fh(n);r.length&&r.forEach(o=>{s.hasOwnProperty(o)||t.push(Dg(o))})}var Ao=new RegExp(`${Oh}\\s*(.+?)\\s*${d_}`,"g");function Fh(n){let e=[];if(typeof n=="string"){let t;for(;t=Ao.exec(n);)e.push(t[1]);Ao.lastIndex=0}return e}function Fs(n,e,t){let s=`${n}`,r=s.replace(Ao,(o,a)=>{let l=e[a];return l==null&&(t.push(xg(a)),l=""),l.toString()});return r==s?n:r}var g_=/-+([a-z0-9])/g;function $o(n){return n.replace(g_,(...e)=>e[1].toUpperCase())}function __(n,e){return n===0||e===0}function y_(n,e,t){if(t.size&&e.length){let s=e[0],r=[];if(t.forEach((o,a)=>{s.has(a)||r.push(a),s.set(a,o)}),r.length)for(let o=1;o<e.length;o++){let a=e[o];r.forEach(l=>a.set(l,jo(n,l)))}}return e}function Ye(n,e,t){switch(e.type){case j.Trigger:return n.visitTrigger(e,t);case j.State:return n.visitState(e,t);case j.Transition:return n.visitTransition(e,t);case j.Sequence:return n.visitSequence(e,t);case j.Group:return n.visitGroup(e,t);case j.Animate:return n.visitAnimate(e,t);case j.Keyframes:return n.visitKeyframes(e,t);case j.Style:return n.visitStyle(e,t);case j.Reference:return n.visitReference(e,t);case j.AnimateChild:return n.visitAnimateChild(e,t);case j.AnimateRef:return n.visitAnimateRef(e,t);case j.Query:return n.visitQuery(e,t);case j.Stagger:return n.visitStagger(e,t);default:throw Og(e.type)}}function jo(n,e){return window.getComputedStyle(n)[e]}var v_=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]),zr=class extends gn{normalizePropertyName(e,t){return $o(e)}normalizeStyleValue(e,t,s,r){let o="",a=s.toString().trim();if(v_.has(t)&&s!==0&&s!=="0")if(typeof s=="number")o="px";else{let l=s.match(/^[+-]?[\d\.]+([a-z]*)$/);l&&l[1].length==0&&r.push(Mg(e,s))}return a+o}};var Gr="*";function w_(n,e){let t=[];return typeof n=="string"?n.split(/\s*,\s*/).forEach(s=>E_(s,t,e)):t.push(n),t}function E_(n,e,t){if(n[0]==":"){let h=T_(n,t);if(typeof h=="function"){e.push(h);return}n=h}let s=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(s==null||s.length<4)return t.push(Wg(n)),e;let r=s[1],o=s[2],a=s[3];e.push(Eh(r,a));let l=r==Gr&&a==Gr;o[0]=="<"&&!l&&e.push(Eh(a,r))}function T_(n,e){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,s)=>parseFloat(s)>parseFloat(t);case":decrement":return(t,s)=>parseFloat(s)<parseFloat(t);default:return e.push(Hg(n)),"* => *"}}var Lr=new Set(["true","1"]),Ur=new Set(["false","0"]);function Eh(n,e){let t=Lr.has(n)||Ur.has(n),s=Lr.has(e)||Ur.has(e);return(r,o)=>{let a=n==Gr||n==r,l=e==Gr||e==o;return!a&&t&&typeof r=="boolean"&&(a=r?Lr.has(n):Ur.has(n)),!l&&s&&typeof o=="boolean"&&(l=o?Lr.has(e):Ur.has(e)),a&&l}}var Vh=":self",I_=new RegExp(`s*${Vh}s*,?`,"g");function Lh(n,e,t,s){return new Co(n).build(e,t,s)}var Th="",Co=class{_driver;constructor(e){this._driver=e}build(e,t,s){let r=new Ro(t);return this._resetContextStyleTimingState(r),Ye(this,Os(e),r)}_resetContextStyleTimingState(e){e.currentQuerySelector=Th,e.collectedStyles=new Map,e.collectedStyles.set(Th,new Map),e.currentTime=0}visitTrigger(e,t){let s=t.queryCount=0,r=t.depCount=0,o=[],a=[];return e.name.charAt(0)=="@"&&t.errors.push(Fg()),e.definitions.forEach(l=>{if(this._resetContextStyleTimingState(t),l.type==j.State){let h=l,d=h.name;d.toString().split(/\s*,\s*/).forEach(m=>{h.name=m,o.push(this.visitState(h,t))}),h.name=d}else if(l.type==j.Transition){let h=this.visitTransition(l,t);s+=h.queryCount,r+=h.depCount,a.push(h)}else t.errors.push(Vg())}),{type:j.Trigger,name:e.name,states:o,transitions:a,queryCount:s,depCount:r,options:null}}visitState(e,t){let s=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(s.containsDynamicStyles){let o=new Set,a=r||{};s.styles.forEach(l=>{l instanceof Map&&l.forEach(h=>{Fh(h).forEach(d=>{a.hasOwnProperty(d)||o.add(d)})})}),o.size&&t.errors.push(Lg(e.name,[...o.values()]))}return{type:j.State,name:e.name,style:s,options:r?{params:r}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;let s=Ye(this,Os(e.animation),t),r=w_(e.expr,t.errors);return{type:j.Transition,matchers:r,animation:s,queryCount:t.queryCount,depCount:t.depCount,options:fn(e.options)}}visitSequence(e,t){return{type:j.Sequence,steps:e.steps.map(s=>Ye(this,s,t)),options:fn(e.options)}}visitGroup(e,t){let s=t.currentTime,r=0,o=e.steps.map(a=>{t.currentTime=s;let l=Ye(this,a,t);return r=Math.max(r,t.currentTime),l});return t.currentTime=r,{type:j.Group,steps:o,options:fn(e.options)}}visitAnimate(e,t){let s=C_(e.timings,t.errors);t.currentAnimateTimings=s;let r,o=e.styles?e.styles:co({});if(o.type==j.Keyframes)r=this.visitKeyframes(o,t);else{let a=e.styles,l=!1;if(!a){l=!0;let d={};s.easing&&(d.easing=s.easing),a=co(d)}t.currentTime+=s.duration+s.delay;let h=this.visitStyle(a,t);h.isEmptyStep=l,r=h}return t.currentAnimateTimings=null,{type:j.Animate,timings:s,style:r,options:null}}visitStyle(e,t){let s=this._makeStyleAst(e,t);return this._validateStyleAst(s,t),s}_makeStyleAst(e,t){let s=[],r=Array.isArray(e.styles)?e.styles:[e.styles];for(let l of r)typeof l=="string"?l===ft?s.push(l):t.errors.push(Ug(l)):s.push(new Map(Object.entries(l)));let o=!1,a=null;return s.forEach(l=>{if(l instanceof Map&&(l.has("easing")&&(a=l.get("easing"),l.delete("easing")),!o)){for(let h of l.values())if(h.toString().indexOf(Oh)>=0){o=!0;break}}}),{type:j.Style,styles:s,easing:a,offset:e.offset,containsDynamicStyles:o,options:null}}_validateStyleAst(e,t){let s=t.currentAnimateTimings,r=t.currentTime,o=t.currentTime;s&&o>0&&(o-=s.duration+s.delay),e.styles.forEach(a=>{typeof a!="string"&&a.forEach((l,h)=>{let d=t.collectedStyles.get(t.currentQuerySelector),m=d.get(h),g=!0;m&&(o!=r&&o>=m.startTime&&r<=m.endTime&&(t.errors.push(Bg(h,m.startTime,m.endTime,o,r)),g=!1),o=m.startTime),g&&d.set(h,{startTime:o,endTime:r}),t.options&&m_(l,t.options,t.errors)})})}visitKeyframes(e,t){let s={type:j.Keyframes,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(qg()),s;let r=1,o=0,a=[],l=!1,h=!1,d=0,m=e.steps.map(F=>{let U=this._makeStyleAst(F,t),B=U.offset!=null?U.offset:A_(U.styles),L=0;return B!=null&&(o++,L=U.offset=B),h=h||L<0||L>1,l=l||L<d,d=L,a.push(L),U});h&&t.errors.push($g()),l&&t.errors.push(jg());let g=e.steps.length,T=0;o>0&&o<g?t.errors.push(zg()):o==0&&(T=r/(g-1));let C=g-1,A=t.currentTime,R=t.currentAnimateTimings,P=R.duration;return m.forEach((F,U)=>{let B=T>0?U==C?1:T*U:a[U],L=B*P;t.currentTime=A+R.delay+L,R.duration=L,this._validateStyleAst(F,t),F.offset=B,s.styles.push(F)}),s}visitReference(e,t){return{type:j.Reference,animation:Ye(this,Os(e.animation),t),options:fn(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:j.AnimateChild,options:fn(e.options)}}visitAnimateRef(e,t){return{type:j.AnimateRef,animation:this.visitReference(e.animation,t),options:fn(e.options)}}visitQuery(e,t){let s=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;let[o,a]=S_(e.selector);t.currentQuerySelector=s.length?s+" "+o:o,Xe(t.collectedStyles,t.currentQuerySelector,new Map);let l=Ye(this,Os(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=s,{type:j.Query,selector:o,limit:r.limit||0,optional:!!r.optional,includeSelf:a,animation:l,originalSelector:e.selector,options:fn(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(Gg());let s=e.timings==="full"?{duration:0,delay:0,easing:"full"}:jr(e.timings,t.errors,!0);return{type:j.Stagger,animation:Ye(this,Os(e.animation),t),timings:s,options:null}}};function S_(n){let e=!!n.split(/\s*,\s*/).find(t=>t==Vh);return e&&(n=n.replace(I_,"")),n=n.replace(/@\*/g,$r).replace(/@\w+/g,t=>$r+"-"+t.slice(1)).replace(/:animating/g,So),[n,e]}function b_(n){return n?Ct({},n):null}var Ro=class{errors;queryCount=0;depCount=0;currentTransition=null;currentQuery=null;currentQuerySelector=null;currentAnimateTimings=null;currentTime=0;collectedStyles=new Map;options=null;unsupportedCSSPropertiesFound=new Set;constructor(e){this.errors=e}};function A_(n){if(typeof n=="string")return null;let e=null;if(Array.isArray(n))n.forEach(t=>{if(t instanceof Map&&t.has("offset")){let s=t;e=parseFloat(s.get("offset")),s.delete("offset")}});else if(n instanceof Map&&n.has("offset")){let t=n;e=parseFloat(t.get("offset")),t.delete("offset")}return e}function C_(n,e){if(n.hasOwnProperty("duration"))return n;if(typeof n=="number"){let o=jr(n,e).duration;return yo(o,0,"")}let t=n;if(t.split(/\s+/).some(o=>o.charAt(0)=="{"&&o.charAt(1)=="{")){let o=yo(0,0,"");return o.dynamic=!0,o.strValue=t,o}let r=jr(t,e);return yo(r.duration,r.delay,r.easing)}function fn(n){return n?(n=Ct({},n),n.params&&(n.params=b_(n.params))):n={},n}function yo(n,e,t){return{duration:n,delay:e,easing:t}}function zo(n,e,t,s,r,o,a=null,l=!1){return{type:1,element:n,keyframes:e,preStyleProps:t,postStyleProps:s,duration:r,delay:o,totalTime:r+o,easing:a,subTimeline:l}}var Vs=class{_map=new Map;get(e){return this._map.get(e)||[]}append(e,t){let s=this._map.get(e);s||this._map.set(e,s=[]),s.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}},R_=1,P_=":enter",N_=new RegExp(P_,"g"),k_=":leave",D_=new RegExp(k_,"g");function Uh(n,e,t,s,r,o=new Map,a=new Map,l,h,d=[]){return new Po().buildKeyframes(n,e,t,s,r,o,a,l,h,d)}var Po=class{buildKeyframes(e,t,s,r,o,a,l,h,d,m=[]){d=d||new Vs;let g=new No(e,t,d,r,o,m,[]);g.options=h;let T=h.delay?Nt(h.delay):0;g.currentTimeline.delayNextStep(T),g.currentTimeline.setStyles([a],null,g.errors,h),Ye(this,s,g);let C=g.timelines.filter(A=>A.containsAnimation());if(C.length&&l.size){let A;for(let R=C.length-1;R>=0;R--){let P=C[R];if(P.element===t){A=P;break}}A&&!A.allowOnlyTimelineStyles()&&A.setStyles([l],null,g.errors,h)}return C.length?C.map(A=>A.buildKeyframes()):[zo(t,[],[],[],0,T,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){let s=t.subInstructions.get(t.element);if(s){let r=t.createSubContext(e.options),o=t.currentTimeline.currentTime,a=this._visitSubInstructions(s,r,r.options);o!=a&&t.transformIntoNewTimeline(a)}t.previousNode=e}visitAnimateRef(e,t){let s=t.createSubContext(e.options);s.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,s),this.visitReference(e.animation,s),t.transformIntoNewTimeline(s.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,s){for(let r of e){let o=r?.delay;if(o){let a=typeof o=="number"?o:Nt(Fs(o,r?.params??{},t.errors));s.delayNextStep(a)}}}_visitSubInstructions(e,t,s){let o=t.currentTimeline.currentTime,a=s.duration!=null?Nt(s.duration):null,l=s.delay!=null?Nt(s.delay):null;return a!==0&&e.forEach(h=>{let d=t.appendInstructionToTimeline(h,a,l);o=Math.max(o,d.duration+d.delay)}),o}visitReference(e,t){t.updateOptions(e.options,!0),Ye(this,e.animation,t),t.previousNode=e}visitSequence(e,t){let s=t.subContextCount,r=t,o=e.options;if(o&&(o.params||o.delay)&&(r=t.createSubContext(o),r.transformIntoNewTimeline(),o.delay!=null)){r.previousNode.type==j.Style&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=Kr);let a=Nt(o.delay);r.delayNextStep(a)}e.steps.length&&(e.steps.forEach(a=>Ye(this,a,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>s&&r.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){let s=[],r=t.currentTimeline.currentTime,o=e.options&&e.options.delay?Nt(e.options.delay):0;e.steps.forEach(a=>{let l=t.createSubContext(e.options);o&&l.delayNextStep(o),Ye(this,a,l),r=Math.max(r,l.currentTimeline.currentTime),s.push(l.currentTimeline)}),s.forEach(a=>t.currentTimeline.mergeTimelineCollectedStyles(a)),t.transformIntoNewTimeline(r),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){let s=e.strValue,r=t.params?Fs(s,t.params,t.errors):s;return jr(r,t.errors)}else return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){let s=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;s.delay&&(t.incrementTime(s.delay),r.snapshotCurrentStyles());let o=e.style;o.type==j.Keyframes?this.visitKeyframes(o,t):(t.incrementTime(s.duration),this.visitStyle(o,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){let s=t.currentTimeline,r=t.currentAnimateTimings;!r&&s.hasCurrentStyleProperties()&&s.forwardFrame();let o=r&&r.easing||e.easing;e.isEmptyStep?s.applyEmptyStep(o):s.setStyles(e.styles,o,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){let s=t.currentAnimateTimings,r=t.currentTimeline.duration,o=s.duration,l=t.createSubContext().currentTimeline;l.easing=s.easing,e.styles.forEach(h=>{let d=h.offset||0;l.forwardTime(d*o),l.setStyles(h.styles,h.easing,t.errors,t.options),l.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(l),t.transformIntoNewTimeline(r+o),t.previousNode=e}visitQuery(e,t){let s=t.currentTimeline.currentTime,r=e.options||{},o=r.delay?Nt(r.delay):0;o&&(t.previousNode.type===j.Style||s==0&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=Kr);let a=s,l=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=l.length;let h=null;l.forEach((d,m)=>{t.currentQueryIndex=m;let g=t.createSubContext(e.options,d);o&&g.delayNextStep(o),d===t.element&&(h=g.currentTimeline),Ye(this,e.animation,g),g.currentTimeline.applyStylesToKeyframe();let T=g.currentTimeline.currentTime;a=Math.max(a,T)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(a),h&&(t.currentTimeline.mergeTimelineCollectedStyles(h),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){let s=t.parentContext,r=t.currentTimeline,o=e.timings,a=Math.abs(o.duration),l=a*(t.currentQueryTotal-1),h=a*t.currentQueryIndex;switch(o.duration<0?"reverse":o.easing){case"reverse":h=l-h;break;case"full":h=s.currentStaggerTime;break}let m=t.currentTimeline;h&&m.delayNextStep(h);let g=m.currentTime;Ye(this,e.animation,t),t.previousNode=e,s.currentStaggerTime=r.currentTime-g+(r.startTime-s.currentTimeline.startTime)}},Kr={},No=class n{_driver;element;subInstructions;_enterClassName;_leaveClassName;errors;timelines;parentContext=null;currentTimeline;currentAnimateTimings=null;previousNode=Kr;subContextCount=0;options={};currentQueryIndex=0;currentQueryTotal=0;currentStaggerTime=0;constructor(e,t,s,r,o,a,l,h){this._driver=e,this.element=t,this.subInstructions=s,this._enterClassName=r,this._leaveClassName=o,this.errors=a,this.timelines=l,this.currentTimeline=h||new Wr(this._driver,t,0),l.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;let s=e,r=this.options;s.duration!=null&&(r.duration=Nt(s.duration)),s.delay!=null&&(r.delay=Nt(s.delay));let o=s.params;if(o){let a=r.params;a||(a=this.options.params={}),Object.keys(o).forEach(l=>{(!t||!a.hasOwnProperty(l))&&(a[l]=Fs(o[l],a,this.errors))})}}_copyOptions(){let e={};if(this.options){let t=this.options.params;if(t){let s=e.params={};Object.keys(t).forEach(r=>{s[r]=t[r]})}}return e}createSubContext(e=null,t,s){let r=t||this.element,o=new n(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,s||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(e),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}transformIntoNewTimeline(e){return this.previousNode=Kr,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,s){let r={duration:t??e.duration,delay:this.currentTimeline.currentTime+(s??0)+e.delay,easing:""},o=new ko(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(o),r}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,s,r,o,a){let l=[];if(r&&l.push(this.element),e.length>0){e=e.replace(N_,"."+this._enterClassName),e=e.replace(D_,"."+this._leaveClassName);let h=s!=1,d=this._driver.query(this.element,e,h);s!==0&&(d=s<0?d.slice(d.length+s,d.length):d.slice(0,s)),l.push(...d)}return!o&&l.length==0&&a.push(Kg(t)),l}},Wr=class n{_driver;element;startTime;_elementTimelineStylesLookup;duration=0;easing=null;_previousKeyframe=new Map;_currentKeyframe=new Map;_keyframes=new Map;_styleSummary=new Map;_localTimelineStyles=new Map;_globalTimelineStyles;_pendingStyles=new Map;_backFill=new Map;_currentEmptyStepKeyframe=null;constructor(e,t,s,r){this._driver=e,this.element=t,this.startTime=s,this._elementTimelineStylesLookup=r,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){let t=this._keyframes.size===1&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new n(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=R_,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,s]of this._globalTimelineStyles)this._backFill.set(t,s||ft),this._currentKeyframe.set(t,ft);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,s,r){t&&this._previousKeyframe.set("easing",t);let o=r&&r.params||{},a=x_(e,this._globalTimelineStyles);for(let[l,h]of a){let d=Fs(h,o,s);this._pendingStyles.set(l,d),this._localTimelineStyles.has(l)||this._backFill.set(l,this._globalTimelineStyles.get(l)??ft),this._updateStyle(l,d)}}applyStylesToKeyframe(){this._pendingStyles.size!=0&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){let e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,s)=>{let r=this._styleSummary.get(s);(!r||t.time>r.time)&&this._updateStyle(s,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();let e=new Set,t=new Set,s=this._keyframes.size===1&&this.duration===0,r=[];this._keyframes.forEach((l,h)=>{let d=new Map([...this._backFill,...l]);d.forEach((m,g)=>{m===kr?e.add(g):m===ft&&t.add(g)}),s||d.set("offset",h/this.duration),r.push(d)});let o=[...e.values()],a=[...t.values()];if(s){let l=r[0],h=new Map(l);l.set("offset",0),h.set("offset",1),r=[l,h]}return zo(this.element,r,o,a,this.duration,this.startTime,this.easing,!1)}},ko=class extends Wr{keyframes;preStyleProps;postStyleProps;_stretchStartingKeyframe;timings;constructor(e,t,s,r,o,a,l=!1){super(e,t,a.delay),this.keyframes=s,this.preStyleProps=r,this.postStyleProps=o,this._stretchStartingKeyframe=l,this.timings={duration:a.duration,delay:a.delay,easing:a.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:s,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){let o=[],a=s+t,l=t/a,h=new Map(e[0]);h.set("offset",0),o.push(h);let d=new Map(e[0]);d.set("offset",Ih(l)),o.push(d);let m=e.length-1;for(let g=1;g<=m;g++){let T=new Map(e[g]),C=T.get("offset"),A=t+C*s;T.set("offset",Ih(A/a)),o.push(T)}s=a,t=0,r="",e=o}return zo(this.element,e,this.preStyleProps,this.postStyleProps,s,t,r,!0)}};function Ih(n,e=3){let t=Math.pow(10,e-1);return Math.round(n*t)/t}function x_(n,e){let t=new Map,s;return n.forEach(r=>{if(r==="*"){s??=e.keys();for(let o of s)t.set(o,ft)}else for(let[o,a]of r)t.set(o,a)}),t}function Sh(n,e,t,s,r,o,a,l,h,d,m,g,T){return{type:0,element:n,triggerName:e,isRemovalTransition:r,fromState:t,fromStyles:o,toState:s,toStyles:a,timelines:l,queriedElements:h,preStyleProps:d,postStyleProps:m,totalTime:g,errors:T}}var vo={},Hr=class{_triggerName;ast;_stateStyles;constructor(e,t,s){this._triggerName=e,this.ast=t,this._stateStyles=s}match(e,t,s,r){return O_(this.ast.matchers,e,t,s,r)}buildStyles(e,t,s){let r=this._stateStyles.get("*");return e!==void 0&&(r=this._stateStyles.get(e?.toString())||r),r?r.buildStyles(t,s):new Map}build(e,t,s,r,o,a,l,h,d,m){let g=[],T=this.ast.options&&this.ast.options.params||vo,C=l&&l.params||vo,A=this.buildStyles(s,C,g),R=h&&h.params||vo,P=this.buildStyles(r,R,g),F=new Set,U=new Map,B=new Map,L=r==="void",ke={params:Bh(R,T),delay:this.ast.options?.delay},Z=m?[]:Uh(e,t,this.ast.animation,o,a,A,P,ke,d,g),w=0;return Z.forEach(p=>{w=Math.max(p.duration+p.delay,w)}),g.length?Sh(t,this._triggerName,s,r,L,A,P,[],[],U,B,w,g):(Z.forEach(p=>{let y=p.element,v=Xe(U,y,new Set);p.preStyleProps.forEach(S=>v.add(S));let E=Xe(B,y,new Set);p.postStyleProps.forEach(S=>E.add(S)),y!==t&&F.add(y)}),Sh(t,this._triggerName,s,r,L,A,P,Z,[...F.values()],U,B,w))}};function O_(n,e,t,s,r){return n.some(o=>o(e,t,s,r))}function Bh(n,e){let t=Ct({},e);return Object.entries(n).forEach(([s,r])=>{r!=null&&(t[s]=r)}),t}var Do=class{styles;defaultParams;normalizer;constructor(e,t,s){this.styles=e,this.defaultParams=t,this.normalizer=s}buildStyles(e,t){let s=new Map,r=Bh(e,this.defaultParams);return this.styles.styles.forEach(o=>{typeof o!="string"&&o.forEach((a,l)=>{a&&(a=Fs(a,r,t));let h=this.normalizer.normalizePropertyName(l,t);a=this.normalizer.normalizeStyleValue(l,h,a,t),s.set(l,a)})}),s}};function M_(n,e,t){return new xo(n,e,t)}var xo=class{name;ast;_normalizer;transitionFactories=[];fallbackTransition;states=new Map;constructor(e,t,s){this.name=e,this.ast=t,this._normalizer=s,t.states.forEach(r=>{let o=r.options&&r.options.params||{};this.states.set(r.name,new Do(r.style,o,s))}),bh(this.states,"true","1"),bh(this.states,"false","0"),t.transitions.forEach(r=>{this.transitionFactories.push(new Hr(e,r,this.states))}),this.fallbackTransition=F_(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,s,r){return this.transitionFactories.find(a=>a.match(e,t,s,r))||null}matchStyles(e,t,s){return this.fallbackTransition.buildStyles(e,t,s)}};function F_(n,e,t){let s=[(a,l)=>!0],r={type:j.Sequence,steps:[],options:null},o={type:j.Transition,animation:r,matchers:s,options:null,queryCount:0,depCount:0};return new Hr(n,o,e)}function bh(n,e,t){n.has(e)?n.has(t)||n.set(t,n.get(e)):n.has(t)&&n.set(e,n.get(t))}var V_=new Vs,Oo=class{bodyNode;_driver;_normalizer;_animations=new Map;_playersById=new Map;players=[];constructor(e,t,s){this.bodyNode=e,this._driver=t,this._normalizer=s}register(e,t){let s=[],r=[],o=Lh(this._driver,t,s,r);if(s.length)throw Xg(s);this._animations.set(e,o)}_buildPlayer(e,t,s){let r=e.element,o=kh(this._normalizer,e.keyframes,t,s);return this._driver.animate(r,o,e.duration,e.delay,e.easing,[],!0)}create(e,t,s={}){let r=[],o=this._animations.get(e),a,l=new Map;if(o?(a=Uh(this._driver,t,o,Mh,Io,new Map,new Map,s,V_,r),a.forEach(m=>{let g=Xe(l,m.element,new Map);m.postStyleProps.forEach(T=>g.set(T,null))})):(r.push(Jg()),a=[]),r.length)throw Zg(r);l.forEach((m,g)=>{m.forEach((T,C)=>{m.set(C,this._driver.computeStyle(g,C,ft))})});let h=a.map(m=>{let g=l.get(m.element);return this._buildPlayer(m,new Map,g)}),d=Yt(h);return this._playersById.set(e,d),d.onDestroy(()=>this.destroy(e)),this.players.push(d),d}destroy(e){let t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);let s=this.players.indexOf(t);s>=0&&this.players.splice(s,1)}_getPlayer(e){let t=this._playersById.get(e);if(!t)throw e_(e);return t}listen(e,t,s,r){let o=Uo(t,"","","");return Lo(this._getPlayer(e),s,o,r),()=>{}}command(e,t,s,r){if(s=="register"){this.register(e,r[0]);return}if(s=="create"){let a=r[0]||{};this.create(e,t,a);return}let o=this._getPlayer(e);switch(s){case"play":o.play();break;case"pause":o.pause();break;case"reset":o.reset();break;case"restart":o.restart();break;case"finish":o.finish();break;case"init":o.init();break;case"setPosition":o.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e);break}}},Ah="ng-animate-queued",L_=".ng-animate-queued",wo="ng-animate-disabled",U_=".ng-animate-disabled",B_="ng-star-inserted",q_=".ng-star-inserted",$_=[],qh={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},j_={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},lt="__ng_removed",Ls=class{namespaceId;value;options;get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;let s=e&&e.hasOwnProperty("value"),r=s?e.value:e;if(this.value=G_(r),s){let o=e,{value:a}=o,l=vu(o,["value"]);this.options=l}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){let t=e.params;if(t){let s=this.options.params;Object.keys(t).forEach(r=>{s[r]==null&&(s[r]=t[r])})}}},Ms="void",Eo=new Ls(Ms),Mo=class{id;hostElement;_engine;players=[];_triggers=new Map;_queue=[];_elementListeners=new Map;_hostClassName;constructor(e,t,s){this.id=e,this.hostElement=t,this._engine=s,this._hostClassName="ng-tns-"+e,st(t,this._hostClassName)}listen(e,t,s,r){if(!this._triggers.has(t))throw t_(s,t);if(s==null||s.length==0)throw n_(t);if(!K_(s))throw s_(s,t);let o=Xe(this._elementListeners,e,[]),a={name:t,phase:s,callback:r};o.push(a);let l=Xe(this._engine.statesByElement,e,new Map);return l.has(t)||(st(e,Vr),st(e,Vr+"-"+t),l.set(t,Eo)),()=>{this._engine.afterFlush(()=>{let h=o.indexOf(a);h>=0&&o.splice(h,1),this._triggers.has(t)||l.delete(t)})}}register(e,t){return this._triggers.has(e)?!1:(this._triggers.set(e,t),!0)}_getTrigger(e){let t=this._triggers.get(e);if(!t)throw r_(e);return t}trigger(e,t,s,r=!0){let o=this._getTrigger(t),a=new Us(this.id,t,e),l=this._engine.statesByElement.get(e);l||(st(e,Vr),st(e,Vr+"-"+t),this._engine.statesByElement.set(e,l=new Map));let h=l.get(t),d=new Ls(s,this.id);if(!(s&&s.hasOwnProperty("value"))&&h&&d.absorbOptions(h.options),l.set(t,d),h||(h=Eo),!(d.value===Ms)&&h.value===d.value){if(!Q_(h.params,d.params)){let R=[],P=o.matchStyles(h.value,h.params,R),F=o.matchStyles(d.value,d.params,R);R.length?this._engine.reportError(R):this._engine.afterFlush(()=>{pn(e,P),vt(e,F)})}return}let T=Xe(this._engine.playersByElement,e,[]);T.forEach(R=>{R.namespaceId==this.id&&R.triggerName==t&&R.queued&&R.destroy()});let C=o.matchTransition(h.value,d.value,e,d.params),A=!1;if(!C){if(!r)return;C=o.fallbackTransition,A=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:C,fromState:h,toState:d,player:a,isFallbackTransition:A}),A||(st(e,Ah),a.onStart(()=>{zn(e,Ah)})),a.onDone(()=>{let R=this.players.indexOf(a);R>=0&&this.players.splice(R,1);let P=this._engine.playersByElement.get(e);if(P){let F=P.indexOf(a);F>=0&&P.splice(F,1)}}),this.players.push(a),T.push(a),a}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,s)=>{this._elementListeners.set(s,t.filter(r=>r.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);let t=this._engine.playersByElement.get(e);t&&(t.forEach(s=>s.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){let s=this._engine.driver.query(e,$r,!0);s.forEach(r=>{if(r[lt])return;let o=this._engine.fetchNamespacesByElement(r);o.size?o.forEach(a=>a.triggerLeaveAnimation(r,t,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>s.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(e,t,s,r){let o=this._engine.statesByElement.get(e),a=new Map;if(o){let l=[];if(o.forEach((h,d)=>{if(a.set(d,h.value),this._triggers.has(d)){let m=this.trigger(e,d,Ms,r);m&&l.push(m)}}),l.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,a),s&&Yt(l).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){let t=this._elementListeners.get(e),s=this._engine.statesByElement.get(e);if(t&&s){let r=new Set;t.forEach(o=>{let a=o.name;if(r.has(a))return;r.add(a);let h=this._triggers.get(a).fallbackTransition,d=s.get(a)||Eo,m=new Ls(Ms),g=new Us(this.id,a,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:a,transition:h,fromState:d,toState:m,player:g,isFallbackTransition:!0})})}}removeNode(e,t){let s=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let r=!1;if(s.totalAnimations){let o=s.players.length?s.playersByQueriedElement.get(e):[];if(o&&o.length)r=!0;else{let a=e;for(;a=a.parentNode;)if(s.statesByElement.get(a)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(e),r)s.markElementAsRemoved(this.id,e,!1,t);else{let o=e[lt];(!o||o===qh)&&(s.afterFlush(()=>this.clearElementCache(e)),s.destroyInnerAnimations(e),s._onRemovalComplete(e,t))}}insertNode(e,t){st(e,this._hostClassName)}drainQueuedTransitions(e){let t=[];return this._queue.forEach(s=>{let r=s.player;if(r.destroyed)return;let o=s.element,a=this._elementListeners.get(o);a&&a.forEach(l=>{if(l.name==s.triggerName){let h=Uo(o,s.triggerName,s.fromState.value,s.toState.value);h._data=e,Lo(s.player,l.phase,h,l.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(s)}),this._queue=[],t.sort((s,r)=>{let o=s.transition.ast.depCount,a=r.transition.ast.depCount;return o==0||a==0?o-a:this._engine.driver.containsElement(s.element,r.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}},Fo=class{bodyNode;driver;_normalizer;players=[];newHostElements=new Map;playersByElement=new Map;playersByQueriedElement=new Map;statesByElement=new Map;disabledNodes=new Set;totalAnimations=0;totalQueuedPlayers=0;_namespaceLookup={};_namespaceList=[];_flushFns=[];_whenQuietFns=[];namespacesByHostElement=new Map;collectedEnterElements=[];collectedLeaveElements=[];onRemovalComplete=(e,t)=>{};_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,s){this.bodyNode=e,this.driver=t,this._normalizer=s}get queuedPlayers(){let e=[];return this._namespaceList.forEach(t=>{t.players.forEach(s=>{s.queued&&e.push(s)})}),e}createNamespace(e,t){let s=new Mo(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(s,t):(this.newHostElements.set(t,s),this.collectEnterElement(t)),this._namespaceLookup[e]=s}_balanceNamespaceList(e,t){let s=this._namespaceList,r=this.namespacesByHostElement;if(s.length-1>=0){let a=!1,l=this.driver.getParentElement(t);for(;l;){let h=r.get(l);if(h){let d=s.indexOf(h);s.splice(d+1,0,e),a=!0;break}l=this.driver.getParentElement(l)}a||s.unshift(e)}else s.push(e);return r.set(t,e),e}register(e,t){let s=this._namespaceLookup[e];return s||(s=this.createNamespace(e,t)),s}registerTrigger(e,t,s){let r=this._namespaceLookup[e];r&&r.register(t,s)&&this.totalAnimations++}destroy(e,t){e&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{let s=this._fetchNamespace(e);this.namespacesByHostElement.delete(s.hostElement);let r=this._namespaceList.indexOf(s);r>=0&&this._namespaceList.splice(r,1),s.destroy(t),delete this._namespaceLookup[e]}))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){let t=new Set,s=this.statesByElement.get(e);if(s){for(let r of s.values())if(r.namespaceId){let o=this._fetchNamespace(r.namespaceId);o&&t.add(o)}}return t}trigger(e,t,s,r){if(Br(t)){let o=this._fetchNamespace(e);if(o)return o.trigger(t,s,r),!0}return!1}insertNode(e,t,s,r){if(!Br(t))return;let o=t[lt];if(o&&o.setForRemoval){o.setForRemoval=!1,o.setForMove=!0;let a=this.collectedLeaveElements.indexOf(t);a>=0&&this.collectedLeaveElements.splice(a,1)}if(e){let a=this._fetchNamespace(e);a&&a.insertNode(t,s)}r&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),st(e,wo)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),zn(e,wo))}removeNode(e,t,s){if(Br(t)){let r=e?this._fetchNamespace(e):null;r?r.removeNode(t,s):this.markElementAsRemoved(e,t,!1,s);let o=this.namespacesByHostElement.get(t);o&&o.id!==e&&o.removeNode(t,s)}else this._onRemovalComplete(t,s)}markElementAsRemoved(e,t,s,r,o){this.collectedLeaveElements.push(t),t[lt]={namespaceId:e,setForRemoval:r,hasAnimation:s,removedBeforeQueried:!1,previousTriggersValues:o}}listen(e,t,s,r,o){return Br(t)?this._fetchNamespace(e).listen(t,s,r,o):()=>{}}_buildInstruction(e,t,s,r,o){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,s,r,e.fromState.options,e.toState.options,t,o)}destroyInnerAnimations(e){let t=this.driver.query(e,$r,!0);t.forEach(s=>this.destroyActiveAnimationsForElement(s)),this.playersByQueriedElement.size!=0&&(t=this.driver.query(e,So,!0),t.forEach(s=>this.finishActiveQueriedAnimationOnElement(s)))}destroyActiveAnimationsForElement(e){let t=this.playersByElement.get(e);t&&t.forEach(s=>{s.queued?s.markedForDestroy=!0:s.destroy()})}finishActiveQueriedAnimationOnElement(e){let t=this.playersByQueriedElement.get(e);t&&t.forEach(s=>s.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return Yt(this.players).onDone(()=>e());e()})}processLeaveNode(e){let t=e[lt];if(t&&t.setForRemoval){if(e[lt]=qh,t.namespaceId){this.destroyInnerAnimations(e);let s=this._fetchNamespace(t.namespaceId);s&&s.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(wo)&&this.markElementAsDisabled(e,!1),this.driver.query(e,U_,!0).forEach(s=>{this.markElementAsDisabled(s,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((s,r)=>this._balanceNamespaceList(s,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let s=0;s<this.collectedEnterElements.length;s++){let r=this.collectedEnterElements[s];st(r,B_)}if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){let s=[];try{t=this._flushAnimations(s,e)}finally{for(let r=0;r<s.length;r++)s[r]()}}else for(let s=0;s<this.collectedLeaveElements.length;s++){let r=this.collectedLeaveElements[s];this.processLeaveNode(r)}if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(s=>s()),this._flushFns=[],this._whenQuietFns.length){let s=this._whenQuietFns;this._whenQuietFns=[],t.length?Yt(t).onDone(()=>{s.forEach(r=>r())}):s.forEach(r=>r())}}reportError(e){throw i_(e)}_flushAnimations(e,t){let s=new Vs,r=[],o=new Map,a=[],l=new Map,h=new Map,d=new Map,m=new Set;this.disabledNodes.forEach(x=>{m.add(x);let O=this.driver.query(x,L_,!0);for(let M=0;M<O.length;M++)m.add(O[M])});let g=this.bodyNode,T=Array.from(this.statesByElement.keys()),C=Ph(T,this.collectedEnterElements),A=new Map,R=0;C.forEach((x,O)=>{let M=Mh+R++;A.set(O,M),x.forEach(q=>st(q,M))});let P=[],F=new Set,U=new Set;for(let x=0;x<this.collectedLeaveElements.length;x++){let O=this.collectedLeaveElements[x],M=O[lt];M&&M.setForRemoval&&(P.push(O),F.add(O),M.hasAnimation?this.driver.query(O,q_,!0).forEach(q=>F.add(q)):U.add(O))}let B=new Map,L=Ph(T,Array.from(F));L.forEach((x,O)=>{let M=Io+R++;B.set(O,M),x.forEach(q=>st(q,M))}),e.push(()=>{C.forEach((x,O)=>{let M=A.get(O);x.forEach(q=>zn(q,M))}),L.forEach((x,O)=>{let M=B.get(O);x.forEach(q=>zn(q,M))}),P.forEach(x=>{this.processLeaveNode(x)})});let ke=[],Z=[];for(let x=this._namespaceList.length-1;x>=0;x--)this._namespaceList[x].drainQueuedTransitions(t).forEach(M=>{let q=M.player,ce=M.element;if(ke.push(q),this.collectedEnterElements.length){let ae=ce[lt];if(ae&&ae.setForMove){if(ae.previousTriggersValues&&ae.previousTriggersValues.has(M.triggerName)){let It=ae.previousTriggersValues.get(M.triggerName),Ge=this.statesByElement.get(M.element);if(Ge&&Ge.has(M.triggerName)){let St=Ge.get(M.triggerName);St.value=It,Ge.set(M.triggerName,St)}}q.destroy();return}}let tt=!g||!this.driver.containsElement(g,ce),oe=B.get(ce),ee=A.get(ce),te=this._buildInstruction(M,s,ee,oe,tt);if(te.errors&&te.errors.length){Z.push(te);return}if(tt){q.onStart(()=>pn(ce,te.fromStyles)),q.onDestroy(()=>vt(ce,te.toStyles)),r.push(q);return}if(M.isFallbackTransition){q.onStart(()=>pn(ce,te.fromStyles)),q.onDestroy(()=>vt(ce,te.toStyles)),r.push(q);return}let Lt=[];te.timelines.forEach(ae=>{ae.stretchStartingKeyframe=!0,this.disabledNodes.has(ae.element)||Lt.push(ae)}),te.timelines=Lt,s.append(ce,te.timelines);let ki={instruction:te,player:q,element:ce};a.push(ki),te.queriedElements.forEach(ae=>Xe(l,ae,[]).push(q)),te.preStyleProps.forEach((ae,It)=>{if(ae.size){let Ge=h.get(It);Ge||h.set(It,Ge=new Set),ae.forEach((St,Ut)=>Ge.add(Ut))}}),te.postStyleProps.forEach((ae,It)=>{let Ge=d.get(It);Ge||d.set(It,Ge=new Set),ae.forEach((St,Ut)=>Ge.add(Ut))})});if(Z.length){let x=[];Z.forEach(O=>{x.push(o_(O.triggerName,O.errors))}),ke.forEach(O=>O.destroy()),this.reportError(x)}let w=new Map,p=new Map;a.forEach(x=>{let O=x.element;s.has(O)&&(p.set(O,O),this._beforeAnimationBuild(x.player.namespaceId,x.instruction,w))}),r.forEach(x=>{let O=x.element;this._getPreviousPlayers(O,!1,x.namespaceId,x.triggerName,null).forEach(q=>{Xe(w,O,[]).push(q),q.destroy()})});let y=P.filter(x=>Nh(x,h,d)),v=new Map;Rh(v,this.driver,U,d,ft).forEach(x=>{Nh(x,h,d)&&y.push(x)});let S=new Map;C.forEach((x,O)=>{Rh(S,this.driver,new Set(x),h,kr)}),y.forEach(x=>{let O=v.get(x),M=S.get(x);v.set(x,new Map([...O?.entries()??[],...M?.entries()??[]]))});let _=[],et=[],Vt={};a.forEach(x=>{let{element:O,player:M,instruction:q}=x;if(s.has(O)){if(m.has(O)){M.onDestroy(()=>vt(O,q.toStyles)),M.disabled=!0,M.overrideTotalTime(q.totalTime),r.push(M);return}let ce=Vt;if(p.size>1){let oe=O,ee=[];for(;oe=oe.parentNode;){let te=p.get(oe);if(te){ce=te;break}ee.push(oe)}ee.forEach(te=>p.set(te,ce))}let tt=this._buildAnimation(M.namespaceId,q,w,o,S,v);if(M.setRealPlayer(tt),ce===Vt)_.push(M);else{let oe=this.playersByElement.get(ce);oe&&oe.length&&(M.parentPlayer=Yt(oe)),r.push(M)}}else pn(O,q.fromStyles),M.onDestroy(()=>vt(O,q.toStyles)),et.push(M),m.has(O)&&r.push(M)}),et.forEach(x=>{let O=o.get(x.element);if(O&&O.length){let M=Yt(O);x.setRealPlayer(M)}}),r.forEach(x=>{x.parentPlayer?x.syncPlayerEvents(x.parentPlayer):x.destroy()});for(let x=0;x<P.length;x++){let O=P[x],M=O[lt];if(zn(O,Io),M&&M.hasAnimation)continue;let q=[];if(l.size){let tt=l.get(O);tt&&tt.length&&q.push(...tt);let oe=this.driver.query(O,So,!0);for(let ee=0;ee<oe.length;ee++){let te=l.get(oe[ee]);te&&te.length&&q.push(...te)}}let ce=q.filter(tt=>!tt.destroyed);ce.length?W_(this,O,ce):this.processLeaveNode(O)}return P.length=0,_.forEach(x=>{this.players.push(x),x.onDone(()=>{x.destroy();let O=this.players.indexOf(x);this.players.splice(O,1)}),x.play()}),_}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,s,r,o){let a=[];if(t){let l=this.playersByQueriedElement.get(e);l&&(a=l)}else{let l=this.playersByElement.get(e);if(l){let h=!o||o==Ms;l.forEach(d=>{d.queued||!h&&d.triggerName!=r||a.push(d)})}}return(s||r)&&(a=a.filter(l=>!(s&&s!=l.namespaceId||r&&r!=l.triggerName))),a}_beforeAnimationBuild(e,t,s){let r=t.triggerName,o=t.element,a=t.isRemovalTransition?void 0:e,l=t.isRemovalTransition?void 0:r;for(let h of t.timelines){let d=h.element,m=d!==o,g=Xe(s,d,[]);this._getPreviousPlayers(d,m,a,l,t.toState).forEach(C=>{let A=C.getRealPlayer();A.beforeDestroy&&A.beforeDestroy(),C.destroy(),g.push(C)})}pn(o,t.fromStyles)}_buildAnimation(e,t,s,r,o,a){let l=t.triggerName,h=t.element,d=[],m=new Set,g=new Set,T=t.timelines.map(A=>{let R=A.element;m.add(R);let P=R[lt];if(P&&P.removedBeforeQueried)return new Ln(A.duration,A.delay);let F=R!==h,U=H_((s.get(R)||$_).map(w=>w.getRealPlayer())).filter(w=>{let p=w;return p.element?p.element===R:!1}),B=o.get(R),L=a.get(R),ke=kh(this._normalizer,A.keyframes,B,L),Z=this._buildPlayer(A,ke,U);if(A.subTimeline&&r&&g.add(R),F){let w=new Us(e,l,R);w.setRealPlayer(Z),d.push(w)}return Z});d.forEach(A=>{Xe(this.playersByQueriedElement,A.element,[]).push(A),A.onDone(()=>z_(this.playersByQueriedElement,A.element,A))}),m.forEach(A=>st(A,wh));let C=Yt(T);return C.onDestroy(()=>{m.forEach(A=>zn(A,wh)),vt(h,t.toStyles)}),g.forEach(A=>{Xe(r,A,[]).push(C)}),C}_buildPlayer(e,t,s){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,s):new Ln(e.duration,e.delay)}},Us=class{namespaceId;triggerName;element;_player=new Ln;_containsRealPlayer=!1;_queuedCallbacks=new Map;destroyed=!1;parentPlayer=null;markedForDestroy=!1;disabled=!1;queued=!0;totalTime=0;constructor(e,t,s){this.namespaceId=e,this.triggerName=t,this.element=s}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,s)=>{t.forEach(r=>Lo(e,s,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){let t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){Xe(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return this.queued?!1:this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){let t=this._player;t.triggerCallback&&t.triggerCallback(e)}};function z_(n,e,t){let s=n.get(e);if(s){if(s.length){let r=s.indexOf(t);s.splice(r,1)}s.length==0&&n.delete(e)}return s}function G_(n){return n??null}function Br(n){return n&&n.nodeType===1}function K_(n){return n=="start"||n=="done"}function Ch(n,e){let t=n.style.display;return n.style.display=e??"none",t}function Rh(n,e,t,s,r){let o=[];t.forEach(h=>o.push(Ch(h)));let a=[];s.forEach((h,d)=>{let m=new Map;h.forEach(g=>{let T=e.computeStyle(d,g,r);m.set(g,T),(!T||T.length==0)&&(d[lt]=j_,a.push(d))}),n.set(d,m)});let l=0;return t.forEach(h=>Ch(h,o[l++])),a}function Ph(n,e){let t=new Map;if(n.forEach(l=>t.set(l,[])),e.length==0)return t;let s=1,r=new Set(e),o=new Map;function a(l){if(!l)return s;let h=o.get(l);if(h)return h;let d=l.parentNode;return t.has(d)?h=d:r.has(d)?h=s:h=a(d),o.set(l,h),h}return e.forEach(l=>{let h=a(l);h!==s&&t.get(h).push(l)}),t}function st(n,e){n.classList?.add(e)}function zn(n,e){n.classList?.remove(e)}function W_(n,e,t){Yt(t).onDone(()=>n.processLeaveNode(e))}function H_(n){let e=[];return $h(n,e),e}function $h(n,e){for(let t=0;t<n.length;t++){let s=n[t];s instanceof uo?$h(s.players,e):e.push(s)}}function Q_(n,e){let t=Object.keys(n),s=Object.keys(e);if(t.length!=s.length)return!1;for(let r=0;r<t.length;r++){let o=t[r];if(!e.hasOwnProperty(o)||n[o]!==e[o])return!1}return!0}function Nh(n,e,t){let s=t.get(n);if(!s)return!1;let r=e.get(n);return r?s.forEach(o=>r.add(o)):e.set(n,s),t.delete(n),!0}var Gn=class{_driver;_normalizer;_transitionEngine;_timelineEngine;_triggerCache={};onRemovalComplete=(e,t)=>{};constructor(e,t,s){this._driver=t,this._normalizer=s,this._transitionEngine=new Fo(e.body,t,s),this._timelineEngine=new Oo(e.body,t,s),this._transitionEngine.onRemovalComplete=(r,o)=>this.onRemovalComplete(r,o)}registerTrigger(e,t,s,r,o){let a=e+"-"+r,l=this._triggerCache[a];if(!l){let h=[],d=[],m=Lh(this._driver,o,h,d);if(h.length)throw Qg(r,h);l=M_(r,m,this._normalizer),this._triggerCache[a]=l}this._transitionEngine.registerTrigger(t,r,l)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,s,r){this._transitionEngine.insertNode(e,t,s,r)}onRemove(e,t,s){this._transitionEngine.removeNode(e,t,s)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,s,r){if(s.charAt(0)=="@"){let[o,a]=yh(s),l=r;this._timelineEngine.command(o,t,a,l)}else this._transitionEngine.trigger(e,t,s,r)}listen(e,t,s,r,o){if(s.charAt(0)=="@"){let[a,l]=yh(s);return this._timelineEngine.listen(a,t,l,o)}return this._transitionEngine.listen(e,t,s,r,o)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(e){this._transitionEngine.afterFlushAnimationsDone(e)}};function Y_(n,e){let t=null,s=null;return Array.isArray(e)&&e.length?(t=To(e[0]),e.length>1&&(s=To(e[e.length-1]))):e instanceof Map&&(t=To(e)),t||s?new X_(n,t,s):null}var X_=(()=>{class n{_element;_startStyles;_endStyles;static initialStylesByElement=new WeakMap;_state=0;_initialStyles;constructor(t,s,r){this._element=t,this._startStyles=s,this._endStyles=r;let o=n.initialStylesByElement.get(t);o||n.initialStylesByElement.set(t,o=new Map),this._initialStyles=o}start(){this._state<1&&(this._startStyles&&vt(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(vt(this._element,this._initialStyles),this._endStyles&&(vt(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(pn(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(pn(this._element,this._endStyles),this._endStyles=null),vt(this._element,this._initialStyles),this._state=3)}}return n})();function To(n){let e=null;return n.forEach((t,s)=>{J_(s)&&(e=e||new Map,e.set(s,t))}),e}function J_(n){return n==="display"||n==="position"}var Qr=class{element;keyframes;options;_specialStyles;_onDoneFns=[];_onStartFns=[];_onDestroyFns=[];_duration;_delay;_initialized=!1;_finished=!1;_started=!1;_destroyed=!1;_finalKeyframe;_originalOnDoneFns=[];_originalOnStartFns=[];domPlayer;time=0;parentPlayer=null;currentSnapshot=new Map;constructor(e,t,s,r){this.element=e,this.keyframes=t,this.options=s,this._specialStyles=r,this._duration=s.duration,this._delay=s.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;let e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map;let t=()=>this._onFinish();this.domPlayer.addEventListener("finish",t),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",t)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){let t=[];return e.forEach(s=>{t.push(Object.fromEntries(s))}),t}_triggerWebAnimation(e,t,s){return e.animate(this._convertKeyframesToObject(t),s)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){this.domPlayer===void 0&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){let e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((s,r)=>{r!=="offset"&&e.set(r,this._finished?s:jo(this.element,r))}),this.currentSnapshot=e}triggerCallback(e){let t=e==="start"?this._onStartFns:this._onDoneFns;t.forEach(s=>s()),t.length=0}},Yr=class{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}containsElement(e,t){return Dh(e,t)}getParentElement(e){return Bo(e)}query(e,t,s){return xh(e,t,s)}computeStyle(e,t,s){return jo(e,t)}animate(e,t,s,r,o,a=[]){let l=r==0?"both":"forwards",h={duration:s,delay:r,fill:l};o&&(h.easing=o);let d=new Map,m=a.filter(C=>C instanceof Qr);__(s,r)&&m.forEach(C=>{C.currentSnapshot.forEach((A,R)=>d.set(R,A))});let g=p_(t).map(C=>new Map(C));g=y_(e,g,d);let T=Y_(e,g);return new Qr(e,g,h,T)}};var qr="@",jh="@.disabled",Xr=class{namespaceId;delegate;engine;_onDestroy;\u0275type=0;constructor(e,t,s,r){this.namespaceId=e,this.delegate=t,this.engine=s,this._onDestroy=r}get data(){return this.delegate.data}destroyNode(e){this.delegate.destroyNode?.(e)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,s,r=!0){this.delegate.insertBefore(e,t,s),this.engine.onInsert(this.namespaceId,t,e,r)}removeChild(e,t,s){this.parentNode(t)&&this.engine.onRemove(this.namespaceId,t,this.delegate)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,s,r){this.delegate.setAttribute(e,t,s,r)}removeAttribute(e,t,s){this.delegate.removeAttribute(e,t,s)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,s,r){this.delegate.setStyle(e,t,s,r)}removeStyle(e,t,s){this.delegate.removeStyle(e,t,s)}setProperty(e,t,s){t.charAt(0)==qr&&t==jh?this.disableAnimations(e,!!s):this.delegate.setProperty(e,t,s)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,s,r){return this.delegate.listen(e,t,s,r)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}},Vo=class extends Xr{factory;constructor(e,t,s,r,o){super(t,s,r,o),this.factory=e,this.namespaceId=t}setProperty(e,t,s){t.charAt(0)==qr?t.charAt(1)=="."&&t==jh?(s=s===void 0?!0:!!s,this.disableAnimations(e,s)):this.engine.process(this.namespaceId,e,t.slice(1),s):this.delegate.setProperty(e,t,s)}listen(e,t,s,r){if(t.charAt(0)==qr){let o=Z_(e),a=t.slice(1),l="";return a.charAt(0)!=qr&&([a,l]=ey(a)),this.engine.listen(this.namespaceId,o,a,l,h=>{let d=h._data||-1;this.factory.scheduleListenerCallback(d,s,h)})}return this.delegate.listen(e,t,s,r)}};function Z_(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}function ey(n){let e=n.indexOf("."),t=n.substring(0,e),s=n.slice(e+1);return[t,s]}var Jr=class{delegate;engine;_zone;_currentId=0;_microtaskId=1;_animationCallbacksBuffer=[];_rendererCache=new Map;_cdRecurDepth=0;constructor(e,t,s){this.delegate=e,this.engine=t,this._zone=s,t.onRemovalComplete=(r,o)=>{o?.removeChild(null,r)}}createRenderer(e,t){let s="",r=this.delegate.createRenderer(e,t);if(!e||!t?.data?.animation){let d=this._rendererCache,m=d.get(r);if(!m){let g=()=>d.delete(r);m=new Xr(s,r,this.engine,g),d.set(r,m)}return m}let o=t.id,a=t.id+"-"+this._currentId;this._currentId++,this.engine.register(a,e);let l=d=>{Array.isArray(d)?d.forEach(l):this.engine.registerTrigger(o,a,e,d.name,d)};return t.data.animation.forEach(l),new Vo(this,a,r,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(e,t,s){if(e>=0&&e<this._microtaskId){this._zone.run(()=>t(s));return}let r=this._animationCallbacksBuffer;r.length==0&&queueMicrotask(()=>{this._zone.run(()=>{r.forEach(o=>{let[a,l]=o;a(l)}),this._animationCallbacksBuffer=[]})}),r.push([t,s])}end(){this._cdRecurDepth--,this._cdRecurDepth==0&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}componentReplaced(e){this.engine.flush(),this.delegate.componentReplaced?.(e)}};var ry=(()=>{class n extends Gn{constructor(t,s,r){super(t,s,r)}ngOnDestroy(){this.flush()}static \u0275fac=function(s){return new(s||n)(Ce(Du),Ce(mn),Ce(gn))};static \u0275prov=Rt({token:n,factory:n.\u0275fac})}return n})();function iy(){return new zr}function oy(n,e,t){return new Jr(n,e,t)}var zh=[{provide:gn,useFactory:iy},{provide:Gn,useClass:ry},{provide:Ru,useFactory:oy,deps:[Fu,Gn,re]}],CS=[{provide:mn,useClass:qo},{provide:oo,useValue:"NoopAnimations"},...zh],ay=[{provide:mn,useFactory:()=>new Yr},{provide:oo,useFactory:()=>"BrowserAnimations"},...zh];function Gh(){return Au("NgEagerAnimations"),[...ay]}var Zr="analytics",ly="firebase_id",cy="origin",uy=60*1e3,hy="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Xo="https://www.googletagmanager.com/gtag/js";var $e=new _t("@firebase/analytics");var dy={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Je=new $n("analytics","Analytics",dy);function fy(n){if(!n.startsWith(Xo)){let e=Je.create("invalid-gtag-resource",{gtagURL:n});return $e.warn(e.message),""}return n}function Jh(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function py(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function my(n,e){let t=py("firebase-js-sdk-policy",{createScriptURL:fy}),s=document.createElement("script"),r=`${Xo}?l=${n}&id=${e}`;s.src=t?t?.createScriptURL(r):r,s.async=!0,document.head.appendChild(s)}function gy(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}function _y(n,e,t,s,r,o){return D(this,null,function*(){let a=s[r];try{if(a)yield e[a];else{let h=(yield Jh(t)).find(d=>d.measurementId===r);h&&(yield e[h.appId])}}catch(l){$e.error(l)}n("config",r,o)})}function yy(n,e,t,s,r){return D(this,null,function*(){try{let o=[];if(r&&r.send_to){let a=r.send_to;Array.isArray(a)||(a=[a]);let l=yield Jh(t);for(let h of a){let d=l.find(g=>g.measurementId===h),m=d&&e[d.appId];if(m)o.push(m);else{o=[];break}}}o.length===0&&(o=Object.values(e)),yield Promise.all(o),n("event",s,r||{})}catch(o){$e.error(o)}})}function vy(n,e,t,s){function r(o,...a){return D(this,null,function*(){try{if(o==="event"){let[l,h]=a;yield yy(n,e,t,l,h)}else if(o==="config"){let[l,h]=a;yield _y(n,e,t,s,l,h)}else if(o==="consent"){let[l,h]=a;n("consent",l,h)}else if(o==="get"){let[l,h,d]=a;n("get",l,h,d)}else if(o==="set"){let[l]=a;n("set",l)}else n(o,...a)}catch(l){$e.error(l)}})}return r}function wy(n,e,t,s,r){let o=function(...a){window[s].push(arguments)};return window[r]&&typeof window[r]=="function"&&(o=window[r]),window[r]=vy(o,n,e,t),{gtagCore:o,wrappedGtag:window[r]}}function Ey(n){let e=window.document.getElementsByTagName("script");for(let t of Object.values(e))if(t.src&&t.src.includes(Xo)&&t.src.includes(n))return t;return null}var Ty=30,Iy=1e3,Ko=class{constructor(e={},t=Iy){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}},Zh=new Ko;function Sy(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}function by(n){return D(this,null,function*(){var e;let{appId:t,apiKey:s}=n,r={method:"GET",headers:Sy(s)},o=hy.replace("{app-id}",t),a=yield fetch(o,r);if(a.status!==200&&a.status!==304){let l="";try{let h=yield a.json();!((e=h.error)===null||e===void 0)&&e.message&&(l=h.error.message)}catch{}throw Je.create("config-fetch-failed",{httpStatus:a.status,responseMessage:l})}return a.json()})}function Ay(s){return D(this,arguments,function*(n,e=Zh,t){let{appId:r,apiKey:o,measurementId:a}=n.options;if(!r)throw Je.create("no-app-id");if(!o){if(a)return{measurementId:a,appId:r};throw Je.create("no-api-key")}let l=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},h=new Wo;return setTimeout(()=>D(this,null,function*(){h.abort()}),t!==void 0?t:uy),ed({appId:r,apiKey:o,measurementId:a},l,h,e)})}function ed(o,a,l){return D(this,arguments,function*(n,{throttleEndTimeMillis:e,backoffCount:t},s,r=Zh){var h;let{appId:d,measurementId:m}=n;try{yield Cy(s,e)}catch(g){if(m)return $e.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${m} provided in the "measurementId" field in the local Firebase config. [${g?.message}]`),{appId:d,measurementId:m};throw g}try{let g=yield by(n);return r.deleteThrottleMetadata(d),g}catch(g){let T=g;if(!Ry(T)){if(r.deleteThrottleMetadata(d),m)return $e.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${m} provided in the "measurementId" field in the local Firebase config. [${T?.message}]`),{appId:d,measurementId:m};throw g}let C=Number((h=T?.customData)===null||h===void 0?void 0:h.httpStatus)===503?xs(t,r.intervalMillis,Ty):xs(t,r.intervalMillis),A={throttleEndTimeMillis:Date.now()+C,backoffCount:t+1};return r.setThrottleMetadata(d,A),$e.debug(`Calling attemptFetch again in ${C} millis`),ed(n,A,s,r)}})}function Cy(n,e){return new Promise((t,s)=>{let r=Math.max(e-Date.now(),0),o=setTimeout(t,r);n.addEventListener(()=>{clearTimeout(o),s(Je.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function Ry(n){if(!(n instanceof mt)||!n.customData)return!1;let e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}var Wo=class{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}};var Ho;function Py(n,e,t,s,r){return D(this,null,function*(){if(r&&r.global){n("event",t,s);return}else{let o=yield e,a=Object.assign(Object.assign({},s),{send_to:o});n("event",t,a)}})}function Ny(n,e,t,s){return D(this,null,function*(){if(s&&s.global)return n("set",{user_id:t}),Promise.resolve();{let r=yield e;n("config",r,{update:!0,user_id:t})}})}var Qo;function ky(n){Qo=n}function Dy(n){Ho=n}function xy(){return D(this,null,function*(){if(Gt())try{yield qn()}catch(n){return $e.warn(Je.create("indexeddb-unavailable",{errorInfo:n?.toString()}).message),!1}else return $e.warn(Je.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0})}function Oy(n,e,t,s,r,o,a){return D(this,null,function*(){var l;let h=Ay(n);h.then(C=>{t[C.measurementId]=C.appId,n.options.measurementId&&C.measurementId!==n.options.measurementId&&$e.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${C.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(C=>$e.error(C)),e.push(h);let d=xy().then(C=>{if(C)return s.getId()}),[m,g]=yield Promise.all([h,d]);Ey(o)||my(o,m.measurementId),Qo&&(r("consent","default",Qo),ky(void 0)),r("js",new Date);let T=(l=a?.config)!==null&&l!==void 0?l:{};return T[cy]="firebase",T.update=!0,g!=null&&(T[ly]=g),r("config",m.measurementId,T),Ho&&(r("set",Ho),Dy(void 0)),m.measurementId})}var Yo=class{constructor(e){this.app=e}_delete(){return delete Kn[this.app.options.appId],Promise.resolve()}},Kn={},Kh=[],Wh={},Go="dataLayer",My="gtag",Hh,Jo,Qh=!1;function Fy(){let n=[];if(po()&&n.push("This is a browser extension environment."),Ns()||n.push("Cookies are not available."),n.length>0){let e=n.map((s,r)=>`(${r+1}) ${s}`).join(" "),t=Je.create("invalid-analytics-context",{errorInfo:e});$e.warn(t.message)}}function Vy(n,e,t){Fy();let s=n.options.appId;if(!s)throw Je.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)$e.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Je.create("no-api-key");if(Kn[s]!=null)throw Je.create("already-exists",{id:s});if(!Qh){gy(Go);let{wrappedGtag:o,gtagCore:a}=wy(Kn,Kh,Wh,Go,My);Jo=o,Hh=a,Qh=!0}return Kn[s]=Oy(n,Kh,Wh,e,Hh,Go,t),new Yo(n)}function td(n=Fe()){n=de(n);let e=Re(n,Zr);return e.isInitialized()?e.getImmediate():nd(n)}function nd(n,e={}){let t=Re(n,Zr);if(t.isInitialized()){let r=t.getImmediate();if(Kt(e,t.getOptions()))return r;throw Je.create("already-initialized")}return t.initialize({options:e})}function sd(){return D(this,null,function*(){if(po()||!Ns()||!Gt())return!1;try{return yield qn()}catch{return!1}})}function rd(n,e,t){n=de(n),Ny(Jo,Kn[n.app.options.appId],e,t).catch(s=>$e.error(s))}function Zo(n,e,t,s){n=de(n),Py(Jo,Kn[n.app.options.appId],e,t,s).catch(r=>$e.error(r))}var Yh="@firebase/analytics",Xh="0.10.12";function Ly(){ve(new ye(Zr,(e,{options:t})=>{let s=e.getProvider("app").getImmediate(),r=e.getProvider("installations-internal").getImmediate();return Vy(s,r,t)},"PUBLIC")),ve(new ye("analytics-internal",n,"PRIVATE")),V(Yh,Xh),V(Yh,Xh,"esm2017");function n(e){try{let t=e.getProvider(Zr).getImmediate();return{logEvent:(s,r,o)=>Zo(t,s,r,o)}}catch(t){throw Je.create("interop-component-reg-failed",{reason:t})}}}Ly();var _n=class{constructor(e){return e}},ad="analytics",ta=class{constructor(){return Ee(ad)}};var ld=he(td,!0);var cd=he(sd,!1),Uy=he(Zo,!1,2);var By=he(rd,!0,2);var sa=(()=>{class n{initialized;disposables=[];constructor(t,s,r){V("angularfire",fe.full,"user-tracking");let o;this.initialized=s.runOutsideAngular(()=>new Promise(a=>{o=a})),cd().then(()=>{let a=r.get(_n);a?this.disposables=[uh(t).subscribe(l=>{By(a,l?.uid),o()})]:o()})}ngOnDestroy(){this.disposables.forEach(t=>t.unsubscribe())}static \u0275fac=function(s){return new(s||n)(Ce(lh),Ce(re),Ce(ue))};static \u0275prov=Rt({token:n,factory:n.\u0275fac})}return n})(),qy="firebase_event_origin",$y="firebase_previous_class",jy="firebase_previous_id",zy="firebase_previous_screen",Gy="firebase_screen_class",id="firebase_screen_id",Ky="firebase_screen",na="outlet",Wy="page_path",Hy="page_title",Bs="screen_class",od="screen_name",Qy="screen_view",Yy="auto",Xy="#",Jy=Math.floor(Math.random()*(2**32-1))-2**31,ea={},Zy=n=>{let e=[n[Bs],n[na]].join(Xy);if(ea.hasOwnProperty(e))return ea[e];{let t=Jy++;return ea[e]=t,t}},ev=(n,e,t)=>n.events.pipe(ro(r=>r instanceof Uu)).pipe(io(r=>{let a=n.parseUrl(n.url.replace(/(?:\().+(?:\))/g,T=>T.replace("://",":///"))).root.children[r.snapshot.outlet]?.toString()||"",l=n.routerState.root.children.map(T=>T).find(T=>T.outlet===r.snapshot.outlet);if(!l)return As(null);let h=l;for(;h.firstChild;)h=h.firstChild;let d=h.pathFromRoot.map(T=>T.routeConfig?.path).filter(T=>T).join("/")||"/",m={[od]:d,[Wy]:`/${a}`,[qy]:Yy,[Ky]:d,[na]:r.snapshot.outlet};e&&(m[Hy]=e.getTitle());let g=l.component;if(g){if(g===qu){let T=r.snapshot;for(;T.firstChild;)T=T.firstChild;g=T.component}}else g=r.snapshot.component;if(typeof g=="string")return As(no(Ct({},m),{[Bs]:g}));if(g){let T=t.resolveComponentFactory(g);return As(no(Ct({},m),{[Bs]:T.selector}))}return As(null)}),ro(r=>!!r),so(r=>Ct({[Gy]:r[Bs],[id]:Zy(r)},r)),Tu(r=>r[na]),wu(r=>r.pipe(Eu((o,a)=>JSON.stringify(o)===JSON.stringify(a)),Su(void 0),Iu(),so(([o,a])=>o?Ct({[$y]:o[Bs],[zy]:o[od],[jy]:o[id]},a):a)))),ud=(()=>{class n{disposable;constructor(t,s,r,o,a,l){V("angularfire",fe.full,"screen-tracking"),cd().then(()=>{let h=l.get(_n);!t||!h||o.runOutsideAngular(()=>{this.disposable=ev(t,s,r).pipe(io(d=>D(this,null,function*(){return a&&(yield a.initialized),Uy(h,Qy,d)}))).subscribe()})})}ngOnDestroy(){this.disposable&&this.disposable.unsubscribe()}static \u0275fac=function(s){return new(s||n)(Ce(Vn,8),Ce(Lu,8),Ce(Cu),Ce(re),Ce(sa,8),Ce(ue))};static \u0275prov=Rt({token:n,factory:n.\u0275fac})}return n})(),ra=new me("angularfire2.analytics-instances");function tv(n,e,t){if(!Mn(t))return null;let s=we(ad,n,e);return s&&new _n(s)}function nv(n){return(e,t,s)=>{if(!Mn(s))return null;let r=e.runOutsideAngular(()=>n(t));return new _n(r)}}var sv={provide:ta,deps:[[new $,ra]]},rv={provide:_n,useFactory:tv,deps:[[new $,ra],Ie,nt]};function hd(n,...e){return V("angularfire",fe.full,"analytics"),ge([rv,sv,{provide:ra,useFactory:nv(n),multi:!0,deps:[re,ue,nt,Te,Se,...e]}])}var dd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},fd={};var ei,pd;(function(){var n;function e(w,p){function y(){}y.prototype=p.prototype,w.D=p.prototype,w.prototype=new y,w.prototype.constructor=w,w.C=function(v,E,S){for(var _=Array(arguments.length-2),et=2;et<arguments.length;et++)_[et-2]=arguments[et];return p.prototype[E].apply(v,_)}}function t(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(s,t),s.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(w,p,y){y||(y=0);var v=Array(16);if(typeof p=="string")for(var E=0;16>E;++E)v[E]=p.charCodeAt(y++)|p.charCodeAt(y++)<<8|p.charCodeAt(y++)<<16|p.charCodeAt(y++)<<24;else for(E=0;16>E;++E)v[E]=p[y++]|p[y++]<<8|p[y++]<<16|p[y++]<<24;p=w.g[0],y=w.g[1],E=w.g[2];var S=w.g[3],_=p+(S^y&(E^S))+v[0]+3614090360&4294967295;p=y+(_<<7&4294967295|_>>>25),_=S+(E^p&(y^E))+v[1]+3905402710&4294967295,S=p+(_<<12&4294967295|_>>>20),_=E+(y^S&(p^y))+v[2]+606105819&4294967295,E=S+(_<<17&4294967295|_>>>15),_=y+(p^E&(S^p))+v[3]+3250441966&4294967295,y=E+(_<<22&4294967295|_>>>10),_=p+(S^y&(E^S))+v[4]+4118548399&4294967295,p=y+(_<<7&4294967295|_>>>25),_=S+(E^p&(y^E))+v[5]+1200080426&4294967295,S=p+(_<<12&4294967295|_>>>20),_=E+(y^S&(p^y))+v[6]+2821735955&4294967295,E=S+(_<<17&4294967295|_>>>15),_=y+(p^E&(S^p))+v[7]+4249261313&4294967295,y=E+(_<<22&4294967295|_>>>10),_=p+(S^y&(E^S))+v[8]+1770035416&4294967295,p=y+(_<<7&4294967295|_>>>25),_=S+(E^p&(y^E))+v[9]+2336552879&4294967295,S=p+(_<<12&4294967295|_>>>20),_=E+(y^S&(p^y))+v[10]+4294925233&4294967295,E=S+(_<<17&4294967295|_>>>15),_=y+(p^E&(S^p))+v[11]+2304563134&4294967295,y=E+(_<<22&4294967295|_>>>10),_=p+(S^y&(E^S))+v[12]+1804603682&4294967295,p=y+(_<<7&4294967295|_>>>25),_=S+(E^p&(y^E))+v[13]+4254626195&4294967295,S=p+(_<<12&4294967295|_>>>20),_=E+(y^S&(p^y))+v[14]+2792965006&4294967295,E=S+(_<<17&4294967295|_>>>15),_=y+(p^E&(S^p))+v[15]+1236535329&4294967295,y=E+(_<<22&4294967295|_>>>10),_=p+(E^S&(y^E))+v[1]+4129170786&4294967295,p=y+(_<<5&4294967295|_>>>27),_=S+(y^E&(p^y))+v[6]+3225465664&4294967295,S=p+(_<<9&4294967295|_>>>23),_=E+(p^y&(S^p))+v[11]+643717713&4294967295,E=S+(_<<14&4294967295|_>>>18),_=y+(S^p&(E^S))+v[0]+3921069994&4294967295,y=E+(_<<20&4294967295|_>>>12),_=p+(E^S&(y^E))+v[5]+3593408605&4294967295,p=y+(_<<5&4294967295|_>>>27),_=S+(y^E&(p^y))+v[10]+38016083&4294967295,S=p+(_<<9&4294967295|_>>>23),_=E+(p^y&(S^p))+v[15]+3634488961&4294967295,E=S+(_<<14&4294967295|_>>>18),_=y+(S^p&(E^S))+v[4]+3889429448&4294967295,y=E+(_<<20&4294967295|_>>>12),_=p+(E^S&(y^E))+v[9]+568446438&4294967295,p=y+(_<<5&4294967295|_>>>27),_=S+(y^E&(p^y))+v[14]+3275163606&4294967295,S=p+(_<<9&4294967295|_>>>23),_=E+(p^y&(S^p))+v[3]+4107603335&4294967295,E=S+(_<<14&4294967295|_>>>18),_=y+(S^p&(E^S))+v[8]+1163531501&4294967295,y=E+(_<<20&4294967295|_>>>12),_=p+(E^S&(y^E))+v[13]+2850285829&4294967295,p=y+(_<<5&4294967295|_>>>27),_=S+(y^E&(p^y))+v[2]+4243563512&4294967295,S=p+(_<<9&4294967295|_>>>23),_=E+(p^y&(S^p))+v[7]+1735328473&4294967295,E=S+(_<<14&4294967295|_>>>18),_=y+(S^p&(E^S))+v[12]+2368359562&4294967295,y=E+(_<<20&4294967295|_>>>12),_=p+(y^E^S)+v[5]+4294588738&4294967295,p=y+(_<<4&4294967295|_>>>28),_=S+(p^y^E)+v[8]+2272392833&4294967295,S=p+(_<<11&4294967295|_>>>21),_=E+(S^p^y)+v[11]+1839030562&4294967295,E=S+(_<<16&4294967295|_>>>16),_=y+(E^S^p)+v[14]+4259657740&4294967295,y=E+(_<<23&4294967295|_>>>9),_=p+(y^E^S)+v[1]+2763975236&4294967295,p=y+(_<<4&4294967295|_>>>28),_=S+(p^y^E)+v[4]+1272893353&4294967295,S=p+(_<<11&4294967295|_>>>21),_=E+(S^p^y)+v[7]+4139469664&4294967295,E=S+(_<<16&4294967295|_>>>16),_=y+(E^S^p)+v[10]+3200236656&4294967295,y=E+(_<<23&4294967295|_>>>9),_=p+(y^E^S)+v[13]+681279174&4294967295,p=y+(_<<4&4294967295|_>>>28),_=S+(p^y^E)+v[0]+3936430074&4294967295,S=p+(_<<11&4294967295|_>>>21),_=E+(S^p^y)+v[3]+3572445317&4294967295,E=S+(_<<16&4294967295|_>>>16),_=y+(E^S^p)+v[6]+76029189&4294967295,y=E+(_<<23&4294967295|_>>>9),_=p+(y^E^S)+v[9]+3654602809&4294967295,p=y+(_<<4&4294967295|_>>>28),_=S+(p^y^E)+v[12]+3873151461&4294967295,S=p+(_<<11&4294967295|_>>>21),_=E+(S^p^y)+v[15]+530742520&4294967295,E=S+(_<<16&4294967295|_>>>16),_=y+(E^S^p)+v[2]+3299628645&4294967295,y=E+(_<<23&4294967295|_>>>9),_=p+(E^(y|~S))+v[0]+4096336452&4294967295,p=y+(_<<6&4294967295|_>>>26),_=S+(y^(p|~E))+v[7]+1126891415&4294967295,S=p+(_<<10&4294967295|_>>>22),_=E+(p^(S|~y))+v[14]+2878612391&4294967295,E=S+(_<<15&4294967295|_>>>17),_=y+(S^(E|~p))+v[5]+4237533241&4294967295,y=E+(_<<21&4294967295|_>>>11),_=p+(E^(y|~S))+v[12]+1700485571&4294967295,p=y+(_<<6&4294967295|_>>>26),_=S+(y^(p|~E))+v[3]+2399980690&4294967295,S=p+(_<<10&4294967295|_>>>22),_=E+(p^(S|~y))+v[10]+4293915773&4294967295,E=S+(_<<15&4294967295|_>>>17),_=y+(S^(E|~p))+v[1]+2240044497&4294967295,y=E+(_<<21&4294967295|_>>>11),_=p+(E^(y|~S))+v[8]+1873313359&4294967295,p=y+(_<<6&4294967295|_>>>26),_=S+(y^(p|~E))+v[15]+4264355552&4294967295,S=p+(_<<10&4294967295|_>>>22),_=E+(p^(S|~y))+v[6]+2734768916&4294967295,E=S+(_<<15&4294967295|_>>>17),_=y+(S^(E|~p))+v[13]+1309151649&4294967295,y=E+(_<<21&4294967295|_>>>11),_=p+(E^(y|~S))+v[4]+4149444226&4294967295,p=y+(_<<6&4294967295|_>>>26),_=S+(y^(p|~E))+v[11]+3174756917&4294967295,S=p+(_<<10&4294967295|_>>>22),_=E+(p^(S|~y))+v[2]+718787259&4294967295,E=S+(_<<15&4294967295|_>>>17),_=y+(S^(E|~p))+v[9]+3951481745&4294967295,w.g[0]=w.g[0]+p&4294967295,w.g[1]=w.g[1]+(E+(_<<21&4294967295|_>>>11))&4294967295,w.g[2]=w.g[2]+E&4294967295,w.g[3]=w.g[3]+S&4294967295}s.prototype.u=function(w,p){p===void 0&&(p=w.length);for(var y=p-this.blockSize,v=this.B,E=this.h,S=0;S<p;){if(E==0)for(;S<=y;)r(this,w,S),S+=this.blockSize;if(typeof w=="string"){for(;S<p;)if(v[E++]=w.charCodeAt(S++),E==this.blockSize){r(this,v),E=0;break}}else for(;S<p;)if(v[E++]=w[S++],E==this.blockSize){r(this,v),E=0;break}}this.h=E,this.o+=p},s.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var p=1;p<w.length-8;++p)w[p]=0;var y=8*this.o;for(p=w.length-8;p<w.length;++p)w[p]=y&255,y/=256;for(this.u(w),w=Array(16),p=y=0;4>p;++p)for(var v=0;32>v;v+=8)w[y++]=this.g[p]>>>v&255;return w};function o(w,p){var y=l;return Object.prototype.hasOwnProperty.call(y,w)?y[w]:y[w]=p(w)}function a(w,p){this.h=p;for(var y=[],v=!0,E=w.length-1;0<=E;E--){var S=w[E]|0;v&&S==p||(y[E]=S,v=!1)}this.g=y}var l={};function h(w){return-128<=w&&128>w?o(w,function(p){return new a([p|0],0>p?-1:0)}):new a([w|0],0>w?-1:0)}function d(w){if(isNaN(w)||!isFinite(w))return g;if(0>w)return P(d(-w));for(var p=[],y=1,v=0;w>=y;v++)p[v]=w/y|0,y*=4294967296;return new a(p,0)}function m(w,p){if(w.length==0)throw Error("number format error: empty string");if(p=p||10,2>p||36<p)throw Error("radix out of range: "+p);if(w.charAt(0)=="-")return P(m(w.substring(1),p));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var y=d(Math.pow(p,8)),v=g,E=0;E<w.length;E+=8){var S=Math.min(8,w.length-E),_=parseInt(w.substring(E,E+S),p);8>S?(S=d(Math.pow(p,S)),v=v.j(S).add(d(_))):(v=v.j(y),v=v.add(d(_)))}return v}var g=h(0),T=h(1),C=h(16777216);n=a.prototype,n.m=function(){if(R(this))return-P(this).m();for(var w=0,p=1,y=0;y<this.g.length;y++){var v=this.i(y);w+=(0<=v?v:4294967296+v)*p,p*=4294967296}return w},n.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(A(this))return"0";if(R(this))return"-"+P(this).toString(w);for(var p=d(Math.pow(w,6)),y=this,v="";;){var E=L(y,p).g;y=F(y,E.j(p));var S=((0<y.g.length?y.g[0]:y.h)>>>0).toString(w);if(y=E,A(y))return S+v;for(;6>S.length;)S="0"+S;v=S+v}},n.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function A(w){if(w.h!=0)return!1;for(var p=0;p<w.g.length;p++)if(w.g[p]!=0)return!1;return!0}function R(w){return w.h==-1}n.l=function(w){return w=F(this,w),R(w)?-1:A(w)?0:1};function P(w){for(var p=w.g.length,y=[],v=0;v<p;v++)y[v]=~w.g[v];return new a(y,~w.h).add(T)}n.abs=function(){return R(this)?P(this):this},n.add=function(w){for(var p=Math.max(this.g.length,w.g.length),y=[],v=0,E=0;E<=p;E++){var S=v+(this.i(E)&65535)+(w.i(E)&65535),_=(S>>>16)+(this.i(E)>>>16)+(w.i(E)>>>16);v=_>>>16,S&=65535,_&=65535,y[E]=_<<16|S}return new a(y,y[y.length-1]&-2147483648?-1:0)};function F(w,p){return w.add(P(p))}n.j=function(w){if(A(this)||A(w))return g;if(R(this))return R(w)?P(this).j(P(w)):P(P(this).j(w));if(R(w))return P(this.j(P(w)));if(0>this.l(C)&&0>w.l(C))return d(this.m()*w.m());for(var p=this.g.length+w.g.length,y=[],v=0;v<2*p;v++)y[v]=0;for(v=0;v<this.g.length;v++)for(var E=0;E<w.g.length;E++){var S=this.i(v)>>>16,_=this.i(v)&65535,et=w.i(E)>>>16,Vt=w.i(E)&65535;y[2*v+2*E]+=_*Vt,U(y,2*v+2*E),y[2*v+2*E+1]+=S*Vt,U(y,2*v+2*E+1),y[2*v+2*E+1]+=_*et,U(y,2*v+2*E+1),y[2*v+2*E+2]+=S*et,U(y,2*v+2*E+2)}for(v=0;v<p;v++)y[v]=y[2*v+1]<<16|y[2*v];for(v=p;v<2*p;v++)y[v]=0;return new a(y,0)};function U(w,p){for(;(w[p]&65535)!=w[p];)w[p+1]+=w[p]>>>16,w[p]&=65535,p++}function B(w,p){this.g=w,this.h=p}function L(w,p){if(A(p))throw Error("division by zero");if(A(w))return new B(g,g);if(R(w))return p=L(P(w),p),new B(P(p.g),P(p.h));if(R(p))return p=L(w,P(p)),new B(P(p.g),p.h);if(30<w.g.length){if(R(w)||R(p))throw Error("slowDivide_ only works with positive integers.");for(var y=T,v=p;0>=v.l(w);)y=ke(y),v=ke(v);var E=Z(y,1),S=Z(v,1);for(v=Z(v,2),y=Z(y,2);!A(v);){var _=S.add(v);0>=_.l(w)&&(E=E.add(y),S=_),v=Z(v,1),y=Z(y,1)}return p=F(w,E.j(p)),new B(E,p)}for(E=g;0<=w.l(p);){for(y=Math.max(1,Math.floor(w.m()/p.m())),v=Math.ceil(Math.log(y)/Math.LN2),v=48>=v?1:Math.pow(2,v-48),S=d(y),_=S.j(p);R(_)||0<_.l(w);)y-=v,S=d(y),_=S.j(p);A(S)&&(S=T),E=E.add(S),w=F(w,_)}return new B(E,w)}n.A=function(w){return L(this,w).h},n.and=function(w){for(var p=Math.max(this.g.length,w.g.length),y=[],v=0;v<p;v++)y[v]=this.i(v)&w.i(v);return new a(y,this.h&w.h)},n.or=function(w){for(var p=Math.max(this.g.length,w.g.length),y=[],v=0;v<p;v++)y[v]=this.i(v)|w.i(v);return new a(y,this.h|w.h)},n.xor=function(w){for(var p=Math.max(this.g.length,w.g.length),y=[],v=0;v<p;v++)y[v]=this.i(v)^w.i(v);return new a(y,this.h^w.h)};function ke(w){for(var p=w.g.length+1,y=[],v=0;v<p;v++)y[v]=w.i(v)<<1|w.i(v-1)>>>31;return new a(y,w.h)}function Z(w,p){var y=p>>5;p%=32;for(var v=w.g.length-y,E=[],S=0;S<v;S++)E[S]=0<p?w.i(S+y)>>>p|w.i(S+y+1)<<32-p:w.i(S+y);return new a(E,w.h)}s.prototype.digest=s.prototype.v,s.prototype.reset=s.prototype.s,s.prototype.update=s.prototype.u,pd=fd.Md5=s,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=m,ei=fd.Integer=a}).apply(typeof dd<"u"?dd:typeof self<"u"?self:typeof window<"u"?window:{});var ti=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},kt={};var md,iv,gd,_d,yd,vd,wd,Ed,Td;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(i,c,u){return i==Array.prototype||i==Object.prototype||(i[c]=u.value),i};function t(i){i=[typeof globalThis=="object"&&globalThis,i,typeof window=="object"&&window,typeof self=="object"&&self,typeof ti=="object"&&ti];for(var c=0;c<i.length;++c){var u=i[c];if(u&&u.Math==Math)return u}throw Error("Cannot find global object")}var s=t(this);function r(i,c){if(c)e:{var u=s;i=i.split(".");for(var f=0;f<i.length-1;f++){var I=i[f];if(!(I in u))break e;u=u[I]}i=i[i.length-1],f=u[i],c=c(f),c!=f&&c!=null&&e(u,i,{configurable:!0,writable:!0,value:c})}}function o(i,c){i instanceof String&&(i+="");var u=0,f=!1,I={next:function(){if(!f&&u<i.length){var b=u++;return{value:c(b,i[b]),done:!1}}return f=!0,{done:!0,value:void 0}}};return I[Symbol.iterator]=function(){return I},I}r("Array.prototype.values",function(i){return i||function(){return o(this,function(c,u){return u})}});var a=a||{},l=this||self;function h(i){var c=typeof i;return c=c!="object"?c:i?Array.isArray(i)?"array":c:"null",c=="array"||c=="object"&&typeof i.length=="number"}function d(i){var c=typeof i;return c=="object"&&i!=null||c=="function"}function m(i,c,u){return i.call.apply(i.bind,arguments)}function g(i,c,u){if(!i)throw Error();if(2<arguments.length){var f=Array.prototype.slice.call(arguments,2);return function(){var I=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(I,f),i.apply(c,I)}}return function(){return i.apply(c,arguments)}}function T(i,c,u){return T=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?m:g,T.apply(null,arguments)}function C(i,c){var u=Array.prototype.slice.call(arguments,1);return function(){var f=u.slice();return f.push.apply(f,arguments),i.apply(this,f)}}function A(i,c){function u(){}u.prototype=c.prototype,i.aa=c.prototype,i.prototype=new u,i.prototype.constructor=i,i.Qb=function(f,I,b){for(var N=Array(arguments.length-2),X=2;X<arguments.length;X++)N[X-2]=arguments[X];return c.prototype[I].apply(f,N)}}function R(i){let c=i.length;if(0<c){let u=Array(c);for(let f=0;f<c;f++)u[f]=i[f];return u}return[]}function P(i,c){for(let u=1;u<arguments.length;u++){let f=arguments[u];if(h(f)){let I=i.length||0,b=f.length||0;i.length=I+b;for(let N=0;N<b;N++)i[I+N]=f[N]}else i.push(f)}}class F{constructor(c,u){this.i=c,this.j=u,this.h=0,this.g=null}get(){let c;return 0<this.h?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function U(i){return/^[\s\xa0]*$/.test(i)}function B(){var i=l.navigator;return i&&(i=i.userAgent)?i:""}function L(i){return L[" "](i),i}L[" "]=function(){};var ke=B().indexOf("Gecko")!=-1&&!(B().toLowerCase().indexOf("webkit")!=-1&&B().indexOf("Edge")==-1)&&!(B().indexOf("Trident")!=-1||B().indexOf("MSIE")!=-1)&&B().indexOf("Edge")==-1;function Z(i,c,u){for(let f in i)c.call(u,i[f],f,i)}function w(i,c){for(let u in i)c.call(void 0,i[u],u,i)}function p(i){let c={};for(let u in i)c[u]=i[u];return c}let y="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function v(i,c){let u,f;for(let I=1;I<arguments.length;I++){f=arguments[I];for(u in f)i[u]=f[u];for(let b=0;b<y.length;b++)u=y[b],Object.prototype.hasOwnProperty.call(f,u)&&(i[u]=f[u])}}function E(i){var c=1;i=i.split(":");let u=[];for(;0<c&&i.length;)u.push(i.shift()),c--;return i.length&&u.push(i.join(":")),u}function S(i){l.setTimeout(()=>{throw i},0)}function _(){var i=q;let c=null;return i.g&&(c=i.g,i.g=i.g.next,i.g||(i.h=null),c.next=null),c}class et{constructor(){this.h=this.g=null}add(c,u){let f=Vt.get();f.set(c,u),this.h?this.h.next=f:this.g=f,this.h=f}}var Vt=new F(()=>new x,i=>i.reset());class x{constructor(){this.next=this.g=this.h=null}set(c,u){this.h=c,this.g=u,this.next=null}reset(){this.next=this.g=this.h=null}}let O,M=!1,q=new et,ce=()=>{let i=l.Promise.resolve(void 0);O=()=>{i.then(tt)}};var tt=()=>{for(var i;i=_();){try{i.h.call(i.g)}catch(u){S(u)}var c=Vt;c.j(i),100>c.h&&(c.h++,i.next=c.g,c.g=i)}M=!1};function oe(){this.s=this.s,this.C=this.C}oe.prototype.s=!1,oe.prototype.ma=function(){this.s||(this.s=!0,this.N())},oe.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ee(i,c){this.type=i,this.g=this.target=c,this.defaultPrevented=!1}ee.prototype.h=function(){this.defaultPrevented=!0};var te=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var i=!1,c=Object.defineProperty({},"passive",{get:function(){i=!0}});try{let u=()=>{};l.addEventListener("test",u,c),l.removeEventListener("test",u,c)}catch{}return i}();function Lt(i,c){if(ee.call(this,i?i.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,i){var u=this.type=i.type,f=i.changedTouches&&i.changedTouches.length?i.changedTouches[0]:null;if(this.target=i.target||i.srcElement,this.g=c,c=i.relatedTarget){if(ke){e:{try{L(c.nodeName);var I=!0;break e}catch{}I=!1}I||(c=null)}}else u=="mouseover"?c=i.fromElement:u=="mouseout"&&(c=i.toElement);this.relatedTarget=c,f?(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0):(this.clientX=i.clientX!==void 0?i.clientX:i.pageX,this.clientY=i.clientY!==void 0?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0),this.button=i.button,this.key=i.key||"",this.ctrlKey=i.ctrlKey,this.altKey=i.altKey,this.shiftKey=i.shiftKey,this.metaKey=i.metaKey,this.pointerId=i.pointerId||0,this.pointerType=typeof i.pointerType=="string"?i.pointerType:ki[i.pointerType]||"",this.state=i.state,this.i=i,i.defaultPrevented&&Lt.aa.h.call(this)}}A(Lt,ee);var ki={2:"touch",3:"pen",4:"mouse"};Lt.prototype.h=function(){Lt.aa.h.call(this);var i=this.i;i.preventDefault?i.preventDefault():i.returnValue=!1};var ae="closure_listenable_"+(1e6*Math.random()|0),It=0;function Ge(i,c,u,f,I){this.listener=i,this.proxy=null,this.src=c,this.type=u,this.capture=!!f,this.ha=I,this.key=++It,this.da=this.fa=!1}function St(i){i.da=!0,i.listener=null,i.proxy=null,i.src=null,i.ha=null}function Ut(i){this.src=i,this.g={},this.h=0}Ut.prototype.add=function(i,c,u,f,I){var b=i.toString();i=this.g[b],i||(i=this.g[b]=[],this.h++);var N=xi(i,c,f,I);return-1<N?(c=i[N],u||(c.fa=!1)):(c=new Ge(c,this.src,b,!!f,I),c.fa=u,i.push(c)),c};function Di(i,c){var u=c.type;if(u in i.g){var f=i.g[u],I=Array.prototype.indexOf.call(f,c,void 0),b;(b=0<=I)&&Array.prototype.splice.call(f,I,1),b&&(St(c),i.g[u].length==0&&(delete i.g[u],i.h--))}}function xi(i,c,u,f){for(var I=0;I<i.length;++I){var b=i[I];if(!b.da&&b.listener==c&&b.capture==!!u&&b.ha==f)return I}return-1}var Oi="closure_lm_"+(1e6*Math.random()|0),Mi={};function vc(i,c,u,f,I){if(f&&f.once)return Ec(i,c,u,f,I);if(Array.isArray(c)){for(var b=0;b<c.length;b++)vc(i,c[b],u,f,I);return null}return u=Ui(u),i&&i[ae]?i.K(c,u,d(f)?!!f.capture:!!f,I):wc(i,c,u,!1,f,I)}function wc(i,c,u,f,I,b){if(!c)throw Error("Invalid event type");var N=d(I)?!!I.capture:!!I,X=Vi(i);if(X||(i[Oi]=X=new Ut(i)),u=X.add(c,u,f,N,b),u.proxy)return u;if(f=Jm(),u.proxy=f,f.src=i,f.listener=u,i.addEventListener)te||(I=N),I===void 0&&(I=!1),i.addEventListener(c.toString(),f,I);else if(i.attachEvent)i.attachEvent(Ic(c.toString()),f);else if(i.addListener&&i.removeListener)i.addListener(f);else throw Error("addEventListener and attachEvent are unavailable.");return u}function Jm(){function i(u){return c.call(i.src,i.listener,u)}let c=Zm;return i}function Ec(i,c,u,f,I){if(Array.isArray(c)){for(var b=0;b<c.length;b++)Ec(i,c[b],u,f,I);return null}return u=Ui(u),i&&i[ae]?i.L(c,u,d(f)?!!f.capture:!!f,I):wc(i,c,u,!0,f,I)}function Tc(i,c,u,f,I){if(Array.isArray(c))for(var b=0;b<c.length;b++)Tc(i,c[b],u,f,I);else f=d(f)?!!f.capture:!!f,u=Ui(u),i&&i[ae]?(i=i.i,c=String(c).toString(),c in i.g&&(b=i.g[c],u=xi(b,u,f,I),-1<u&&(St(b[u]),Array.prototype.splice.call(b,u,1),b.length==0&&(delete i.g[c],i.h--)))):i&&(i=Vi(i))&&(c=i.g[c.toString()],i=-1,c&&(i=xi(c,u,f,I)),(u=-1<i?c[i]:null)&&Fi(u))}function Fi(i){if(typeof i!="number"&&i&&!i.da){var c=i.src;if(c&&c[ae])Di(c.i,i);else{var u=i.type,f=i.proxy;c.removeEventListener?c.removeEventListener(u,f,i.capture):c.detachEvent?c.detachEvent(Ic(u),f):c.addListener&&c.removeListener&&c.removeListener(f),(u=Vi(c))?(Di(u,i),u.h==0&&(u.src=null,c[Oi]=null)):St(i)}}}function Ic(i){return i in Mi?Mi[i]:Mi[i]="on"+i}function Zm(i,c){if(i.da)i=!0;else{c=new Lt(c,this);var u=i.listener,f=i.ha||i.src;i.fa&&Fi(i),i=u.call(f,c)}return i}function Vi(i){return i=i[Oi],i instanceof Ut?i:null}var Li="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ui(i){return typeof i=="function"?i:(i[Li]||(i[Li]=function(c){return i.handleEvent(c)}),i[Li])}function De(){oe.call(this),this.i=new Ut(this),this.M=this,this.F=null}A(De,oe),De.prototype[ae]=!0,De.prototype.removeEventListener=function(i,c,u,f){Tc(this,i,c,u,f)};function Be(i,c){var u,f=i.F;if(f)for(u=[];f;f=f.F)u.push(f);if(i=i.M,f=c.type||c,typeof c=="string")c=new ee(c,i);else if(c instanceof ee)c.target=c.target||i;else{var I=c;c=new ee(f,i),v(c,I)}if(I=!0,u)for(var b=u.length-1;0<=b;b--){var N=c.g=u[b];I=mr(N,f,!0,c)&&I}if(N=c.g=i,I=mr(N,f,!0,c)&&I,I=mr(N,f,!1,c)&&I,u)for(b=0;b<u.length;b++)N=c.g=u[b],I=mr(N,f,!1,c)&&I}De.prototype.N=function(){if(De.aa.N.call(this),this.i){var i=this.i,c;for(c in i.g){for(var u=i.g[c],f=0;f<u.length;f++)St(u[f]);delete i.g[c],i.h--}}this.F=null},De.prototype.K=function(i,c,u,f){return this.i.add(String(i),c,!1,u,f)},De.prototype.L=function(i,c,u,f){return this.i.add(String(i),c,!0,u,f)};function mr(i,c,u,f){if(c=i.i.g[String(c)],!c)return!0;c=c.concat();for(var I=!0,b=0;b<c.length;++b){var N=c[b];if(N&&!N.da&&N.capture==u){var X=N.listener,Ae=N.ha||N.src;N.fa&&Di(i.i,N),I=X.call(Ae,f)!==!1&&I}}return I&&!f.defaultPrevented}function Sc(i,c,u){if(typeof i=="function")u&&(i=T(i,u));else if(i&&typeof i.handleEvent=="function")i=T(i.handleEvent,i);else throw Error("Invalid listener argument");return 2147483647<Number(c)?-1:l.setTimeout(i,c||0)}function bc(i){i.g=Sc(()=>{i.g=null,i.i&&(i.i=!1,bc(i))},i.l);let c=i.h;i.h=null,i.m.apply(null,c)}class eg extends oe{constructor(c,u){super(),this.m=c,this.l=u,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:bc(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ds(i){oe.call(this),this.h=i,this.g={}}A(ds,oe);var Ac=[];function Cc(i){Z(i.g,function(c,u){this.g.hasOwnProperty(u)&&Fi(c)},i),i.g={}}ds.prototype.N=function(){ds.aa.N.call(this),Cc(this)},ds.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Bi=l.JSON.stringify,tg=l.JSON.parse,ng=class{stringify(i){return l.JSON.stringify(i,void 0)}parse(i){return l.JSON.parse(i,void 0)}};function qi(){}qi.prototype.h=null;function Rc(i){return i.h||(i.h=i.i())}function Pc(){}var fs={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function $i(){ee.call(this,"d")}A($i,ee);function ji(){ee.call(this,"c")}A(ji,ee);var nn={},Nc=null;function gr(){return Nc=Nc||new De}nn.La="serverreachability";function kc(i){ee.call(this,nn.La,i)}A(kc,ee);function ps(i){let c=gr();Be(c,new kc(c))}nn.STAT_EVENT="statevent";function Dc(i,c){ee.call(this,nn.STAT_EVENT,i),this.stat=c}A(Dc,ee);function qe(i){let c=gr();Be(c,new Dc(c,i))}nn.Ma="timingevent";function xc(i,c){ee.call(this,nn.Ma,i),this.size=c}A(xc,ee);function ms(i,c){if(typeof i!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){i()},c)}function gs(){this.g=!0}gs.prototype.xa=function(){this.g=!1};function sg(i,c,u,f,I,b){i.info(function(){if(i.g)if(b)for(var N="",X=b.split("&"),Ae=0;Ae<X.length;Ae++){var Q=X[Ae].split("=");if(1<Q.length){var xe=Q[0];Q=Q[1];var Oe=xe.split("_");N=2<=Oe.length&&Oe[1]=="type"?N+(xe+"="+Q+"&"):N+(xe+"=redacted&")}}else N=null;else N=b;return"XMLHTTP REQ ("+f+") [attempt "+I+"]: "+c+`
`+u+`
`+N})}function rg(i,c,u,f,I,b,N){i.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+I+"]: "+c+`
`+u+`
`+b+" "+N})}function Rn(i,c,u,f){i.info(function(){return"XMLHTTP TEXT ("+c+"): "+og(i,u)+(f?" "+f:"")})}function ig(i,c){i.info(function(){return"TIMEOUT: "+c})}gs.prototype.info=function(){};function og(i,c){if(!i.g)return c;if(!c)return null;try{var u=JSON.parse(c);if(u){for(i=0;i<u.length;i++)if(Array.isArray(u[i])){var f=u[i];if(!(2>f.length)){var I=f[1];if(Array.isArray(I)&&!(1>I.length)){var b=I[0];if(b!="noop"&&b!="stop"&&b!="close")for(var N=1;N<I.length;N++)I[N]=""}}}}return Bi(u)}catch{return c}}var _r={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Oc={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},zi;function yr(){}A(yr,qi),yr.prototype.g=function(){return new XMLHttpRequest},yr.prototype.i=function(){return{}},zi=new yr;function Bt(i,c,u,f){this.j=i,this.i=c,this.l=u,this.R=f||1,this.U=new ds(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Mc}function Mc(){this.i=null,this.g="",this.h=!1}var Fc={},Gi={};function Ki(i,c,u){i.L=1,i.v=Tr(bt(c)),i.m=u,i.P=!0,Vc(i,null)}function Vc(i,c){i.F=Date.now(),vr(i),i.A=bt(i.v);var u=i.A,f=i.R;Array.isArray(f)||(f=[String(f)]),Xc(u.i,"t",f),i.C=0,u=i.j.J,i.h=new Mc,i.g=mu(i.j,u?c:null,!i.m),0<i.O&&(i.M=new eg(T(i.Y,i,i.g),i.O)),c=i.U,u=i.g,f=i.ca;var I="readystatechange";Array.isArray(I)||(I&&(Ac[0]=I.toString()),I=Ac);for(var b=0;b<I.length;b++){var N=vc(u,I[b],f||c.handleEvent,!1,c.h||c);if(!N)break;c.g[N.key]=N}c=i.H?p(i.H):{},i.m?(i.u||(i.u="POST"),c["Content-Type"]="application/x-www-form-urlencoded",i.g.ea(i.A,i.u,i.m,c)):(i.u="GET",i.g.ea(i.A,i.u,null,c)),ps(),sg(i.i,i.u,i.A,i.l,i.R,i.m)}Bt.prototype.ca=function(i){i=i.target;let c=this.M;c&&At(i)==3?c.j():this.Y(i)},Bt.prototype.Y=function(i){try{if(i==this.g)e:{let Oe=At(this.g);var c=this.g.Ba();let kn=this.g.Z();if(!(3>Oe)&&(Oe!=3||this.g&&(this.h.h||this.g.oa()||ru(this.g)))){this.J||Oe!=4||c==7||(c==8||0>=kn?ps(3):ps(2)),Wi(this);var u=this.g.Z();this.X=u;t:if(Lc(this)){var f=ru(this.g);i="";var I=f.length,b=At(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){sn(this),_s(this);var N="";break t}this.h.i=new l.TextDecoder}for(c=0;c<I;c++)this.h.h=!0,i+=this.h.i.decode(f[c],{stream:!(b&&c==I-1)});f.length=0,this.h.g+=i,this.C=0,N=this.h.g}else N=this.g.oa();if(this.o=u==200,rg(this.i,this.u,this.A,this.l,this.R,Oe,u),this.o){if(this.T&&!this.K){t:{if(this.g){var X,Ae=this.g;if((X=Ae.g?Ae.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!U(X)){var Q=X;break t}}Q=null}if(u=Q)Rn(this.i,this.l,u,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Hi(this,u);else{this.o=!1,this.s=3,qe(12),sn(this),_s(this);break e}}if(this.P){u=!0;let at;for(;!this.J&&this.C<N.length;)if(at=ag(this,N),at==Gi){Oe==4&&(this.s=4,qe(14),u=!1),Rn(this.i,this.l,null,"[Incomplete Response]");break}else if(at==Fc){this.s=4,qe(15),Rn(this.i,this.l,N,"[Invalid Chunk]"),u=!1;break}else Rn(this.i,this.l,at,null),Hi(this,at);if(Lc(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Oe!=4||N.length!=0||this.h.h||(this.s=1,qe(16),u=!1),this.o=this.o&&u,!u)Rn(this.i,this.l,N,"[Invalid Chunked Response]"),sn(this),_s(this);else if(0<N.length&&!this.W){this.W=!0;var xe=this.j;xe.g==this&&xe.ba&&!xe.M&&(xe.j.info("Great, no buffering proxy detected. Bytes received: "+N.length),eo(xe),xe.M=!0,qe(11))}}else Rn(this.i,this.l,N,null),Hi(this,N);Oe==4&&sn(this),this.o&&!this.J&&(Oe==4?hu(this.j,this):(this.o=!1,vr(this)))}else Sg(this.g),u==400&&0<N.indexOf("Unknown SID")?(this.s=3,qe(12)):(this.s=0,qe(13)),sn(this),_s(this)}}}catch{}finally{}};function Lc(i){return i.g?i.u=="GET"&&i.L!=2&&i.j.Ca:!1}function ag(i,c){var u=i.C,f=c.indexOf(`
`,u);return f==-1?Gi:(u=Number(c.substring(u,f)),isNaN(u)?Fc:(f+=1,f+u>c.length?Gi:(c=c.slice(f,f+u),i.C=f+u,c)))}Bt.prototype.cancel=function(){this.J=!0,sn(this)};function vr(i){i.S=Date.now()+i.I,Uc(i,i.I)}function Uc(i,c){if(i.B!=null)throw Error("WatchDog timer not null");i.B=ms(T(i.ba,i),c)}function Wi(i){i.B&&(l.clearTimeout(i.B),i.B=null)}Bt.prototype.ba=function(){this.B=null;let i=Date.now();0<=i-this.S?(ig(this.i,this.A),this.L!=2&&(ps(),qe(17)),sn(this),this.s=2,_s(this)):Uc(this,this.S-i)};function _s(i){i.j.G==0||i.J||hu(i.j,i)}function sn(i){Wi(i);var c=i.M;c&&typeof c.ma=="function"&&c.ma(),i.M=null,Cc(i.U),i.g&&(c=i.g,i.g=null,c.abort(),c.ma())}function Hi(i,c){try{var u=i.j;if(u.G!=0&&(u.g==i||Qi(u.h,i))){if(!i.K&&Qi(u.h,i)&&u.G==3){try{var f=u.Da.g.parse(c)}catch{f=null}if(Array.isArray(f)&&f.length==3){var I=f;if(I[0]==0){e:if(!u.u){if(u.g)if(u.g.F+3e3<i.F)Cr(u),br(u);else break e;Zi(u),qe(18)}}else u.za=I[1],0<u.za-u.T&&37500>I[2]&&u.F&&u.v==0&&!u.C&&(u.C=ms(T(u.Za,u),6e3));if(1>=$c(u.h)&&u.ca){try{u.ca()}catch{}u.ca=void 0}}else on(u,11)}else if((i.K||u.g==i)&&Cr(u),!U(c))for(I=u.Da.g.parse(c),c=0;c<I.length;c++){let Q=I[c];if(u.T=Q[0],Q=Q[1],u.G==2)if(Q[0]=="c"){u.K=Q[1],u.ia=Q[2];let xe=Q[3];xe!=null&&(u.la=xe,u.j.info("VER="+u.la));let Oe=Q[4];Oe!=null&&(u.Aa=Oe,u.j.info("SVER="+u.Aa));let kn=Q[5];kn!=null&&typeof kn=="number"&&0<kn&&(f=1.5*kn,u.L=f,u.j.info("backChannelRequestTimeoutMs_="+f)),f=u;let at=i.g;if(at){let Pr=at.g?at.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Pr){var b=f.h;b.g||Pr.indexOf("spdy")==-1&&Pr.indexOf("quic")==-1&&Pr.indexOf("h2")==-1||(b.j=b.l,b.g=new Set,b.h&&(Yi(b,b.h),b.h=null))}if(f.D){let to=at.g?at.g.getResponseHeader("X-HTTP-Session-Id"):null;to&&(f.ya=to,ne(f.I,f.D,to))}}u.G=3,u.l&&u.l.ua(),u.ba&&(u.R=Date.now()-i.F,u.j.info("Handshake RTT: "+u.R+"ms")),f=u;var N=i;if(f.qa=pu(f,f.J?f.ia:null,f.W),N.K){jc(f.h,N);var X=N,Ae=f.L;Ae&&(X.I=Ae),X.B&&(Wi(X),vr(X)),f.g=N}else cu(f);0<u.i.length&&Ar(u)}else Q[0]!="stop"&&Q[0]!="close"||on(u,7);else u.G==3&&(Q[0]=="stop"||Q[0]=="close"?Q[0]=="stop"?on(u,7):Ji(u):Q[0]!="noop"&&u.l&&u.l.ta(Q),u.v=0)}}ps(4)}catch{}}var lg=class{constructor(i,c){this.g=i,this.map=c}};function Bc(i){this.l=i||10,l.PerformanceNavigationTiming?(i=l.performance.getEntriesByType("navigation"),i=0<i.length&&(i[0].nextHopProtocol=="hq"||i[0].nextHopProtocol=="h2")):i=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=i?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function qc(i){return i.h?!0:i.g?i.g.size>=i.j:!1}function $c(i){return i.h?1:i.g?i.g.size:0}function Qi(i,c){return i.h?i.h==c:i.g?i.g.has(c):!1}function Yi(i,c){i.g?i.g.add(c):i.h=c}function jc(i,c){i.h&&i.h==c?i.h=null:i.g&&i.g.has(c)&&i.g.delete(c)}Bc.prototype.cancel=function(){if(this.i=zc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let i of this.g.values())i.cancel();this.g.clear()}};function zc(i){if(i.h!=null)return i.i.concat(i.h.D);if(i.g!=null&&i.g.size!==0){let c=i.i;for(let u of i.g.values())c=c.concat(u.D);return c}return R(i.i)}function cg(i){if(i.V&&typeof i.V=="function")return i.V();if(typeof Map<"u"&&i instanceof Map||typeof Set<"u"&&i instanceof Set)return Array.from(i.values());if(typeof i=="string")return i.split("");if(h(i)){for(var c=[],u=i.length,f=0;f<u;f++)c.push(i[f]);return c}c=[],u=0;for(f in i)c[u++]=i[f];return c}function ug(i){if(i.na&&typeof i.na=="function")return i.na();if(!i.V||typeof i.V!="function"){if(typeof Map<"u"&&i instanceof Map)return Array.from(i.keys());if(!(typeof Set<"u"&&i instanceof Set)){if(h(i)||typeof i=="string"){var c=[];i=i.length;for(var u=0;u<i;u++)c.push(u);return c}c=[],u=0;for(let f in i)c[u++]=f;return c}}}function Gc(i,c){if(i.forEach&&typeof i.forEach=="function")i.forEach(c,void 0);else if(h(i)||typeof i=="string")Array.prototype.forEach.call(i,c,void 0);else for(var u=ug(i),f=cg(i),I=f.length,b=0;b<I;b++)c.call(void 0,f[b],u&&u[b],i)}var Kc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function hg(i,c){if(i){i=i.split("&");for(var u=0;u<i.length;u++){var f=i[u].indexOf("="),I=null;if(0<=f){var b=i[u].substring(0,f);I=i[u].substring(f+1)}else b=i[u];c(b,I?decodeURIComponent(I.replace(/\+/g," ")):"")}}}function rn(i){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,i instanceof rn){this.h=i.h,wr(this,i.j),this.o=i.o,this.g=i.g,Er(this,i.s),this.l=i.l;var c=i.i,u=new ws;u.i=c.i,c.g&&(u.g=new Map(c.g),u.h=c.h),Wc(this,u),this.m=i.m}else i&&(c=String(i).match(Kc))?(this.h=!1,wr(this,c[1]||"",!0),this.o=ys(c[2]||""),this.g=ys(c[3]||"",!0),Er(this,c[4]),this.l=ys(c[5]||"",!0),Wc(this,c[6]||"",!0),this.m=ys(c[7]||"")):(this.h=!1,this.i=new ws(null,this.h))}rn.prototype.toString=function(){var i=[],c=this.j;c&&i.push(vs(c,Hc,!0),":");var u=this.g;return(u||c=="file")&&(i.push("//"),(c=this.o)&&i.push(vs(c,Hc,!0),"@"),i.push(encodeURIComponent(String(u)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u=this.s,u!=null&&i.push(":",String(u))),(u=this.l)&&(this.g&&u.charAt(0)!="/"&&i.push("/"),i.push(vs(u,u.charAt(0)=="/"?pg:fg,!0))),(u=this.i.toString())&&i.push("?",u),(u=this.m)&&i.push("#",vs(u,gg)),i.join("")};function bt(i){return new rn(i)}function wr(i,c,u){i.j=u?ys(c,!0):c,i.j&&(i.j=i.j.replace(/:$/,""))}function Er(i,c){if(c){if(c=Number(c),isNaN(c)||0>c)throw Error("Bad port number "+c);i.s=c}else i.s=null}function Wc(i,c,u){c instanceof ws?(i.i=c,_g(i.i,i.h)):(u||(c=vs(c,mg)),i.i=new ws(c,i.h))}function ne(i,c,u){i.i.set(c,u)}function Tr(i){return ne(i,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),i}function ys(i,c){return i?c?decodeURI(i.replace(/%25/g,"%2525")):decodeURIComponent(i):""}function vs(i,c,u){return typeof i=="string"?(i=encodeURI(i).replace(c,dg),u&&(i=i.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),i):null}function dg(i){return i=i.charCodeAt(0),"%"+(i>>4&15).toString(16)+(i&15).toString(16)}var Hc=/[#\/\?@]/g,fg=/[#\?:]/g,pg=/[#\?]/g,mg=/[#\?@]/g,gg=/#/g;function ws(i,c){this.h=this.g=null,this.i=i||null,this.j=!!c}function qt(i){i.g||(i.g=new Map,i.h=0,i.i&&hg(i.i,function(c,u){i.add(decodeURIComponent(c.replace(/\+/g," ")),u)}))}n=ws.prototype,n.add=function(i,c){qt(this),this.i=null,i=Pn(this,i);var u=this.g.get(i);return u||this.g.set(i,u=[]),u.push(c),this.h+=1,this};function Qc(i,c){qt(i),c=Pn(i,c),i.g.has(c)&&(i.i=null,i.h-=i.g.get(c).length,i.g.delete(c))}function Yc(i,c){return qt(i),c=Pn(i,c),i.g.has(c)}n.forEach=function(i,c){qt(this),this.g.forEach(function(u,f){u.forEach(function(I){i.call(c,I,f,this)},this)},this)},n.na=function(){qt(this);let i=Array.from(this.g.values()),c=Array.from(this.g.keys()),u=[];for(let f=0;f<c.length;f++){let I=i[f];for(let b=0;b<I.length;b++)u.push(c[f])}return u},n.V=function(i){qt(this);let c=[];if(typeof i=="string")Yc(this,i)&&(c=c.concat(this.g.get(Pn(this,i))));else{i=Array.from(this.g.values());for(let u=0;u<i.length;u++)c=c.concat(i[u])}return c},n.set=function(i,c){return qt(this),this.i=null,i=Pn(this,i),Yc(this,i)&&(this.h-=this.g.get(i).length),this.g.set(i,[c]),this.h+=1,this},n.get=function(i,c){return i?(i=this.V(i),0<i.length?String(i[0]):c):c};function Xc(i,c,u){Qc(i,c),0<u.length&&(i.i=null,i.g.set(Pn(i,c),R(u)),i.h+=u.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let i=[],c=Array.from(this.g.keys());for(var u=0;u<c.length;u++){var f=c[u];let b=encodeURIComponent(String(f)),N=this.V(f);for(f=0;f<N.length;f++){var I=b;N[f]!==""&&(I+="="+encodeURIComponent(String(N[f]))),i.push(I)}}return this.i=i.join("&")};function Pn(i,c){return c=String(c),i.j&&(c=c.toLowerCase()),c}function _g(i,c){c&&!i.j&&(qt(i),i.i=null,i.g.forEach(function(u,f){var I=f.toLowerCase();f!=I&&(Qc(this,f),Xc(this,I,u))},i)),i.j=c}function yg(i,c){let u=new gs;if(l.Image){let f=new Image;f.onload=C($t,u,"TestLoadImage: loaded",!0,c,f),f.onerror=C($t,u,"TestLoadImage: error",!1,c,f),f.onabort=C($t,u,"TestLoadImage: abort",!1,c,f),f.ontimeout=C($t,u,"TestLoadImage: timeout",!1,c,f),l.setTimeout(function(){f.ontimeout&&f.ontimeout()},1e4),f.src=i}else c(!1)}function vg(i,c){let u=new gs,f=new AbortController,I=setTimeout(()=>{f.abort(),$t(u,"TestPingServer: timeout",!1,c)},1e4);fetch(i,{signal:f.signal}).then(b=>{clearTimeout(I),b.ok?$t(u,"TestPingServer: ok",!0,c):$t(u,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(I),$t(u,"TestPingServer: error",!1,c)})}function $t(i,c,u,f,I){try{I&&(I.onload=null,I.onerror=null,I.onabort=null,I.ontimeout=null),f(u)}catch{}}function wg(){this.g=new ng}function Eg(i,c,u){let f=u||"";try{Gc(i,function(I,b){let N=I;d(I)&&(N=Bi(I)),c.push(f+b+"="+encodeURIComponent(N))})}catch(I){throw c.push(f+"type="+encodeURIComponent("_badmap")),I}}function Es(i){this.l=i.Ub||null,this.j=i.eb||!1}A(Es,qi),Es.prototype.g=function(){return new Ir(this.l,this.j)},Es.prototype.i=function(i){return function(){return i}}({});function Ir(i,c){De.call(this),this.D=i,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}A(Ir,De),n=Ir.prototype,n.open=function(i,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=i,this.A=c,this.readyState=1,Is(this)},n.send=function(i){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let c={headers:this.u,method:this.B,credentials:this.m,cache:void 0};i&&(c.body=i),(this.D||l).fetch(new Request(this.A,c)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ts(this)),this.readyState=0},n.Sa=function(i){if(this.g&&(this.l=i,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=i.headers,this.readyState=2,Is(this)),this.g&&(this.readyState=3,Is(this),this.g)))if(this.responseType==="arraybuffer")i.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in i){if(this.j=i.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Jc(this)}else i.text().then(this.Ra.bind(this),this.ga.bind(this))};function Jc(i){i.j.read().then(i.Pa.bind(i)).catch(i.ga.bind(i))}n.Pa=function(i){if(this.g){if(this.o&&i.value)this.response.push(i.value);else if(!this.o){var c=i.value?i.value:new Uint8Array(0);(c=this.v.decode(c,{stream:!i.done}))&&(this.response=this.responseText+=c)}i.done?Ts(this):Is(this),this.readyState==3&&Jc(this)}},n.Ra=function(i){this.g&&(this.response=this.responseText=i,Ts(this))},n.Qa=function(i){this.g&&(this.response=i,Ts(this))},n.ga=function(){this.g&&Ts(this)};function Ts(i){i.readyState=4,i.l=null,i.j=null,i.v=null,Is(i)}n.setRequestHeader=function(i,c){this.u.append(i,c)},n.getResponseHeader=function(i){return this.h&&this.h.get(i.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let i=[],c=this.h.entries();for(var u=c.next();!u.done;)u=u.value,i.push(u[0]+": "+u[1]),u=c.next();return i.join(`\r
`)};function Is(i){i.onreadystatechange&&i.onreadystatechange.call(i)}Object.defineProperty(Ir.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(i){this.m=i?"include":"same-origin"}});function Zc(i){let c="";return Z(i,function(u,f){c+=f,c+=":",c+=u,c+=`\r
`}),c}function Xi(i,c,u){e:{for(f in u){var f=!1;break e}f=!0}f||(u=Zc(u),typeof i=="string"?u!=null&&encodeURIComponent(String(u)):ne(i,c,u))}function le(i){De.call(this),this.headers=new Map,this.o=i||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}A(le,De);var Tg=/^https?$/i,Ig=["POST","PUT"];n=le.prototype,n.Ha=function(i){this.J=i},n.ea=function(i,c,u,f){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+i);c=c?c.toUpperCase():"GET",this.D=i,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():zi.g(),this.v=this.o?Rc(this.o):Rc(zi),this.g.onreadystatechange=T(this.Ea,this);try{this.B=!0,this.g.open(c,String(i),!0),this.B=!1}catch(b){eu(this,b);return}if(i=u||"",u=new Map(this.headers),f)if(Object.getPrototypeOf(f)===Object.prototype)for(var I in f)u.set(I,f[I]);else if(typeof f.keys=="function"&&typeof f.get=="function")for(let b of f.keys())u.set(b,f.get(b));else throw Error("Unknown input type for opt_headers: "+String(f));f=Array.from(u.keys()).find(b=>b.toLowerCase()=="content-type"),I=l.FormData&&i instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Ig,c,void 0))||f||I||u.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[b,N]of u)this.g.setRequestHeader(b,N);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{su(this),this.u=!0,this.g.send(i),this.u=!1}catch(b){eu(this,b)}};function eu(i,c){i.h=!1,i.g&&(i.j=!0,i.g.abort(),i.j=!1),i.l=c,i.m=5,tu(i),Sr(i)}function tu(i){i.A||(i.A=!0,Be(i,"complete"),Be(i,"error"))}n.abort=function(i){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=i||7,Be(this,"complete"),Be(this,"abort"),Sr(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Sr(this,!0)),le.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?nu(this):this.bb())},n.bb=function(){nu(this)};function nu(i){if(i.h&&typeof a<"u"&&(!i.v[1]||At(i)!=4||i.Z()!=2)){if(i.u&&At(i)==4)Sc(i.Ea,0,i);else if(Be(i,"readystatechange"),At(i)==4){i.h=!1;try{let N=i.Z();e:switch(N){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var u;if(!(u=c)){var f;if(f=N===0){var I=String(i.D).match(Kc)[1]||null;!I&&l.self&&l.self.location&&(I=l.self.location.protocol.slice(0,-1)),f=!Tg.test(I?I.toLowerCase():"")}u=f}if(u)Be(i,"complete"),Be(i,"success");else{i.m=6;try{var b=2<At(i)?i.g.statusText:""}catch{b=""}i.l=b+" ["+i.Z()+"]",tu(i)}}finally{Sr(i)}}}}function Sr(i,c){if(i.g){su(i);let u=i.g,f=i.v[0]?()=>{}:null;i.g=null,i.v=null,c||Be(i,"ready");try{u.onreadystatechange=f}catch{}}}function su(i){i.I&&(l.clearTimeout(i.I),i.I=null)}n.isActive=function(){return!!this.g};function At(i){return i.g?i.g.readyState:0}n.Z=function(){try{return 2<At(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(i){if(this.g){var c=this.g.responseText;return i&&c.indexOf(i)==0&&(c=c.substring(i.length)),tg(c)}};function ru(i){try{if(!i.g)return null;if("response"in i.g)return i.g.response;switch(i.H){case"":case"text":return i.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in i.g)return i.g.mozResponseArrayBuffer}return null}catch{return null}}function Sg(i){let c={};i=(i.g&&2<=At(i)&&i.g.getAllResponseHeaders()||"").split(`\r
`);for(let f=0;f<i.length;f++){if(U(i[f]))continue;var u=E(i[f]);let I=u[0];if(u=u[1],typeof u!="string")continue;u=u.trim();let b=c[I]||[];c[I]=b,b.push(u)}w(c,function(f){return f.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ss(i,c,u){return u&&u.internalChannelParams&&u.internalChannelParams[i]||c}function iu(i){this.Aa=0,this.i=[],this.j=new gs,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ss("failFast",!1,i),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ss("baseRetryDelayMs",5e3,i),this.cb=Ss("retryDelaySeedMs",1e4,i),this.Wa=Ss("forwardChannelMaxRetries",2,i),this.wa=Ss("forwardChannelRequestTimeoutMs",2e4,i),this.pa=i&&i.xmlHttpFactory||void 0,this.Xa=i&&i.Tb||void 0,this.Ca=i&&i.useFetchStreams||!1,this.L=void 0,this.J=i&&i.supportsCrossDomainXhr||!1,this.K="",this.h=new Bc(i&&i.concurrentRequestLimit),this.Da=new wg,this.P=i&&i.fastHandshake||!1,this.O=i&&i.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=i&&i.Rb||!1,i&&i.xa&&this.j.xa(),i&&i.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&i&&i.detectBufferingProxy||!1,this.ja=void 0,i&&i.longPollingTimeout&&0<i.longPollingTimeout&&(this.ja=i.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=iu.prototype,n.la=8,n.G=1,n.connect=function(i,c,u,f){qe(0),this.W=i,this.H=c||{},u&&f!==void 0&&(this.H.OSID=u,this.H.OAID=f),this.F=this.X,this.I=pu(this,null,this.W),Ar(this)};function Ji(i){if(ou(i),i.G==3){var c=i.U++,u=bt(i.I);if(ne(u,"SID",i.K),ne(u,"RID",c),ne(u,"TYPE","terminate"),bs(i,u),c=new Bt(i,i.j,c),c.L=2,c.v=Tr(bt(u)),u=!1,l.navigator&&l.navigator.sendBeacon)try{u=l.navigator.sendBeacon(c.v.toString(),"")}catch{}!u&&l.Image&&(new Image().src=c.v,u=!0),u||(c.g=mu(c.j,null),c.g.ea(c.v)),c.F=Date.now(),vr(c)}fu(i)}function br(i){i.g&&(eo(i),i.g.cancel(),i.g=null)}function ou(i){br(i),i.u&&(l.clearTimeout(i.u),i.u=null),Cr(i),i.h.cancel(),i.s&&(typeof i.s=="number"&&l.clearTimeout(i.s),i.s=null)}function Ar(i){if(!qc(i.h)&&!i.s){i.s=!0;var c=i.Ga;O||ce(),M||(O(),M=!0),q.add(c,i),i.B=0}}function bg(i,c){return $c(i.h)>=i.h.j-(i.s?1:0)?!1:i.s?(i.i=c.D.concat(i.i),!0):i.G==1||i.G==2||i.B>=(i.Va?0:i.Wa)?!1:(i.s=ms(T(i.Ga,i,c),du(i,i.B)),i.B++,!0)}n.Ga=function(i){if(this.s)if(this.s=null,this.G==1){if(!i){this.U=Math.floor(1e5*Math.random()),i=this.U++;let I=new Bt(this,this.j,i),b=this.o;if(this.S&&(b?(b=p(b),v(b,this.S)):b=this.S),this.m!==null||this.O||(I.H=b,b=null),this.P)e:{for(var c=0,u=0;u<this.i.length;u++){t:{var f=this.i[u];if("__data__"in f.map&&(f=f.map.__data__,typeof f=="string")){f=f.length;break t}f=void 0}if(f===void 0)break;if(c+=f,4096<c){c=u;break e}if(c===4096||u===this.i.length-1){c=u+1;break e}}c=1e3}else c=1e3;c=lu(this,I,c),u=bt(this.I),ne(u,"RID",i),ne(u,"CVER",22),this.D&&ne(u,"X-HTTP-Session-Id",this.D),bs(this,u),b&&(this.O?c="headers="+encodeURIComponent(String(Zc(b)))+"&"+c:this.m&&Xi(u,this.m,b)),Yi(this.h,I),this.Ua&&ne(u,"TYPE","init"),this.P?(ne(u,"$req",c),ne(u,"SID","null"),I.T=!0,Ki(I,u,null)):Ki(I,u,c),this.G=2}}else this.G==3&&(i?au(this,i):this.i.length==0||qc(this.h)||au(this))};function au(i,c){var u;c?u=c.l:u=i.U++;let f=bt(i.I);ne(f,"SID",i.K),ne(f,"RID",u),ne(f,"AID",i.T),bs(i,f),i.m&&i.o&&Xi(f,i.m,i.o),u=new Bt(i,i.j,u,i.B+1),i.m===null&&(u.H=i.o),c&&(i.i=c.D.concat(i.i)),c=lu(i,u,1e3),u.I=Math.round(.5*i.wa)+Math.round(.5*i.wa*Math.random()),Yi(i.h,u),Ki(u,f,c)}function bs(i,c){i.H&&Z(i.H,function(u,f){ne(c,f,u)}),i.l&&Gc({},function(u,f){ne(c,f,u)})}function lu(i,c,u){u=Math.min(i.i.length,u);var f=i.l?T(i.l.Na,i.l,i):null;e:{var I=i.i;let b=-1;for(;;){let N=["count="+u];b==-1?0<u?(b=I[0].g,N.push("ofs="+b)):b=0:N.push("ofs="+b);let X=!0;for(let Ae=0;Ae<u;Ae++){let Q=I[Ae].g,xe=I[Ae].map;if(Q-=b,0>Q)b=Math.max(0,I[Ae].g-100),X=!1;else try{Eg(xe,N,"req"+Q+"_")}catch{f&&f(xe)}}if(X){f=N.join("&");break e}}}return i=i.i.splice(0,u),c.D=i,f}function cu(i){if(!i.g&&!i.u){i.Y=1;var c=i.Fa;O||ce(),M||(O(),M=!0),q.add(c,i),i.v=0}}function Zi(i){return i.g||i.u||3<=i.v?!1:(i.Y++,i.u=ms(T(i.Fa,i),du(i,i.v)),i.v++,!0)}n.Fa=function(){if(this.u=null,uu(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var i=2*this.R;this.j.info("BP detection timer enabled: "+i),this.A=ms(T(this.ab,this),i)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,qe(10),br(this),uu(this))};function eo(i){i.A!=null&&(l.clearTimeout(i.A),i.A=null)}function uu(i){i.g=new Bt(i,i.j,"rpc",i.Y),i.m===null&&(i.g.H=i.o),i.g.O=0;var c=bt(i.qa);ne(c,"RID","rpc"),ne(c,"SID",i.K),ne(c,"AID",i.T),ne(c,"CI",i.F?"0":"1"),!i.F&&i.ja&&ne(c,"TO",i.ja),ne(c,"TYPE","xmlhttp"),bs(i,c),i.m&&i.o&&Xi(c,i.m,i.o),i.L&&(i.g.I=i.L);var u=i.g;i=i.ia,u.L=1,u.v=Tr(bt(c)),u.m=null,u.P=!0,Vc(u,i)}n.Za=function(){this.C!=null&&(this.C=null,br(this),Zi(this),qe(19))};function Cr(i){i.C!=null&&(l.clearTimeout(i.C),i.C=null)}function hu(i,c){var u=null;if(i.g==c){Cr(i),eo(i),i.g=null;var f=2}else if(Qi(i.h,c))u=c.D,jc(i.h,c),f=1;else return;if(i.G!=0){if(c.o)if(f==1){u=c.m?c.m.length:0,c=Date.now()-c.F;var I=i.B;f=gr(),Be(f,new xc(f,u)),Ar(i)}else cu(i);else if(I=c.s,I==3||I==0&&0<c.X||!(f==1&&bg(i,c)||f==2&&Zi(i)))switch(u&&0<u.length&&(c=i.h,c.i=c.i.concat(u)),I){case 1:on(i,5);break;case 4:on(i,10);break;case 3:on(i,6);break;default:on(i,2)}}}function du(i,c){let u=i.Ta+Math.floor(Math.random()*i.cb);return i.isActive()||(u*=2),u*c}function on(i,c){if(i.j.info("Error code "+c),c==2){var u=T(i.fb,i),f=i.Xa;let I=!f;f=new rn(f||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||wr(f,"https"),Tr(f),I?yg(f.toString(),u):vg(f.toString(),u)}else qe(2);i.G=0,i.l&&i.l.sa(c),fu(i),ou(i)}n.fb=function(i){i?(this.j.info("Successfully pinged google.com"),qe(2)):(this.j.info("Failed to ping google.com"),qe(1))};function fu(i){if(i.G=0,i.ka=[],i.l){let c=zc(i.h);(c.length!=0||i.i.length!=0)&&(P(i.ka,c),P(i.ka,i.i),i.h.i.length=0,R(i.i),i.i.length=0),i.l.ra()}}function pu(i,c,u){var f=u instanceof rn?bt(u):new rn(u);if(f.g!="")c&&(f.g=c+"."+f.g),Er(f,f.s);else{var I=l.location;f=I.protocol,c=c?c+"."+I.hostname:I.hostname,I=+I.port;var b=new rn(null);f&&wr(b,f),c&&(b.g=c),I&&Er(b,I),u&&(b.l=u),f=b}return u=i.D,c=i.ya,u&&c&&ne(f,u,c),ne(f,"VER",i.la),bs(i,f),f}function mu(i,c,u){if(c&&!i.J)throw Error("Can't create secondary domain capable XhrIo object.");return c=i.Ca&&!i.pa?new le(new Es({eb:u})):new le(i.pa),c.Ha(i.J),c}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function gu(){}n=gu.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Rr(){}Rr.prototype.g=function(i,c){return new Qe(i,c)};function Qe(i,c){De.call(this),this.g=new iu(c),this.l=i,this.h=c&&c.messageUrlParams||null,i=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(i?i["X-Client-Protocol"]="webchannel":i={"X-Client-Protocol":"webchannel"}),this.g.o=i,i=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(i?i["X-WebChannel-Content-Type"]=c.messageContentType:i={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.va&&(i?i["X-WebChannel-Client-Profile"]=c.va:i={"X-WebChannel-Client-Profile":c.va}),this.g.S=i,(i=c&&c.Sb)&&!U(i)&&(this.g.m=i),this.v=c&&c.supportsCrossDomainXhr||!1,this.u=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!U(c)&&(this.g.D=c,i=this.h,i!==null&&c in i&&(i=this.h,c in i&&delete i[c])),this.j=new Nn(this)}A(Qe,De),Qe.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Qe.prototype.close=function(){Ji(this.g)},Qe.prototype.o=function(i){var c=this.g;if(typeof i=="string"){var u={};u.__data__=i,i=u}else this.u&&(u={},u.__data__=Bi(i),i=u);c.i.push(new lg(c.Ya++,i)),c.G==3&&Ar(c)},Qe.prototype.N=function(){this.g.l=null,delete this.j,Ji(this.g),delete this.g,Qe.aa.N.call(this)};function _u(i){$i.call(this),i.__headers__&&(this.headers=i.__headers__,this.statusCode=i.__status__,delete i.__headers__,delete i.__status__);var c=i.__sm__;if(c){e:{for(let u in c){i=u;break e}i=void 0}(this.i=i)&&(i=this.i,c=c!==null&&i in c?c[i]:void 0),this.data=c}else this.data=i}A(_u,$i);function yu(){ji.call(this),this.status=1}A(yu,ji);function Nn(i){this.g=i}A(Nn,gu),Nn.prototype.ua=function(){Be(this.g,"a")},Nn.prototype.ta=function(i){Be(this.g,new _u(i))},Nn.prototype.sa=function(i){Be(this.g,new yu)},Nn.prototype.ra=function(){Be(this.g,"b")},Rr.prototype.createWebChannel=Rr.prototype.g,Qe.prototype.send=Qe.prototype.o,Qe.prototype.open=Qe.prototype.m,Qe.prototype.close=Qe.prototype.close,Td=kt.createWebChannelTransport=function(){return new Rr},Ed=kt.getStatEventTarget=function(){return gr()},wd=kt.Event=nn,vd=kt.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},_r.NO_ERROR=0,_r.TIMEOUT=8,_r.HTTP_ERROR=6,yd=kt.ErrorCode=_r,Oc.COMPLETE="complete",_d=kt.EventType=Oc,Pc.EventType=fs,fs.OPEN="a",fs.CLOSE="b",fs.ERROR="c",fs.MESSAGE="d",De.prototype.listen=De.prototype.K,gd=kt.WebChannel=Pc,iv=kt.FetchXmlHttpFactory=Es,le.prototype.listenOnce=le.prototype.L,le.prototype.getLastError=le.prototype.Ka,le.prototype.getLastErrorCode=le.prototype.Ba,le.prototype.getStatus=le.prototype.Z,le.prototype.getResponseJson=le.prototype.Oa,le.prototype.getResponseText=le.prototype.oa,le.prototype.send=le.prototype.ea,le.prototype.setWithCredentials=le.prototype.Ha,md=kt.XhrIo=le}).apply(typeof ti<"u"?ti:typeof self<"u"?self:typeof window<"u"?window:{});var Id="@firebase/firestore",Sd="4.7.10";var Pe=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Pe.UNAUTHENTICATED=new Pe(null),Pe.GOOGLE_CREDENTIALS=new Pe("google-credentials-uid"),Pe.FIRST_PARTY=new Pe("first-party-uid"),Pe.MOCK_USER=new Pe("mock-user");var $s="11.5.0";var Hn=new _t("@firebase/firestore");function ct(n,...e){if(Hn.logLevel<=Wt.DEBUG){let t=e.map(wa);Hn.debug(`Firestore (${$s}): ${n}`,...t)}}function Dd(n,...e){if(Hn.logLevel<=Wt.ERROR){let t=e.map(wa);Hn.error(`Firestore (${$s}): ${n}`,...t)}}function ov(n,...e){if(Hn.logLevel<=Wt.WARN){let t=e.map(wa);Hn.warn(`Firestore (${$s}): ${n}`,...t)}}function wa(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function Ke(n="Unexpected state"){let e=`FIRESTORE (${$s}) INTERNAL ASSERTION FAILED: `+n;throw Dd(e),new Error(e)}function yn(n,e){n||Ke()}var je={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Ne=class extends mt{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var vn=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var ni=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},oa=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Pe.UNAUTHENTICATED))}shutdown(){}},aa=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},la=class{constructor(e){this.t=e,this.currentUser=Pe.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){yn(this.o===void 0);let s=this.i,r=h=>this.i!==s?(s=this.i,t(h)):Promise.resolve(),o=new vn;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new vn,e.enqueueRetryable(()=>r(this.currentUser))};let a=()=>{let h=o;e.enqueueRetryable(()=>D(this,null,function*(){yield h.promise,yield r(this.currentUser)}))},l=h=>{ct("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(h=>l(h)),setTimeout(()=>{if(!this.auth){let h=this.t.getImmediate({optional:!0});h?l(h):(ct("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new vn)}},0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(s=>this.i!==e?(ct("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(yn(typeof s.accessToken=="string"),new ni(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return yn(e===null||typeof e=="string"),new Pe(e)}},ca=class{constructor(e,t,s){this.l=e,this.h=t,this.P=s,this.type="FirstParty",this.user=Pe.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);let e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}},ua=class{constructor(e,t,s){this.l=e,this.h=t,this.P=s}getToken(){return Promise.resolve(new ca(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Pe.FIRST_PARTY))}shutdown(){}invalidateToken(){}},si=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},ha=class{constructor(e,t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null,this.V=null,Pt(e)&&e.settings.appCheckToken&&(this.V=e.settings.appCheckToken)}start(e,t){yn(this.o===void 0);let s=o=>{o.error!=null&&ct("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let a=o.token!==this.R;return this.R=o.token,ct("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>s(o))};let r=o=>{ct("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>r(o)),setTimeout(()=>{if(!this.appCheck){let o=this.A.getImmediate({optional:!0});o?r(o):ct("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.V)return Promise.resolve(new si(this.V));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(yn(typeof t.token=="string"),this.R=t.token,new si(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function av(){return new TextEncoder}function Jt(n,e){return n<e?-1:n>e?1:0}function lv(n,e){let t=0;for(;t<n.length&&t<e.length;){let s=n.codePointAt(t),r=e.codePointAt(t);if(s!==r){if(s<128&&r<128)return Jt(s,r);{let o=av(),a=cv(o.encode(bd(n,t)),o.encode(bd(e,t)));return a!==0?a:Jt(s,r)}}t+=s>65535?2:1}return Jt(n.length,e.length)}function bd(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function cv(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return Jt(n[t],e[t]);return Jt(n.length,e.length)}var da=class n{constructor(e,t,s){t===void 0?t=0:t>e.length&&Ke(),s===void 0?s=e.length-t:s>e.length-t&&Ke(),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(s=>{t.push(s)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let s=Math.min(e.length,t.length);for(let r=0;r<s;r++){let o=n.compareSegments(e.get(r),t.get(r));if(o!==0)return o}return Jt(e.length,t.length)}static compareSegments(e,t){let s=n.isNumericId(e),r=n.isNumericId(t);return s&&!r?-1:!s&&r?1:s&&r?n.extractNumericId(e).compare(n.extractNumericId(t)):lv(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ei.fromString(e.substring(4,e.length-2))}},Xt=class n extends da{construct(e,t,s){return new n(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let s of e){if(s.indexOf("//")>=0)throw new Ne(je.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter(r=>r.length>0))}return new n(t)}static emptyPath(){return new n([])}};var wn=class n{constructor(e){this.path=e}static fromPath(e){return new n(Xt.fromString(e))}static fromName(e){return new n(Xt.fromString(e).popFirst(5))}static empty(){return new n(Xt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Xt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Xt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new Xt(e.slice()))}};var fa=class{constructor(e,t,s,r){this.indexId=e,this.collectionGroup=t,this.fields=s,this.indexState=r}};fa.UNKNOWN_ID=-1;function uv(n){return n.name==="IndexedDbTransactionError"}function hv(n){return n===0&&1/n==-1/0}var dv="remoteDocuments",xd="owner";var Od="mutationQueues";var Md="mutations";var Fd="documentMutations",fv="remoteDocumentsV14";var Vd="remoteDocumentGlobal";var Ld="targets";var Ud="targetDocuments";var Bd="targetGlobal",qd="collectionParents";var $d="clientMetadata";var jd="bundles";var zd="namedQueries";var pv="indexConfiguration";var mv="indexState";var gv="indexEntries";var Gd="documentOverlays";var _v="globals";var yv=[Od,Md,Fd,dv,Ld,xd,Bd,Ud,$d,Vd,qd,jd,zd],Ab=[...yv,Gd],vv=[Od,Md,Fd,fv,Ld,xd,Bd,Ud,$d,Vd,qd,jd,zd,Gd],wv=vv,Ev=[...wv,pv,mv,gv];var Cb=[...Ev,_v];var Qn=class n{constructor(e,t){this.comparator=e,this.root=t||Et.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Et.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Et.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){let r=this.comparator(e,s.key);if(r===0)return t+s.left.size;r<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,s)=>(e(t,s),!1))}toString(){let e=[];return this.inorderTraversal((t,s)=>(e.push(`${t}:${s}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Wn(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Wn(this.root,e,this.comparator,!1)}getReverseIterator(){return new Wn(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Wn(this.root,e,this.comparator,!0)}},Wn=class{constructor(e,t,s,r){this.isReverse=r,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?s(e.key,t):1,t&&r&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Et=class n{constructor(e,t,s,r,o){this.key=e,this.value=t,this.color=s??n.RED,this.left=r??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,r,o){return new n(e??this.key,t??this.value,s??this.color,r??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let r=this,o=s(e,r.key);return r=o<0?r.copy(null,null,null,r.left.insert(e,t,s),null):o===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,s)),r.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return n.EMPTY;s=r.right.min(),r=r.copy(s.key,s.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Ke();let e=this.left.check();if(e!==this.right.check())throw Ke();return e+(this.isRed()?0:1)}};Et.EMPTY=null,Et.RED=!0,Et.BLACK=!1;Et.EMPTY=new class{constructor(){this.size=0}get key(){throw Ke()}get value(){throw Ke()}get color(){throw Ke()}get left(){throw Ke()}get right(){throw Ke()}copy(e,t,s,r,o){return this}insert(e,t,s){return new Et(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var ri=class n{constructor(e){this.comparator=e,this.data=new Qn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,s)=>(e(t),!1))}forEachInRange(e,t){let s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){let r=s.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new ii(this.data.getIterator())}getIteratorFrom(e){return new ii(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(s=>{t=t.add(s)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){let r=t.getNext().key,o=s.getNext().key;if(this.comparator(r,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},ii=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var pa=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Yn=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(r){try{return atob(r)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new pa("Invalid base64 string: "+o):o}}(e);return new n(t)}static fromUint8Array(e){let t=function(r){let o="";for(let a=0;a<r.length;++a)o+=String.fromCharCode(r[a]);return o}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let s=new Uint8Array(t.length);for(let r=0;r<t.length;r++)s[r]=t.charCodeAt(r);return s}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Jt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Yn.EMPTY_BYTE_STRING=new Yn("");var Tv=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Iv(n){if(yn(!!n),typeof n=="string"){let e=0,t=Tv.exec(n);if(yn(!!t),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}let s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:qs(n.seconds),nanos:qs(n.nanos)}}function qs(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Sv(n){return typeof n=="string"?Yn.fromBase64String(n):Yn.fromUint8Array(n)}var ma="(default)",ga=class n{constructor(e,t){this.projectId=e,this.database=t||ma}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===ma}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Kd="__type__",bv="__max__";var Wd="__vector__",Hd="value";function Av(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[Kd])===null||t===void 0?void 0:t.stringValue)===Wd}function Cv(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===bv}var Pb={mapValue:{fields:{[Kd]:{stringValue:Wd},[Hd]:{arrayValue:{}}}}};var Nb=new Qn(wn.comparator);var kb=new Qn(wn.comparator);var Db=new Qn(wn.comparator),xb=new ri(wn.comparator);var Ob=new ri(Jt);var Ad,G;(G=Ad||(Ad={}))[G.OK=0]="OK",G[G.CANCELLED=1]="CANCELLED",G[G.UNKNOWN=2]="UNKNOWN",G[G.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",G[G.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",G[G.NOT_FOUND=5]="NOT_FOUND",G[G.ALREADY_EXISTS=6]="ALREADY_EXISTS",G[G.PERMISSION_DENIED=7]="PERMISSION_DENIED",G[G.UNAUTHENTICATED=16]="UNAUTHENTICATED",G[G.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",G[G.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",G[G.ABORTED=10]="ABORTED",G[G.OUT_OF_RANGE=11]="OUT_OF_RANGE",G[G.UNIMPLEMENTED=12]="UNIMPLEMENTED",G[G.INTERNAL=13]="INTERNAL",G[G.UNAVAILABLE=14]="UNAVAILABLE",G[G.DATA_LOSS=15]="DATA_LOSS";var Mb=new ei([4294967295,4294967295],0);var oi=class{constructor(){}At(e,t){this.Rt(e,t),t.Vt()}Rt(e,t){if("nullValue"in e)this.ft(t,5);else if("booleanValue"in e)this.ft(t,10),t.gt(e.booleanValue?1:0);else if("integerValue"in e)this.ft(t,15),t.gt(qs(e.integerValue));else if("doubleValue"in e){let s=qs(e.doubleValue);isNaN(s)?this.ft(t,13):(this.ft(t,15),hv(s)?t.gt(0):t.gt(s))}else if("timestampValue"in e){let s=e.timestampValue;this.ft(t,20),typeof s=="string"&&(s=Iv(s)),t.yt(`${s.seconds||""}`),t.gt(s.nanos||0)}else if("stringValue"in e)this.wt(e.stringValue,t),this.St(t);else if("bytesValue"in e)this.ft(t,30),t.bt(Sv(e.bytesValue)),this.St(t);else if("referenceValue"in e)this.Dt(e.referenceValue,t);else if("geoPointValue"in e){let s=e.geoPointValue;this.ft(t,45),t.gt(s.latitude||0),t.gt(s.longitude||0)}else"mapValue"in e?Cv(e)?this.ft(t,Number.MAX_SAFE_INTEGER):Av(e)?this.vt(e.mapValue,t):(this.Ct(e.mapValue,t),this.St(t)):"arrayValue"in e?(this.Ft(e.arrayValue,t),this.St(t)):Ke()}wt(e,t){this.ft(t,25),this.Mt(e,t)}Mt(e,t){t.yt(e)}Ct(e,t){let s=e.fields||{};this.ft(t,55);for(let r of Object.keys(s))this.wt(r,t),this.Rt(s[r],t)}vt(e,t){var s,r;let o=e.fields||{};this.ft(t,53);let a=Hd,l=((r=(s=o[a].arrayValue)===null||s===void 0?void 0:s.values)===null||r===void 0?void 0:r.length)||0;this.ft(t,15),t.gt(qs(l)),this.wt(a,t),this.Rt(o[a],t)}Ft(e,t){let s=e.values||[];this.ft(t,50);for(let r of s)this.Rt(r,t)}Dt(e,t){this.ft(t,37),wn.fromName(e).path.forEach(s=>{this.ft(t,60),this.Mt(s,t)})}ft(e,t){e.gt(t)}St(e){e.gt(2)}};oi.xt=new oi;var Fb=new Uint8Array(0);var Qd=41943040,wt=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}};wt.DEFAULT_COLLECTION_PERCENTILE=10,wt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,wt.DEFAULT=new wt(Qd,wt.DEFAULT_COLLECTION_PERCENTILE,wt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),wt.DISABLED=new wt(-1,0,0);var Rv=1048576;function ia(){return typeof document<"u"?document:null}var _a=class{constructor(e,t,s=1e3,r=1.5,o=6e4){this.Ti=e,this.timerId=t,this.Go=s,this.zo=r,this.jo=o,this.Ho=0,this.Jo=null,this.Yo=Date.now(),this.reset()}reset(){this.Ho=0}Zo(){this.Ho=this.jo}Xo(e){this.cancel();let t=Math.floor(this.Ho+this.e_()),s=Math.max(0,Date.now()-this.Yo),r=Math.max(0,t-s);r>0&&ct("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Ho} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.Jo=this.Ti.enqueueAfterDelay(this.timerId,r,()=>(this.Yo=Date.now(),e())),this.Ho*=this.zo,this.Ho<this.Go&&(this.Ho=this.Go),this.Ho>this.jo&&(this.Ho=this.jo)}t_(){this.Jo!==null&&(this.Jo.skipDelay(),this.Jo=null)}cancel(){this.Jo!==null&&(this.Jo.cancel(),this.Jo=null)}e_(){return(Math.random()-.5)*this.Ho}};var ya=class n{constructor(e,t,s,r,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=r,this.removalCallback=o,this.deferred=new vn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,r,o){let a=Date.now()+s,l=new n(e,t,a,r,o);return l.start(s),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ne(je.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};var Cd,Rd;(Rd=Cd||(Cd={}))._a="default",Rd.Cache="cache";function Pv(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var Pd=new Map;function Nv(n,e,t,s){if(e===!0&&s===!0)throw new Ne(je.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function kv(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(s){return s.constructor?s.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ke()}function Dv(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ne(je.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=kv(n);throw new Ne(je.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var Yd="firestore.googleapis.com",Nd=!0,ai=class{constructor(e){var t,s;if(e.host===void 0){if(e.ssl!==void 0)throw new Ne(je.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Yd,this.ssl=Nd}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:Nd;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Qd;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Rv)throw new Ne(je.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Nv("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Pv((s=e.experimentalLongPollingOptions)!==null&&s!==void 0?s:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new Ne(je.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new Ne(je.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new Ne(je.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(s,r){return s.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},li=class{constructor(e,t,s,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ai({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ne(je.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ne(je.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ai(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(s){if(!s)return new oa;switch(s.type){case"firstParty":return new ua(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new Ne(je.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return D(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let s=Pd.get(t);s&&(ct("ComponentProvider","Removing Datastore"),Pd.delete(t),s.terminate())}(this),Promise.resolve()}};function Xd(n,e,t,s={}){var r;let o=(n=Dv(n,li))._getSettings(),a=Object.assign(Object.assign({},o),{emulatorOptions:n._getEmulatorOptions()}),l=`${e}:${t}`;o.host!==Yd&&o.host!==l&&ov("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let h=Object.assign(Object.assign({},o),{host:l,ssl:!1,emulatorOptions:s});if(!Kt(h,a)&&(n._setSettings(h),s.mockUserToken)){let d,m;if(typeof s.mockUserToken=="string")d=s.mockUserToken,m=Pe.MOCK_USER;else{d=Bn(s.mockUserToken,(r=n._app)===null||r===void 0?void 0:r.options.projectId);let g=s.mockUserToken.sub||s.mockUserToken.user_id;if(!g)throw new Ne(je.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new Pe(g)}n._authCredentials=new aa(new ni(d,m))}}var kd="AsyncQueue",ci=class{constructor(e=Promise.resolve()){this.Vu=[],this.mu=!1,this.fu=[],this.gu=null,this.pu=!1,this.yu=!1,this.wu=[],this.a_=new _a(this,"async_queue_retry"),this.Su=()=>{let s=ia();s&&ct(kd,"Visibility state changed to "+s.visibilityState),this.a_.t_()},this.bu=e;let t=ia();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Su)}get isShuttingDown(){return this.mu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Du(),this.vu(e)}enterRestrictedMode(e){if(!this.mu){this.mu=!0,this.yu=e||!1;let t=ia();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Su)}}enqueue(e){if(this.Du(),this.mu)return new Promise(()=>{});let t=new vn;return this.vu(()=>this.mu&&this.yu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Vu.push(e),this.Cu()))}Cu(){return D(this,null,function*(){if(this.Vu.length!==0){try{yield this.Vu[0](),this.Vu.shift(),this.a_.reset()}catch(e){if(!uv(e))throw e;ct(kd,"Operation failed with retryable error: "+e)}this.Vu.length>0&&this.a_.Xo(()=>this.Cu())}})}vu(e){let t=this.bu.then(()=>(this.pu=!0,e().catch(s=>{this.gu=s,this.pu=!1;let r=function(a){let l=a.message||"";return a.stack&&(l=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),l}(s);throw Dd("INTERNAL UNHANDLED ERROR: ",r),s}).then(s=>(this.pu=!1,s))));return this.bu=t,t}enqueueAfterDelay(e,t,s){this.Du(),this.wu.indexOf(e)>-1&&(t=0);let r=ya.createAndSchedule(this,e,t,s,o=>this.Fu(o));return this.fu.push(r),r}Du(){this.gu&&Ke()}verifyOperationInProgress(){}Mu(){return D(this,null,function*(){let e;do e=this.bu,yield e;while(e!==this.bu)})}xu(e){for(let t of this.fu)if(t.timerId===e)return!0;return!1}Ou(e){return this.Mu().then(()=>{this.fu.sort((t,s)=>t.targetTimeMs-s.targetTimeMs);for(let t of this.fu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Mu()})}Nu(e){this.wu.push(e)}Fu(e){let t=this.fu.indexOf(e);this.fu.splice(t,1)}};var va=class extends li{constructor(e,t,s,r){super(e,t,s,r),this.type="firestore",this._queue=new ci,this._persistenceKey=r?.name||"[DEFAULT]"}_terminate(){return D(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new ci(e),this._firestoreClient=void 0,yield e}})}};function Jd(n,e){let t=typeof n=="object"?n:Fe(),s=typeof n=="string"?n:e||ma,r=Re(t,"firestore").getImmediate({identifier:s});if(!r._initialized){let o=zt("firestore");o&&Xd(r,...o)}return r}var Vb=new RegExp("[~\\*/\\[\\]]");(function(e,t=!0){(function(r){$s=r})(Ht),ve(new ye("firestore",(s,{instanceIdentifier:r,options:o})=>{let a=s.getProvider("app").getImmediate(),l=new va(new la(s.getProvider("auth-internal")),new ha(a,s.getProvider("app-check-internal")),function(d,m){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Ne(je.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ga(d.options.projectId,m)}(a,r),a);return o=Object.assign({useFetchStreams:t},o),l._setSettings(o),l},"PUBLIC").setMultipleInstances(!0)),V(Id,Sd,e),V(Id,Sd,"esm2017")})();var js=class{constructor(e){return e}},Zd="firestore",Ea=class{constructor(){return Ee(Zd)}};var Ta=new me("angularfire2.firestore-instances");function xv(n,e){let t=we(Zd,n,e);return t&&new js(t)}function Ov(n){return(e,t)=>{let s=e.runOutsideAngular(()=>n(t));return new js(s)}}var Mv={provide:Ea,deps:[[new $,Ta]]},Fv={provide:js,useFactory:xv,deps:[[new $,Ta],Ie]};function ef(n,...e){return V("angularfire",fe.full,"fst"),ge([Fv,Mv,{provide:Ta,useFactory:Ov(n),multi:!0,deps:[re,ue,Te,Se,[new $,Qt],[new $,yt],...e]}])}var tf=he(Jd,!0);var nf="@firebase/database",sf="1.0.14";var wl="";function Vv(n){wl=n}var Na=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),_e(t))}get(e){let t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:Dr(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var ka=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return gt(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var Ff=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){let e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new Na(e)}}catch{}return new ka},Tn=Ff("localStorage"),Da=Ff("sessionStorage");var es=new _t("@firebase/database"),Lv=function(){let n=1;return function(){return n++}}(),Vf=function(n){let e=th(n),t=new Zu;t.update(e);let s=t.digest();return Ku.encodeByteArray(s)},nr=function(...n){let e="";for(let t=0;t<n.length;t++){let s=n[t];Array.isArray(s)||s&&typeof s=="object"&&typeof s.length=="number"?e+=nr.apply(null,s):typeof s=="object"?e+=_e(s):e+=s,e+=" "}return e},In=null,rf=!0,Uv=function(n,e){k(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(es.logLevel=Wt.VERBOSE,In=es.log.bind(es),e&&Da.set("logging_enabled",!0)):typeof n=="function"?In=n:(In=null,Da.remove("logging_enabled"))},Ve=function(...n){if(rf===!0&&(rf=!1,In===null&&Da.get("logging_enabled")===!0&&Uv(!0)),In){let e=nr.apply(null,n);In(e)}},sr=function(n){return function(...e){Ve(n,...e)}},xa=function(...n){let e="FIREBASE INTERNAL ERROR: "+nr(...n);es.error(e)},xt=function(...n){let e=`FIREBASE FATAL ERROR: ${nr(...n)}`;throw es.error(e),new Error(e)},Ze=function(...n){let e="FIREBASE WARNING: "+nr(...n);es.warn(e)},Bv=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Ze("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Lf=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},qv=function(n){if(pt()||document.readyState==="complete")n();else{let e=!1,t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},ns="[MIN_NAME]",Sn="[MAX_NAME]",cs=function(n,e){if(n===e)return 0;if(n===ns||e===Sn)return-1;if(e===ns||n===Sn)return 1;{let t=of(n),s=of(e);return t!==null?s!==null?t-s===0?n.length-e.length:t-s:-1:s!==null?1:n<e?-1:1}},$v=function(n,e){return n===e?0:n<e?-1:1},zs=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+_e(e))},El=function(n){if(typeof n!="object"||n===null)return _e(n);let e=[];for(let s in n)e.push(s);e.sort();let t="{";for(let s=0;s<e.length;s++)s!==0&&(t+=","),t+=_e(e[s]),t+=":",t+=El(n[e[s]]);return t+="}",t},Uf=function(n,e){let t=n.length;if(t<=e)return[n];let s=[];for(let r=0;r<t;r+=e)r+e>t?s.push(n.substring(r,t)):s.push(n.substring(r,r+e));return s};function ot(n,e){for(let t in n)n.hasOwnProperty(t)&&e(t,n[t])}var Bf=function(n){k(!Lf(n),"Invalid JSON number");let e=11,t=52,s=(1<<e-1)-1,r,o,a,l,h;n===0?(o=0,a=0,r=1/n===-1/0?1:0):(r=n<0,n=Math.abs(n),n>=Math.pow(2,1-s)?(l=Math.min(Math.floor(Math.log(n)/Math.LN2),s),o=l+s,a=Math.round(n*Math.pow(2,t-l)-Math.pow(2,t))):(o=0,a=Math.round(n/Math.pow(2,1-s-t))));let d=[];for(h=t;h;h-=1)d.push(a%2?1:0),a=Math.floor(a/2);for(h=e;h;h-=1)d.push(o%2?1:0),o=Math.floor(o/2);d.push(r?1:0),d.reverse();let m=d.join(""),g="";for(h=0;h<64;h+=8){let T=parseInt(m.substr(h,8),2).toString(16);T.length===1&&(T="0"+T),g=g+T}return g.toLowerCase()},jv=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},zv=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};var Gv=new RegExp("^-?(0*)\\d{1,10}$"),Kv=-2147483648,Wv=2147483647,of=function(n){if(Gv.test(n)){let e=Number(n);if(e>=Kv&&e<=Wv)return e}return null},rr=function(n){try{n()}catch(e){setTimeout(()=>{let t=e.stack||"";throw Ze("Exception was thrown by user callback.",t),e},Math.floor(0))}},Hv=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Qs=function(n,e){let t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};var Oa=class{constructor(e,t){this.appCheckProvider=t,this.appName=e.name,Pt(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(s=>this.appCheck=s)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((t,s)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,s):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(s=>s.addTokenListener(e))}notifyForInvalidToken(){Ze(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}};var Ma=class{constructor(e,t,s){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=s,this.auth_=null,this.auth_=s.getImmediate({optional:!0}),this.auth_||s.onInit(r=>this.auth_=r)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(Ve("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,s)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,s):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Ze(e)}},Ys=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}n.OWNER="owner";return n})(),hi="5",qf="v",$f="s",jf="r",zf="f",Gf=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Kf="ls",Wf="p",Fa="ac",Hf="websocket",Qf="long_polling";var di=class{constructor(e,t,s,r,o=!1,a="",l=!1,h=!1,d=null){this.secure=t,this.namespace=s,this.webSocketOnly=r,this.nodeAdmin=o,this.persistenceKey=a,this.includeNamespaceInQueryParams=l,this.isUsingEmulator=h,this.emulatorOptions=d,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Tn.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Tn.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}};function Qv(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function Yf(n,e,t){k(typeof e=="string","typeof type must == string"),k(typeof t=="object","typeof params must == object");let s;if(e===Hf)s=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===Qf)s=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);Qv(n)&&(t.ns=n.namespace);let r=[];return ot(t,(o,a)=>{r.push(o+"="+a)}),s+r.join("&")}var Va=class{constructor(){this.counters_={}}incrementCounter(e,t=1){gt(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return Hu(this.counters_)}};var Ia={},Sa={};function Tl(n){let e=n.toString();return Ia[e]||(Ia[e]=new Va),Ia[e]}function Yv(n,e){let t=n.toString();return Sa[t]||(Sa[t]=e()),Sa[t]}var La=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){let s=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<s.length;++r)s[r]&&rr(()=>{this.onMessage_(s[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var af="start",Xv="close",Jv="pLPCommand",Zv="pRTLPCB",Xf="id",Jf="pw",Zf="ser",ew="cb",tw="seg",nw="ts",sw="d",rw="dframe",ep=1870,tp=30,iw=ep-tp,ow=25e3,aw=3e4,Ua=class n{constructor(e,t,s,r,o,a,l){this.connId=e,this.repoInfo=t,this.applicationId=s,this.appCheckToken=r,this.authToken=o,this.transportSessionId=a,this.lastSessionId=l,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=sr(e),this.stats_=Tl(t),this.urlFn=h=>(this.appCheckToken&&(h[Fa]=this.appCheckToken),Yf(t,Qf,h))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new La(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(aw)),qv(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Ba((...o)=>{let[a,l,h,d,m]=o;if(this.incrementIncomingBytes_(o),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,a===af)this.id=l,this.password=h;else if(a===Xv)l?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(l,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+a)},(...o)=>{let[a,l]=o;this.incrementIncomingBytes_(o),this.myPacketOrderer.handleResponse(a,l)},()=>{this.onClosed_()},this.urlFn);let s={};s[af]="t",s[Zf]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(s[ew]=this.scriptTagHolder.uniqueCallbackIdentifier),s[qf]=hi,this.transportSessionId&&(s[$f]=this.transportSessionId),this.lastSessionId&&(s[Kf]=this.lastSessionId),this.applicationId&&(s[Wf]=this.applicationId),this.appCheckToken&&(s[Fa]=this.appCheckToken),typeof location<"u"&&location.hostname&&Gf.test(location.hostname)&&(s[jf]=zf);let r=this.urlFn(s);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){n.forceAllow_=!0}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){return pt()?!1:n.forceAllow_?!0:!n.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!jv()&&!zv()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let t=_e(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let s=Wu(t),r=Uf(s,iw);for(let o=0;o<r.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[o]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(pt())return;this.myDisconnFrame=document.createElement("iframe");let s={};s[rw]="t",s[Xf]=e,s[Jf]=t,this.myDisconnFrame.src=this.urlFn(s),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let t=_e(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}},Ba=class n{constructor(e,t,s,r){if(this.onDisconnect=s,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,pt())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=Lv(),window[Jv+this.uniqueCallbackIdentifier]=e,window[Zv+this.uniqueCallbackIdentifier]=t,this.myIFrame=n.createIFrame_();let o="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(o='<script>document.domain="'+document.domain+'";<\/script>');let a="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(l){Ve("frame writing exception"),l.stack&&Ve(l.stack),Ve(l)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Ve("No IE domain setting required")}catch{let s=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+s+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[Xf]=this.myID,e[Jf]=this.myPW,e[Zf]=this.currentSerial;let t=this.urlFn(e),s="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+tp+s.length<=ep;){let a=this.pendingSegs.shift();s=s+"&"+tw+r+"="+a.seg+"&"+nw+r+"="+a.ts+"&"+sw+r+"="+a.d,r++}return t=t+s,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,s){this.pendingSegs.push({seg:e,ts:t,d:s}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);let s=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(s,Math.floor(ow)),o=()=>{clearTimeout(r),s()};this.addTag(e,o)}addTag(e,t){pt()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;let s=this.myIFrame.doc.createElement("script");s.type="text/javascript",s.async=!0,s.src=e,s.onload=s.onreadystatechange=function(){let r=s.readyState;(!r||r==="loaded"||r==="complete")&&(s.onload=s.onreadystatechange=null,s.parentNode&&s.parentNode.removeChild(s),t())},s.onerror=()=>{Ve("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(s)}catch{}},Math.floor(1))}};var lw=16384,cw=45e3,fi=null;typeof MozWebSocket<"u"?fi=MozWebSocket:typeof WebSocket<"u"&&(fi=WebSocket);var Gs=(()=>{class n{constructor(t,s,r,o,a,l,h){this.connId=t,this.applicationId=r,this.appCheckToken=o,this.authToken=a,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=sr(this.connId),this.stats_=Tl(s),this.connURL=n.connectionURL_(s,l,h,o,r),this.nodeAdmin=s.nodeAdmin}static connectionURL_(t,s,r,o,a){let l={};return l[qf]=hi,!pt()&&typeof location<"u"&&location.hostname&&Gf.test(location.hostname)&&(l[jf]=zf),s&&(l[$f]=s),r&&(l[Kf]=r),o&&(l[Fa]=o),a&&(l[Wf]=a),Yf(t,Hf,l)}open(t,s){this.onDisconnect=s,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Tn.set("previous_websocket_failure",!0);try{let r;if(pt()){let o=this.nodeAdmin?"AdminNode":"Node";r={headers:{"User-Agent":`Firebase/${hi}/${wl}/${process.platform}/${o}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(r.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(r.headers["X-Firebase-AppCheck"]=this.appCheckToken);let a=process.env,l=this.connURL.indexOf("wss://")===0?a.HTTPS_PROXY||a.https_proxy:a.HTTP_PROXY||a.http_proxy;l&&(r.proxy={origin:l})}this.mySock=new fi(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");let o=r.message||r.data;o&&this.log_(o),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");let o=r.message||r.data;o&&this.log_(o),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){let s=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(s);r&&r.length>1&&parseFloat(r[1])<4.4&&(t=!0)}return!t&&fi!==null&&!n.forceDisallow_}static previouslyFailed(){return Tn.isInMemoryStorage||Tn.get("previous_websocket_failure")===!0}markConnectionHealthy(){Tn.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){let s=this.frames.join("");this.frames=null;let r=Dr(s);this.onMessage(r)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(k(this.frames===null,"We already have a frame buffer"),t.length<=6){let s=Number(t);if(!isNaN(s))return this.handleNewFrameCount_(s),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;let s=t.data;if(this.bytesReceived+=s.length,this.stats_.incrementCounter("bytes_received",s.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(s);else{let r=this.extractFrameCount_(s);r!==null&&this.appendFrame_(r)}}send(t){this.resetKeepAlive();let s=_e(t);this.bytesSent+=s.length,this.stats_.incrementCounter("bytes_sent",s.length);let r=Uf(s,lw);r.length>1&&this.sendString_(String(r.length));for(let o=0;o<r.length;o++)this.sendString_(r[o])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(cw))}sendString_(t){try{this.mySock.send(t)}catch(s){this.log_("Exception thrown from WebSocket.send():",s.message||s.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4;return n})(),uw=(()=>{class n{static get ALL_TRANSPORTS(){return[Ua,Gs]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(t){this.initTransports_(t)}initTransports_(t){let s=Gs&&Gs.isAvailable(),r=s&&!Gs.previouslyFailed();if(t.webSocketOnly&&(s||Ze("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[Gs];else{let o=this.transports_=[];for(let a of n.ALL_TRANSPORTS)a&&a.isAvailable()&&o.push(a);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}n.globalTransportInitialized_=!1;return n})(),hw=6e4,dw=5e3,fw=10*1024,pw=100*1024,ba="t",lf="d",mw="s",cf="r",gw="e",uf="o",hf="a",df="n",ff="p",_w="h",qa=class{constructor(e,t,s,r,o,a,l,h,d,m){this.id=e,this.repoInfo_=t,this.applicationId_=s,this.appCheckToken_=r,this.authToken_=o,this.onMessage_=a,this.onReady_=l,this.onDisconnect_=h,this.onKill_=d,this.lastSessionId=m,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=sr("c:"+this.id+":"),this.transportManager_=new uw(t),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.conn_),s=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,s)},Math.floor(0));let r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=Qs(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>pw?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>fw?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){let t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(ba in e){let t=e[ba];t===hf?this.upgradeIfSecondaryHealthy_():t===cf?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===uf&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let t=zs("t",e),s=zs("d",e);if(t==="c")this.onSecondaryControl_(s);else if(t==="d")this.pendingDataMessages.push(s);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:ff,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:hf,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:df,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let t=zs("t",e),s=zs("d",e);t==="c"?this.onControl_(s):t==="d"&&this.onDataMessage_(s)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let t=zs(ba,e);if(lf in e){let s=e[lf];if(t===_w){let r=Object.assign({},s);this.repoInfo_.isUsingEmulator&&(r.h=this.repoInfo_.host),this.onHandshake_(r)}else if(t===df){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===mw?this.onConnectionShutdown_(s):t===cf?this.onReset_(s):t===gw?xa("Server Error: "+s):t===uf?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):xa("Unknown control packet command: "+t)}}onHandshake_(e){let t=e.ts,s=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),hi!==s&&Ze("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.secondaryConn_),s=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,s),Qs(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(hw))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Qs(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(dw))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:ff,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Tn.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var pi=class{put(e,t,s,r){}merge(e,t,s,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,s){}onDisconnectMerge(e,t,s){}onDisconnectCancel(e,t){}reportStats(e){}};var mi=class{constructor(e){this.allowedEvents_=e,this.listeners_={},k(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){let s=[...this.listeners_[e]];for(let r=0;r<s.length;r++)s[r].callback.apply(s[r].context,t)}}on(e,t,s){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:s});let r=this.getInitialEvent(e);r&&t.apply(s,r)}off(e,t,s){this.validateEventType_(e);let r=this.listeners_[e]||[];for(let o=0;o<r.length;o++)if(r[o].callback===t&&(!s||s===r[o].context)){r.splice(o,1);return}}validateEventType_(e){k(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}};var gi=class n extends mi{static getInstance(){return new n}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!fo()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return k(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var pf=32,mf=768,J=class{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let s=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[s]=this.pieces_[r],s++);this.pieces_.length=s,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}};function Y(){return new J("")}function K(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function en(n){return n.pieces_.length-n.pieceNum_}function se(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new J(n.pieces_,e)}function np(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function yw(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function sp(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function rp(n){if(n.pieceNum_>=n.pieces_.length)return null;let e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new J(e,0)}function be(n,e){let t=[];for(let s=n.pieceNum_;s<n.pieces_.length;s++)t.push(n.pieces_[s]);if(e instanceof J)for(let s=e.pieceNum_;s<e.pieces_.length;s++)t.push(e.pieces_[s]);else{let s=e.split("/");for(let r=0;r<s.length;r++)s[r].length>0&&t.push(s[r])}return new J(t,0)}function z(n){return n.pieceNum_>=n.pieces_.length}function rt(n,e){let t=K(n),s=K(e);if(t===null)return e;if(t===s)return rt(se(n),se(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function ip(n,e){if(en(n)!==en(e))return!1;for(let t=n.pieceNum_,s=e.pieceNum_;t<=n.pieces_.length;t++,s++)if(n.pieces_[t]!==e.pieces_[s])return!1;return!0}function ht(n,e){let t=n.pieceNum_,s=e.pieceNum_;if(en(n)>en(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[s])return!1;++t,++s}return!0}var $a=class{constructor(e,t){this.errorPrefix_=t,this.parts_=sp(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let s=0;s<this.parts_.length;s++)this.byteLength_+=Ds(this.parts_[s]);op(this)}};function vw(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=Ds(e),op(n)}function ww(n){let e=n.parts_.pop();n.byteLength_-=Ds(e),n.parts_.length>0&&(n.byteLength_-=1)}function op(n){if(n.byteLength_>mf)throw new Error(n.errorPrefix_+"has a key path longer than "+mf+" bytes ("+n.byteLength_+").");if(n.parts_.length>pf)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+pf+") or object contains a cycle "+En(n))}function En(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}var ja=class n extends mi{static getInstance(){return new n}constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{let s=!document[e];s!==this.visible_&&(this.visible_=s,this.trigger("visible",s))},!1)}getInitialEvent(e){return k(e==="visible","Unknown event type: "+e),[this.visible_]}};var Ks=1e3,Ew=60*5*1e3,gf=30*1e3,Tw=1.3,Iw=3e4,Sw="server_kill",_f=3,Il=(()=>{class n extends pi{constructor(t,s,r,o,a,l,h,d){if(super(),this.repoInfo_=t,this.applicationId_=s,this.onDataUpdate_=r,this.onConnectStatus_=o,this.onServerInfoUpdate_=a,this.authTokenProvider_=l,this.appCheckTokenProvider_=h,this.authOverride_=d,this.id=n.nextPersistentConnectionId_++,this.log_=sr("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Ks,this.maxReconnectDelay_=Ew,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,d&&!pt())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");ja.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&gi.getInstance().on("online",this.onOnline_,this)}sendRequest(t,s,r){let o=++this.requestNumber_,a={r:o,a:t,b:s};this.log_(_e(a)),k(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(a),r&&(this.requestCBHash_[o]=r)}get(t){this.initConnection_();let s=new ho,o={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:l=>{let h=l.d;l.s==="ok"?s.resolve(h):s.reject(h)}};this.outstandingGets_.push(o),this.outstandingGetCount_++;let a=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(a),s.promise}listen(t,s,r,o){this.initConnection_();let a=t._queryIdentifier,l=t._path.toString();this.log_("Listen called for "+l+" "+a),this.listens.has(l)||this.listens.set(l,new Map),k(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),k(!this.listens.get(l).has(a),"listen() called twice for same path/queryId.");let h={onComplete:o,hashFn:s,query:t,tag:r};this.listens.get(l).set(a,h),this.connected_&&this.sendListen_(h)}sendGet_(t){let s=this.outstandingGets_[t];this.sendRequest("g",s.request,r=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),s.onComplete&&s.onComplete(r)})}sendListen_(t){let s=t.query,r=s._path.toString(),o=s._queryIdentifier;this.log_("Listen on "+r+" for "+o);let a={p:r},l="q";t.tag&&(a.q=s._queryObject,a.t=t.tag),a.h=t.hashFn(),this.sendRequest(l,a,h=>{let d=h.d,m=h.s;n.warnOnListenWarnings_(d,s),(this.listens.get(r)&&this.listens.get(r).get(o))===t&&(this.log_("listen response",h),m!=="ok"&&this.removeListen_(r,o),t.onComplete&&t.onComplete(m,d))})}static warnOnListenWarnings_(t,s){if(t&&typeof t=="object"&&gt(t,"w")){let r=hn(t,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){let o='".indexOn": "'+s._queryParams.getIndex().toString()+'"',a=s._path.toString();Ze(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${o} at ${a} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||Xu(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=gf)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let t=this.authToken_,s=Yu(t)?"auth":"gauth",r={cred:t};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(s,r,o=>{let a=o.s,l=o.d||"error";this.authToken_===t&&(a==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(a,l))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{let s=t.s,r=t.d||"error";s==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(s,r)})}unlisten(t,s){let r=t._path.toString(),o=t._queryIdentifier;this.log_("Unlisten called for "+r+" "+o),k(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,o)&&this.connected_&&this.sendUnlisten_(r,o,t._queryObject,s)}sendUnlisten_(t,s,r,o){this.log_("Unlisten on "+t+" for "+s);let a={p:t},l="n";o&&(a.q=r,a.t=o),this.sendRequest(l,a)}onDisconnectPut(t,s,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,s,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:s,onComplete:r})}onDisconnectMerge(t,s,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,s,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:s,onComplete:r})}onDisconnectCancel(t,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,s):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:s})}sendOnDisconnect_(t,s,r,o){let a={p:s,d:r};this.log_("onDisconnect "+t,a),this.sendRequest(t,a,l=>{o&&setTimeout(()=>{o(l.s,l.d)},Math.floor(0))})}put(t,s,r,o){this.putInternal("p",t,s,r,o)}merge(t,s,r,o){this.putInternal("m",t,s,r,o)}putInternal(t,s,r,o,a){this.initConnection_();let l={p:s,d:r};a!==void 0&&(l.h=a),this.outstandingPuts_.push({action:t,request:l,onComplete:o}),this.outstandingPutCount_++;let h=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(h):this.log_("Buffering put: "+s)}sendPut_(t){let s=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,o=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(s,r,a=>{this.log_(s+" response",a),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),o&&o(a.s,a.d)})}reportStats(t){if(this.connected_){let s={c:t};this.log_("reportStats",s),this.sendRequest("s",s,r=>{if(r.s!=="ok"){let a=r.d;this.log_("reportStats","Error sending stats: "+a)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+_e(t));let s=t.r,r=this.requestCBHash_[s];r&&(delete this.requestCBHash_[s],r(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,s){this.log_("handleServerMessage",t,s),t==="d"?this.onDataUpdate_(s.p,s.d,!1,s.t):t==="m"?this.onDataUpdate_(s.p,s.d,!0,s.t):t==="c"?this.onListenRevoked_(s.p,s.q):t==="ac"?this.onAuthRevoked_(s.s,s.d):t==="apc"?this.onAppCheckRevoked_(s.s,s.d):t==="sd"?this.onSecurityDebugPacket_(s):xa("Unrecognized action received from server: "+_e(t)+`
Are you using the latest client?`)}onReady_(t,s){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=s,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){k(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Ks,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Ks,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>Iw&&(this.reconnectDelay_=Ks),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let t=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_),s=Math.max(0,this.reconnectDelay_-t);s=Math.random()*s,this.log_("Trying to reconnect in "+s+"ms"),this.scheduleConnect_(s),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*Tw)}this.onConnectStatus_(!1)}establishConnection_(){return D(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let t=this.onDataMessage_.bind(this),s=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),o=this.id+":"+n.nextConnectionId_++,a=this.lastSessionId,l=!1,h=null,d=function(){h?h.close():(l=!0,r())},m=function(T){k(h,"sendRequest call when we're not connected not allowed."),h.sendRequest(T)};this.realtime_={close:d,sendRequest:m};let g=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[T,C]=yield Promise.all([this.authTokenProvider_.getToken(g),this.appCheckTokenProvider_.getToken(g)]);l?Ve("getToken() completed but was canceled"):(Ve("getToken() completed. Creating connection."),this.authToken_=T&&T.accessToken,this.appCheckToken_=C&&C.token,h=new qa(o,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,s,r,A=>{Ze(A+" ("+this.repoInfo_.toString()+")"),this.interrupt(Sw)},a))}catch(T){this.log_("Failed to get token: "+T),l||(this.repoInfo_.nodeAdmin&&Ze(T),d())}}})}interrupt(t){Ve("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Ve("Resuming connection for reason: "+t),delete this.interruptReasons_[t],mo(this.interruptReasons_)&&(this.reconnectDelay_=Ks,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){let s=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:s})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){let s=this.outstandingPuts_[t];s&&"h"in s.request&&s.queued&&(s.onComplete&&s.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,s){let r;s?r=s.map(a=>El(a)).join("$"):r="default";let o=this.removeListen_(t,r);o&&o.onComplete&&o.onComplete("permission_denied")}removeListen_(t,s){let r=new J(t).toString(),o;if(this.listens.has(r)){let a=this.listens.get(r);o=a.get(s),a.delete(s),a.size===0&&this.listens.delete(r)}else o=void 0;return o}onAuthRevoked_(t,s){Ve("Auth token revoked: "+t+"/"+s),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=_f&&(this.reconnectDelay_=gf,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,s){Ve("App check token revoked: "+t+"/"+s),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=_f&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let t of this.listens.values())for(let s of t.values())this.sendListen_(s);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){let t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){let t={},s="js";pt()&&(this.repoInfo_.nodeAdmin?s="admin_node":s="node"),t["sdk."+s+"."+wl.replace(/\./g,"-")]=1,fo()?t["framework.cordova"]=1:Qu()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){let t=gi.getInstance().currentlyOnline();return mo(this.interruptReasons_)&&t}}n.nextPersistentConnectionId_=0,n.nextConnectionId_=0;return n})(),W=class n{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new n(e,t)}};var ss=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){let s=new W(ns,e),r=new W(ns,t);return this.compare(s,r)!==0}minPost(){return W.MIN}};var ui,_i=class extends ss{static get __EMPTY_NODE(){return ui}static set __EMPTY_NODE(e){ui=e}compare(e,t){return cs(e.name,t.name)}isDefinedOn(e){throw Un("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return W.MIN}maxPost(){return new W(Sn,ui)}makePost(e,t){return k(typeof e=="string","KeyIndex indexValue must always be a string."),new W(e,ui)}toString(){return".key"}},ts=new _i;var Jn=class{constructor(e,t,s,r,o=null){this.isReverse_=r,this.resultGenerator_=o,this.nodeStack_=[];let a=1;for(;!e.isEmpty();)if(e=e,a=t?s(e.key,t):1,r&&(a*=-1),a<0)this.isReverse_?e=e.left:e=e.right;else if(a===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},ut=(()=>{class n{constructor(t,s,r,o,a){this.key=t,this.value=s,this.color=r??n.RED,this.left=o??it.EMPTY_NODE,this.right=a??it.EMPTY_NODE}copy(t,s,r,o,a){return new n(t??this.key,s??this.value,r??this.color,o??this.left,a??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,s,r){let o=this,a=r(t,o.key);return a<0?o=o.copy(null,null,null,o.left.insert(t,s,r),null):a===0?o=o.copy(null,s,null,null,null):o=o.copy(null,null,null,null,o.right.insert(t,s,r)),o.fixUp_()}removeMin_(){if(this.left.isEmpty())return it.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,s){let r,o;if(r=this,s(t,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(t,s),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),s(t,r.key)===0){if(r.right.isEmpty())return it.EMPTY_NODE;o=r.right.min_(),r=r.copy(o.key,o.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(t,s))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){let t=this.left.copy(null,null,!this.left.color,null,null),s=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,s)}checkMaxDepth_(){let t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})(),za=class{copy(e,t,s,r,o){return this}insert(e,t,s){return new ut(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},it=class n{constructor(e,t=n.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new n(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,ut.BLACK,null,null))}remove(e){return new n(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,ut.BLACK,null,null))}get(e){let t,s=this.root_;for(;!s.isEmpty();){if(t=this.comparator_(e,s.key),t===0)return s.value;t<0?s=s.left:t>0&&(s=s.right)}return null}getPredecessorKey(e){let t,s=this.root_,r=null;for(;!s.isEmpty();)if(t=this.comparator_(e,s.key),t===0){if(s.left.isEmpty())return r?r.key:null;for(s=s.left;!s.right.isEmpty();)s=s.right;return s.key}else t<0?s=s.left:t>0&&(r=s,s=s.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Jn(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Jn(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Jn(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Jn(this.root_,null,this.comparator_,!0,e)}};it.EMPTY_NODE=new za;function bw(n,e){return cs(n.name,e.name)}function Sl(n,e){return cs(n,e)}var Ga;function Aw(n){Ga=n}var ap=function(n){return typeof n=="number"?"number:"+Bf(n):"string:"+n},lp=function(n){if(n.isLeafNode()){let e=n.val();k(typeof e=="string"||typeof e=="number"||typeof e=="object"&&gt(e,".sv"),"Priority must be a string or number.")}else k(n===Ga||n.isEmpty(),"priority of unexpected type.");k(n===Ga||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var yf,rs=(()=>{class n{static set __childrenNodeConstructor(t){yf=t}static get __childrenNodeConstructor(){return yf}constructor(t,s=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=s,this.lazyHash_=null,k(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),lp(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return z(t)?this:K(t)===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,s){return null}updateImmediateChild(t,s){return t===".priority"?this.updatePriority(s):s.isEmpty()&&t!==".priority"?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,s).updatePriority(this.priorityNode_)}updateChild(t,s){let r=K(t);return r===null?s:s.isEmpty()&&r!==".priority"?this:(k(r!==".priority"||en(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(se(t),s)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,s){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+ap(this.priorityNode_.val())+":");let s=typeof this.value_;t+=s+":",s==="number"?t+=Bf(this.value_):t+=this.value_,this.lazyHash_=Vf(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:(k(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){let s=typeof t.value_,r=typeof this.value_,o=n.VALUE_TYPE_ORDER.indexOf(s),a=n.VALUE_TYPE_ORDER.indexOf(r);return k(o>=0,"Unknown leaf type: "+s),k(a>=0,"Unknown leaf type: "+r),o===a?r==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:a-o}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){let s=t;return this.value_===s.value_&&this.priorityNode_.equals(s.priorityNode_)}else return!1}}n.VALUE_TYPE_ORDER=["object","boolean","number","string"];return n})(),cp,up;function Cw(n){cp=n}function Rw(n){up=n}var Ka=class extends ss{compare(e,t){let s=e.node.getPriority(),r=t.node.getPriority(),o=s.compareTo(r);return o===0?cs(e.name,t.name):o}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return W.MIN}maxPost(){return new W(Sn,new rs("[PRIORITY-POST]",up))}makePost(e,t){let s=cp(e);return new W(t,new rs("[PRIORITY-POST]",s))}toString(){return".priority"}},Ue=new Ka;var Pw=Math.log(2),Wa=class{constructor(e){let t=o=>parseInt(Math.log(o)/Pw,10),s=o=>parseInt(Array(o+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;let r=s(this.count);this.bits_=e+1&r}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},yi=function(n,e,t,s){n.sort(e);let r=function(h,d){let m=d-h,g,T;if(m===0)return null;if(m===1)return g=n[h],T=t?t(g):g,new ut(T,g.node,ut.BLACK,null,null);{let C=parseInt(m/2,10)+h,A=r(h,C),R=r(C+1,d);return g=n[C],T=t?t(g):g,new ut(T,g.node,ut.BLACK,A,R)}},o=function(h){let d=null,m=null,g=n.length,T=function(A,R){let P=g-A,F=g;g-=A;let U=r(P+1,F),B=n[P],L=t?t(B):B;C(new ut(L,B.node,R,null,U))},C=function(A){d?(d.left=A,d=A):(m=A,d=A)};for(let A=0;A<h.count;++A){let R=h.nextBitIsOne(),P=Math.pow(2,h.count-(A+1));R?T(P,ut.BLACK):(T(P,ut.BLACK),T(P,ut.RED))}return m},a=new Wa(n.length),l=o(a);return new it(s||e,l)};var Aa,Xn={},is=class n{static get Default(){return k(Xn&&Ue,"ChildrenNode.ts has not been loaded"),Aa=Aa||new n({".priority":Xn},{".priority":Ue}),Aa}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){let t=hn(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof it?t:null}hasIndex(e){return gt(this.indexSet_,e.toString())}addIndex(e,t){k(e!==ts,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let s=[],r=!1,o=t.getIterator(W.Wrap),a=o.getNext();for(;a;)r=r||e.isDefinedOn(a.node),s.push(a),a=o.getNext();let l;r?l=yi(s,e.getCompare()):l=Xn;let h=e.toString(),d=Object.assign({},this.indexSet_);d[h]=e;let m=Object.assign({},this.indexes_);return m[h]=l,new n(m,d)}addToIndexes(e,t){let s=ks(this.indexes_,(r,o)=>{let a=hn(this.indexSet_,o);if(k(a,"Missing index implementation for "+o),r===Xn)if(a.isDefinedOn(e.node)){let l=[],h=t.getIterator(W.Wrap),d=h.getNext();for(;d;)d.name!==e.name&&l.push(d),d=h.getNext();return l.push(e),yi(l,a.getCompare())}else return Xn;else{let l=t.get(e.name),h=r;return l&&(h=h.remove(new W(e.name,l))),h.insert(e,e.node)}});return new n(s,this.indexSet_)}removeFromIndexes(e,t){let s=ks(this.indexes_,r=>{if(r===Xn)return r;{let o=t.get(e.name);return o?r.remove(new W(e.name,o)):r}});return new n(s,this.indexSet_)}};var Ws,ie=(()=>{class n{static get EMPTY_NODE(){return Ws||(Ws=new n(new it(Sl),null,is.Default))}constructor(t,s,r){this.children_=t,this.priorityNode_=s,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&lp(this.priorityNode_),this.children_.isEmpty()&&k(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Ws}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{let s=this.children_.get(t);return s===null?Ws:s}}getChild(t){let s=K(t);return s===null?this:this.getImmediateChild(s).getChild(se(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,s){if(k(s,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(s);{let r=new W(t,s),o,a;s.isEmpty()?(o=this.children_.remove(t),a=this.indexMap_.removeFromIndexes(r,this.children_)):(o=this.children_.insert(t,s),a=this.indexMap_.addToIndexes(r,this.children_));let l=o.isEmpty()?Ws:this.priorityNode_;return new n(o,l,a)}}updateChild(t,s){let r=K(t);if(r===null)return s;{k(K(t)!==".priority"||en(t)===1,".priority must be the last token in a path");let o=this.getImmediateChild(r).updateChild(se(t),s);return this.updateImmediateChild(r,o)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;let s={},r=0,o=0,a=!0;if(this.forEachChild(Ue,(l,h)=>{s[l]=h.val(t),r++,a&&n.INTEGER_REGEXP_.test(l)?o=Math.max(o,Number(l)):a=!1}),!t&&a&&o<2*r){let l=[];for(let h in s)l[h]=s[h];return l}else return t&&!this.getPriority().isEmpty()&&(s[".priority"]=this.getPriority().val()),s}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+ap(this.getPriority().val())+":"),this.forEachChild(Ue,(s,r)=>{let o=r.hash();o!==""&&(t+=":"+s+":"+o)}),this.lazyHash_=t===""?"":Vf(t)}return this.lazyHash_}getPredecessorChildName(t,s,r){let o=this.resolveIndex_(r);if(o){let a=o.getPredecessorKey(new W(t,s));return a?a.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){let s=this.resolveIndex_(t);if(s){let r=s.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(t){let s=this.getFirstChildName(t);return s?new W(s,this.children_.get(s)):null}getLastChildName(t){let s=this.resolveIndex_(t);if(s){let r=s.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(t){let s=this.getLastChildName(t);return s?new W(s,this.children_.get(s)):null}forEachChild(t,s){let r=this.resolveIndex_(t);return r?r.inorderTraversal(o=>s(o.name,o.node)):this.children_.inorderTraversal(s)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,s){let r=this.resolveIndex_(s);if(r)return r.getIteratorFrom(t,o=>o);{let o=this.children_.getIteratorFrom(t.name,W.Wrap),a=o.peek();for(;a!=null&&s.compare(a,t)<0;)o.getNext(),a=o.peek();return o}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,s){let r=this.resolveIndex_(s);if(r)return r.getReverseIteratorFrom(t,o=>o);{let o=this.children_.getReverseIteratorFrom(t.name,W.Wrap),a=o.peek();for(;a!=null&&s.compare(a,t)>0;)o.getNext(),a=o.peek();return o}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===ir?-1:0}withIndex(t){if(t===ts||this.indexMap_.hasIndex(t))return this;{let s=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,s)}}isIndexed(t){return t===ts||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{let s=t;if(this.getPriority().equals(s.getPriority()))if(this.children_.count()===s.children_.count()){let r=this.getIterator(Ue),o=s.getIterator(Ue),a=r.getNext(),l=o.getNext();for(;a&&l;){if(a.name!==l.name||!a.node.equals(l.node))return!1;a=r.getNext(),l=o.getNext()}return a===null&&l===null}else return!1;else return!1}}resolveIndex_(t){return t===ts?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})(),Ha=class extends ie{constructor(){super(new it(Sl),ie.EMPTY_NODE,is.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return ie.EMPTY_NODE}isEmpty(){return!1}},ir=new Ha;Object.defineProperties(W,{MIN:{value:new W(ns,ie.EMPTY_NODE)},MAX:{value:new W(Sn,ir)}});_i.__EMPTY_NODE=ie.EMPTY_NODE;rs.__childrenNodeConstructor=ie;Aw(ir);Rw(ir);var Nw=!0;function Le(n,e=null){if(n===null)return ie.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),k(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){let t=n;return new rs(t,Le(e))}if(!(n instanceof Array)&&Nw){let t=[],s=!1;if(ot(n,(a,l)=>{if(a.substring(0,1)!=="."){let h=Le(l);h.isEmpty()||(s=s||!h.getPriority().isEmpty(),t.push(new W(a,h)))}}),t.length===0)return ie.EMPTY_NODE;let o=yi(t,bw,a=>a.name,Sl);if(s){let a=yi(t,Ue.getCompare());return new ie(o,Le(e),new is({".priority":a},{".priority":Ue}))}else return new ie(o,Le(e),is.Default)}else{let t=ie.EMPTY_NODE;return ot(n,(s,r)=>{if(gt(n,s)&&s.substring(0,1)!=="."){let o=Le(r);(o.isLeafNode()||!o.isEmpty())&&(t=t.updateImmediateChild(s,o))}}),t.updatePriority(Le(e))}}Cw(Le);var Qa=class extends ss{constructor(e){super(),this.indexPath_=e,k(!z(e)&&K(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){let s=this.extractChild(e.node),r=this.extractChild(t.node),o=s.compareTo(r);return o===0?cs(e.name,t.name):o}makePost(e,t){let s=Le(e),r=ie.EMPTY_NODE.updateChild(this.indexPath_,s);return new W(t,r)}maxPost(){let e=ie.EMPTY_NODE.updateChild(this.indexPath_,ir);return new W(Sn,e)}toString(){return sp(this.indexPath_,0).join("/")}};var Ya=class extends ss{compare(e,t){let s=e.node.compareTo(t.node);return s===0?cs(e.name,t.name):s}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return W.MIN}maxPost(){return W.MAX}makePost(e,t){let s=Le(e);return new W(t,s)}toString(){return".value"}},kw=new Ya;function Dw(n){return{type:"value",snapshotNode:n}}function xw(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function Ow(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function vf(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function Mw(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}var Xa=class n{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ue}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return k(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return k(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ns}hasEnd(){return this.endSet_}getIndexEndValue(){return k(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return k(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Sn}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return k(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ue}copy(){let e=new n;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function wf(n){let e={};if(n.isDefault())return e;let t;if(n.index_===Ue?t="$priority":n.index_===kw?t="$value":n.index_===ts?t="$key":(k(n.index_ instanceof Qa,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=_e(t),n.startSet_){let s=n.startAfterSet_?"startAfter":"startAt";e[s]=_e(n.indexStartValue_),n.startNameSet_&&(e[s]+=","+_e(n.indexStartName_))}if(n.endSet_){let s=n.endBeforeSet_?"endBefore":"endAt";e[s]=_e(n.indexEndValue_),n.endNameSet_&&(e[s]+=","+_e(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function Ef(n){let e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==Ue&&(e.i=n.index_.toString()),e}var Ja=class n extends pi{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(k(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,s,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=s,this.appCheckTokenProvider_=r,this.log_=sr("p:rest:"),this.listens_={}}listen(e,t,s,r){let o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);let a=n.getListenId_(e,s),l={};this.listens_[a]=l;let h=wf(e._queryParams);this.restRequest_(o+".json",h,(d,m)=>{let g=m;if(d===404&&(g=null,d=null),d===null&&this.onDataUpdate_(o,g,!1,s),hn(this.listens_,a)===l){let T;d?d===401?T="permission_denied":T="rest_error:"+d:T="ok",r(T,null)}})}unlisten(e,t){let s=n.getListenId_(e,t);delete this.listens_[s]}get(e){let t=wf(e._queryParams),s=e._path.toString(),r=new ho;return this.restRequest_(s+".json",t,(o,a)=>{let l=a;o===404&&(l=null,o=null),o===null?(this.onDataUpdate_(s,l,!1,null),r.resolve(l)):r.reject(new Error(l))}),r.promise}refreshAuthToken(e){}restRequest_(e,t={},s){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,o])=>{r&&r.accessToken&&(t.auth=r.accessToken),o&&o.token&&(t.ac=o.token);let a=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Ju(t);this.log_("Sending REST request for "+a);let l=new XMLHttpRequest;l.onreadystatechange=()=>{if(s&&l.readyState===4){this.log_("REST Response for "+a+" received. status:",l.status,"response:",l.responseText);let h=null;if(l.status>=200&&l.status<300){try{h=Dr(l.responseText)}catch{Ze("Failed to parse JSON response for "+a+": "+l.responseText)}s(null,h)}else l.status!==401&&l.status!==404&&Ze("Got unsuccessful REST response for "+a+" Status: "+l.status),s(l.status);s=null}},l.open("GET",a,!0),l.send()})}};var Za=class{constructor(){this.rootNode_=ie.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}};function vi(){return{value:null,children:new Map}}function hp(n,e,t){if(z(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{let s=K(e);n.children.has(s)||n.children.set(s,vi());let r=n.children.get(s);e=se(e),hp(r,e,t)}}function el(n,e,t){n.value!==null?t(e,n.value):Fw(n,(s,r)=>{let o=new J(e.toString()+"/"+s);el(r,o,t)})}function Fw(n,e){n.children.forEach((t,s)=>{e(s,t)})}var tl=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),t=Object.assign({},e);return this.last_&&ot(this.last_,(s,r)=>{t[s]=t[s]-r}),this.last_=e,t}};var Tf=10*1e3,Vw=30*1e3,Lw=5*60*1e3,nl=class{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new tl(e);let s=Tf+(Vw-Tf)*Math.random();Qs(this.reportStats_.bind(this),Math.floor(s))}reportStats_(){let e=this.statsListener_.get(),t={},s=!1;ot(e,(r,o)=>{o>0&&gt(this.statsToReport_,r)&&(t[r]=o,s=!0)}),s&&this.server_.reportStats(t),Qs(this.reportStats_.bind(this),Math.floor(Math.random()*2*Lw))}};var Dt=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}(Dt||{});function dp(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function fp(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function pp(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}var sl=class n{constructor(e,t,s){this.path=e,this.affectedTree=t,this.revert=s,this.type=Dt.ACK_USER_WRITE,this.source=dp()}operationForChild(e){if(z(this.path)){if(this.affectedTree.value!=null)return k(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let t=this.affectedTree.subtree(new J(e));return new n(Y(),t,this.revert)}}else return k(K(this.path)===e,"operationForChild called for unrelated child."),new n(se(this.path),this.affectedTree,this.revert)}};var os=class n{constructor(e,t,s){this.source=e,this.path=t,this.snap=s,this.type=Dt.OVERWRITE}operationForChild(e){return z(this.path)?new n(this.source,Y(),this.snap.getImmediateChild(e)):new n(this.source,se(this.path),this.snap)}};var wi=class n{constructor(e,t,s){this.source=e,this.path=t,this.children=s,this.type=Dt.MERGE}operationForChild(e){if(z(this.path)){let t=this.children.subtree(new J(e));return t.isEmpty()?null:t.value?new os(this.source,Y(),t.value):new n(this.source,Y(),t)}else return k(K(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new n(this.source,se(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var Zs=class{constructor(e,t,s){this.node_=e,this.fullyInitialized_=t,this.filtered_=s}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(z(e))return this.isFullyInitialized()&&!this.filtered_;let t=K(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};function Uw(n,e,t,s){let r=[],o=[];return e.forEach(a=>{a.type==="child_changed"&&n.index_.indexedValueChanged(a.oldSnap,a.snapshotNode)&&o.push(Mw(a.childName,a.snapshotNode))}),Hs(n,r,"child_removed",e,s,t),Hs(n,r,"child_added",e,s,t),Hs(n,r,"child_moved",o,s,t),Hs(n,r,"child_changed",e,s,t),Hs(n,r,"value",e,s,t),r}function Hs(n,e,t,s,r,o){let a=s.filter(l=>l.type===t);a.sort((l,h)=>qw(n,l,h)),a.forEach(l=>{let h=Bw(n,l,o);r.forEach(d=>{d.respondsTo(l.type)&&e.push(d.createEvent(h,n.query_))})})}function Bw(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function qw(n,e,t){if(e.childName==null||t.childName==null)throw Un("Should only compare child_ events.");let s=new W(e.childName,e.snapshotNode),r=new W(t.childName,t.snapshotNode);return n.index_.compare(s,r)}function mp(n,e){return{eventCache:n,serverCache:e}}function Xs(n,e,t,s){return mp(new Zs(e,t,s),n.serverCache)}function gp(n,e,t,s){return mp(n.eventCache,new Zs(e,t,s))}function rl(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function bn(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}var Ca,$w=()=>(Ca||(Ca=new it($v)),Ca),We=class n{static fromObject(e){let t=new n(null);return ot(e,(s,r)=>{t=t.set(new J(s),r)}),t}constructor(e,t=$w()){this.value=e,this.children=t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:Y(),value:this.value};if(z(e))return null;{let s=K(e),r=this.children.get(s);if(r!==null){let o=r.findRootMostMatchingPathAndValue(se(e),t);return o!=null?{path:be(new J(s),o.path),value:o.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(z(e))return this;{let t=K(e),s=this.children.get(t);return s!==null?s.subtree(se(e)):new n(null)}}set(e,t){if(z(e))return new n(t,this.children);{let s=K(e),o=(this.children.get(s)||new n(null)).set(se(e),t),a=this.children.insert(s,o);return new n(this.value,a)}}remove(e){if(z(e))return this.children.isEmpty()?new n(null):new n(null,this.children);{let t=K(e),s=this.children.get(t);if(s){let r=s.remove(se(e)),o;return r.isEmpty()?o=this.children.remove(t):o=this.children.insert(t,r),this.value===null&&o.isEmpty()?new n(null):new n(this.value,o)}else return this}}get(e){if(z(e))return this.value;{let t=K(e),s=this.children.get(t);return s?s.get(se(e)):null}}setTree(e,t){if(z(e))return t;{let s=K(e),o=(this.children.get(s)||new n(null)).setTree(se(e),t),a;return o.isEmpty()?a=this.children.remove(s):a=this.children.insert(s,o),new n(this.value,a)}}fold(e){return this.fold_(Y(),e)}fold_(e,t){let s={};return this.children.inorderTraversal((r,o)=>{s[r]=o.fold_(be(e,r),t)}),t(e,this.value,s)}findOnPath(e,t){return this.findOnPath_(e,Y(),t)}findOnPath_(e,t,s){let r=this.value?s(t,this.value):!1;if(r)return r;if(z(e))return null;{let o=K(e),a=this.children.get(o);return a?a.findOnPath_(se(e),be(t,o),s):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Y(),t)}foreachOnPath_(e,t,s){if(z(e))return this;{this.value&&s(t,this.value);let r=K(e),o=this.children.get(r);return o?o.foreachOnPath_(se(e),be(t,r),s):new n(null)}}foreach(e){this.foreach_(Y(),e)}foreach_(e,t){this.children.inorderTraversal((s,r)=>{r.foreach_(be(e,s),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,s)=>{s.value&&e(t,s.value)})}};var dt=class n{constructor(e){this.writeTree_=e}static empty(){return new n(new We(null))}};function Js(n,e,t){if(z(e))return new dt(new We(t));{let s=n.writeTree_.findRootMostValueAndPath(e);if(s!=null){let r=s.path,o=s.value,a=rt(r,e);return o=o.updateChild(a,t),new dt(n.writeTree_.set(r,o))}else{let r=new We(t),o=n.writeTree_.setTree(e,r);return new dt(o)}}}function If(n,e,t){let s=n;return ot(t,(r,o)=>{s=Js(s,be(e,r),o)}),s}function Sf(n,e){if(z(e))return dt.empty();{let t=n.writeTree_.setTree(e,new We(null));return new dt(t)}}function il(n,e){return An(n,e)!=null}function An(n,e){let t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(rt(t.path,e)):null}function bf(n){let e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(Ue,(s,r)=>{e.push(new W(s,r))}):n.writeTree_.children.inorderTraversal((s,r)=>{r.value!=null&&e.push(new W(s,r.value))}),e}function Zt(n,e){if(z(e))return n;{let t=An(n,e);return t!=null?new dt(new We(t)):new dt(n.writeTree_.subtree(e))}}function ol(n){return n.writeTree_.isEmpty()}function as(n,e){return _p(Y(),n.writeTree_,e)}function _p(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let s=null;return e.children.inorderTraversal((r,o)=>{r===".priority"?(k(o.value!==null,"Priority writes must always be leaf nodes"),s=o.value):t=_p(be(n,r),o,t)}),!t.getChild(n).isEmpty()&&s!==null&&(t=t.updateChild(be(n,".priority"),s)),t}}function yp(n,e){return Ip(e,n)}function jw(n,e,t,s,r){k(s>n.lastWriteId,"Stacking an older write on top of newer ones"),r===void 0&&(r=!0),n.allWrites.push({path:e,snap:t,writeId:s,visible:r}),r&&(n.visibleWrites=Js(n.visibleWrites,e,t)),n.lastWriteId=s}function zw(n,e){for(let t=0;t<n.allWrites.length;t++){let s=n.allWrites[t];if(s.writeId===e)return s}return null}function Gw(n,e){let t=n.allWrites.findIndex(l=>l.writeId===e);k(t>=0,"removeWrite called with nonexistent writeId.");let s=n.allWrites[t];n.allWrites.splice(t,1);let r=s.visible,o=!1,a=n.allWrites.length-1;for(;r&&a>=0;){let l=n.allWrites[a];l.visible&&(a>=t&&Kw(l,s.path)?r=!1:ht(s.path,l.path)&&(o=!0)),a--}if(r){if(o)return Ww(n),!0;if(s.snap)n.visibleWrites=Sf(n.visibleWrites,s.path);else{let l=s.children;ot(l,h=>{n.visibleWrites=Sf(n.visibleWrites,be(s.path,h))})}return!0}else return!1}function Kw(n,e){if(n.snap)return ht(n.path,e);for(let t in n.children)if(n.children.hasOwnProperty(t)&&ht(be(n.path,t),e))return!0;return!1}function Ww(n){n.visibleWrites=vp(n.allWrites,Hw,Y()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function Hw(n){return n.visible}function vp(n,e,t){let s=dt.empty();for(let r=0;r<n.length;++r){let o=n[r];if(e(o)){let a=o.path,l;if(o.snap)ht(t,a)?(l=rt(t,a),s=Js(s,l,o.snap)):ht(a,t)&&(l=rt(a,t),s=Js(s,Y(),o.snap.getChild(l)));else if(o.children){if(ht(t,a))l=rt(t,a),s=If(s,l,o.children);else if(ht(a,t))if(l=rt(a,t),z(l))s=If(s,Y(),o.children);else{let h=hn(o.children,K(l));if(h){let d=h.getChild(se(l));s=Js(s,Y(),d)}}}else throw Un("WriteRecord should have .snap or .children")}}return s}function wp(n,e,t,s,r){if(!s&&!r){let o=An(n.visibleWrites,e);if(o!=null)return o;{let a=Zt(n.visibleWrites,e);if(ol(a))return t;if(t==null&&!il(a,Y()))return null;{let l=t||ie.EMPTY_NODE;return as(a,l)}}}else{let o=Zt(n.visibleWrites,e);if(!r&&ol(o))return t;if(!r&&t==null&&!il(o,Y()))return null;{let a=function(d){return(d.visible||r)&&(!s||!~s.indexOf(d.writeId))&&(ht(d.path,e)||ht(e,d.path))},l=vp(n.allWrites,a,e),h=t||ie.EMPTY_NODE;return as(l,h)}}}function Qw(n,e,t){let s=ie.EMPTY_NODE,r=An(n.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(Ue,(o,a)=>{s=s.updateImmediateChild(o,a)}),s;if(t){let o=Zt(n.visibleWrites,e);return t.forEachChild(Ue,(a,l)=>{let h=as(Zt(o,new J(a)),l);s=s.updateImmediateChild(a,h)}),bf(o).forEach(a=>{s=s.updateImmediateChild(a.name,a.node)}),s}else{let o=Zt(n.visibleWrites,e);return bf(o).forEach(a=>{s=s.updateImmediateChild(a.name,a.node)}),s}}function Yw(n,e,t,s,r){k(s||r,"Either existingEventSnap or existingServerSnap must exist");let o=be(e,t);if(il(n.visibleWrites,o))return null;{let a=Zt(n.visibleWrites,o);return ol(a)?r.getChild(t):as(a,r.getChild(t))}}function Xw(n,e,t,s){let r=be(e,t),o=An(n.visibleWrites,r);if(o!=null)return o;if(s.isCompleteForChild(t)){let a=Zt(n.visibleWrites,r);return as(a,s.getNode().getImmediateChild(t))}else return null}function Jw(n,e){return An(n.visibleWrites,e)}function Zw(n,e,t,s,r,o,a){let l,h=Zt(n.visibleWrites,e),d=An(h,Y());if(d!=null)l=d;else if(t!=null)l=as(h,t);else return[];if(l=l.withIndex(a),!l.isEmpty()&&!l.isLeafNode()){let m=[],g=a.getCompare(),T=o?l.getReverseIteratorFrom(s,a):l.getIteratorFrom(s,a),C=T.getNext();for(;C&&m.length<r;)g(C,s)!==0&&m.push(C),C=T.getNext();return m}else return[]}function eE(){return{visibleWrites:dt.empty(),allWrites:[],lastWriteId:-1}}function al(n,e,t,s){return wp(n.writeTree,n.treePath,e,t,s)}function Ep(n,e){return Qw(n.writeTree,n.treePath,e)}function Af(n,e,t,s){return Yw(n.writeTree,n.treePath,e,t,s)}function Ei(n,e){return Jw(n.writeTree,be(n.treePath,e))}function tE(n,e,t,s,r,o){return Zw(n.writeTree,n.treePath,e,t,s,r,o)}function bl(n,e,t){return Xw(n.writeTree,n.treePath,e,t)}function Tp(n,e){return Ip(be(n.treePath,e),n.writeTree)}function Ip(n,e){return{treePath:n,writeTree:e}}var ll=class{constructor(){this.changeMap=new Map}trackChildChange(e){let t=e.type,s=e.childName;k(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),k(s!==".priority","Only non-priority child changes can be tracked.");let r=this.changeMap.get(s);if(r){let o=r.type;if(t==="child_added"&&o==="child_removed")this.changeMap.set(s,vf(s,e.snapshotNode,r.snapshotNode));else if(t==="child_removed"&&o==="child_added")this.changeMap.delete(s);else if(t==="child_removed"&&o==="child_changed")this.changeMap.set(s,Ow(s,r.oldSnap));else if(t==="child_changed"&&o==="child_added")this.changeMap.set(s,xw(s,e.snapshotNode));else if(t==="child_changed"&&o==="child_changed")this.changeMap.set(s,vf(s,e.snapshotNode,r.oldSnap));else throw Un("Illegal combination of changes: "+e+" occurred after "+r)}else this.changeMap.set(s,e)}getChanges(){return Array.from(this.changeMap.values())}};var cl=class{getCompleteChild(e){return null}getChildAfterChild(e,t,s){return null}},Sp=new cl,er=class{constructor(e,t,s=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=s}getCompleteChild(e){let t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{let s=this.optCompleteServerCache_!=null?new Zs(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return bl(this.writes_,e,s)}}getChildAfterChild(e,t,s){let r=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:bn(this.viewCache_),o=tE(this.writes_,r,t,1,s,e);return o.length===0?null:o[0]}};function nE(n,e){k(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),k(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function sE(n,e,t,s,r){let o=new ll,a,l;if(t.type===Dt.OVERWRITE){let d=t;d.source.fromUser?a=ul(n,e,d.path,d.snap,s,r,o):(k(d.source.fromServer,"Unknown source."),l=d.source.tagged||e.serverCache.isFiltered()&&!z(d.path),a=Ti(n,e,d.path,d.snap,s,r,l,o))}else if(t.type===Dt.MERGE){let d=t;d.source.fromUser?a=iE(n,e,d.path,d.children,s,r,o):(k(d.source.fromServer,"Unknown source."),l=d.source.tagged||e.serverCache.isFiltered(),a=hl(n,e,d.path,d.children,s,r,l,o))}else if(t.type===Dt.ACK_USER_WRITE){let d=t;d.revert?a=lE(n,e,d.path,s,r,o):a=oE(n,e,d.path,d.affectedTree,s,r,o)}else if(t.type===Dt.LISTEN_COMPLETE)a=aE(n,e,t.path,s,o);else throw Un("Unknown operation type: "+t.type);let h=o.getChanges();return rE(e,a,h),{viewCache:a,changes:h}}function rE(n,e,t){let s=e.eventCache;if(s.isFullyInitialized()){let r=s.getNode().isLeafNode()||s.getNode().isEmpty(),o=rl(n);(t.length>0||!n.eventCache.isFullyInitialized()||r&&!s.getNode().equals(o)||!s.getNode().getPriority().equals(o.getPriority()))&&t.push(Dw(rl(e)))}}function bp(n,e,t,s,r,o){let a=e.eventCache;if(Ei(s,t)!=null)return e;{let l,h;if(z(t))if(k(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let d=bn(e),m=d instanceof ie?d:ie.EMPTY_NODE,g=Ep(s,m);l=n.filter.updateFullNode(e.eventCache.getNode(),g,o)}else{let d=al(s,bn(e));l=n.filter.updateFullNode(e.eventCache.getNode(),d,o)}else{let d=K(t);if(d===".priority"){k(en(t)===1,"Can't have a priority with additional path components");let m=a.getNode();h=e.serverCache.getNode();let g=Af(s,t,m,h);g!=null?l=n.filter.updatePriority(m,g):l=a.getNode()}else{let m=se(t),g;if(a.isCompleteForChild(d)){h=e.serverCache.getNode();let T=Af(s,t,a.getNode(),h);T!=null?g=a.getNode().getImmediateChild(d).updateChild(m,T):g=a.getNode().getImmediateChild(d)}else g=bl(s,d,e.serverCache);g!=null?l=n.filter.updateChild(a.getNode(),d,g,m,r,o):l=a.getNode()}}return Xs(e,l,a.isFullyInitialized()||z(t),n.filter.filtersNodes())}}function Ti(n,e,t,s,r,o,a,l){let h=e.serverCache,d,m=a?n.filter:n.filter.getIndexedFilter();if(z(t))d=m.updateFullNode(h.getNode(),s,null);else if(m.filtersNodes()&&!h.isFiltered()){let C=h.getNode().updateChild(t,s);d=m.updateFullNode(h.getNode(),C,null)}else{let C=K(t);if(!h.isCompleteForPath(t)&&en(t)>1)return e;let A=se(t),P=h.getNode().getImmediateChild(C).updateChild(A,s);C===".priority"?d=m.updatePriority(h.getNode(),P):d=m.updateChild(h.getNode(),C,P,A,Sp,null)}let g=gp(e,d,h.isFullyInitialized()||z(t),m.filtersNodes()),T=new er(r,g,o);return bp(n,g,t,r,T,l)}function ul(n,e,t,s,r,o,a){let l=e.eventCache,h,d,m=new er(r,e,o);if(z(t))d=n.filter.updateFullNode(e.eventCache.getNode(),s,a),h=Xs(e,d,!0,n.filter.filtersNodes());else{let g=K(t);if(g===".priority")d=n.filter.updatePriority(e.eventCache.getNode(),s),h=Xs(e,d,l.isFullyInitialized(),l.isFiltered());else{let T=se(t),C=l.getNode().getImmediateChild(g),A;if(z(T))A=s;else{let R=m.getCompleteChild(g);R!=null?np(T)===".priority"&&R.getChild(rp(T)).isEmpty()?A=R:A=R.updateChild(T,s):A=ie.EMPTY_NODE}if(C.equals(A))h=e;else{let R=n.filter.updateChild(l.getNode(),g,A,T,m,a);h=Xs(e,R,l.isFullyInitialized(),n.filter.filtersNodes())}}}return h}function Cf(n,e){return n.eventCache.isCompleteForChild(e)}function iE(n,e,t,s,r,o,a){let l=e;return s.foreach((h,d)=>{let m=be(t,h);Cf(e,K(m))&&(l=ul(n,l,m,d,r,o,a))}),s.foreach((h,d)=>{let m=be(t,h);Cf(e,K(m))||(l=ul(n,l,m,d,r,o,a))}),l}function Rf(n,e,t){return t.foreach((s,r)=>{e=e.updateChild(s,r)}),e}function hl(n,e,t,s,r,o,a,l){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let h=e,d;z(t)?d=s:d=new We(null).setTree(t,s);let m=e.serverCache.getNode();return d.children.inorderTraversal((g,T)=>{if(m.hasChild(g)){let C=e.serverCache.getNode().getImmediateChild(g),A=Rf(n,C,T);h=Ti(n,h,new J(g),A,r,o,a,l)}}),d.children.inorderTraversal((g,T)=>{let C=!e.serverCache.isCompleteForChild(g)&&T.value===null;if(!m.hasChild(g)&&!C){let A=e.serverCache.getNode().getImmediateChild(g),R=Rf(n,A,T);h=Ti(n,h,new J(g),R,r,o,a,l)}}),h}function oE(n,e,t,s,r,o,a){if(Ei(r,t)!=null)return e;let l=e.serverCache.isFiltered(),h=e.serverCache;if(s.value!=null){if(z(t)&&h.isFullyInitialized()||h.isCompleteForPath(t))return Ti(n,e,t,h.getNode().getChild(t),r,o,l,a);if(z(t)){let d=new We(null);return h.getNode().forEachChild(ts,(m,g)=>{d=d.set(new J(m),g)}),hl(n,e,t,d,r,o,l,a)}else return e}else{let d=new We(null);return s.foreach((m,g)=>{let T=be(t,m);h.isCompleteForPath(T)&&(d=d.set(m,h.getNode().getChild(T)))}),hl(n,e,t,d,r,o,l,a)}}function aE(n,e,t,s,r){let o=e.serverCache,a=gp(e,o.getNode(),o.isFullyInitialized()||z(t),o.isFiltered());return bp(n,a,t,s,Sp,r)}function lE(n,e,t,s,r,o){let a;if(Ei(s,t)!=null)return e;{let l=new er(s,e,r),h=e.eventCache.getNode(),d;if(z(t)||K(t)===".priority"){let m;if(e.serverCache.isFullyInitialized())m=al(s,bn(e));else{let g=e.serverCache.getNode();k(g instanceof ie,"serverChildren would be complete if leaf node"),m=Ep(s,g)}m=m,d=n.filter.updateFullNode(h,m,o)}else{let m=K(t),g=bl(s,m,e.serverCache);g==null&&e.serverCache.isCompleteForChild(m)&&(g=h.getImmediateChild(m)),g!=null?d=n.filter.updateChild(h,m,g,se(t),l,o):e.eventCache.getNode().hasChild(m)?d=n.filter.updateChild(h,m,ie.EMPTY_NODE,se(t),l,o):d=h,d.isEmpty()&&e.serverCache.isFullyInitialized()&&(a=al(s,bn(e)),a.isLeafNode()&&(d=n.filter.updateFullNode(d,a,o)))}return a=e.serverCache.isFullyInitialized()||Ei(s,Y())!=null,Xs(e,d,a,n.filter.filtersNodes())}}function cE(n,e){let t=bn(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!z(e)&&!t.getImmediateChild(K(e)).isEmpty())?t.getChild(e):null}function Pf(n,e,t,s){e.type===Dt.MERGE&&e.source.queryId!==null&&(k(bn(n.viewCache_),"We should always have a full cache before handling merges"),k(rl(n.viewCache_),"Missing event cache, even though we have a server cache"));let r=n.viewCache_,o=sE(n.processor_,r,e,t,s);return nE(n.processor_,o.viewCache),k(o.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=o.viewCache,uE(n,o.changes,o.viewCache.eventCache.getNode(),null)}function uE(n,e,t,s){let r=s?[s]:n.eventRegistrations_;return Uw(n.eventGenerator_,e,t,r)}var Nf;function hE(n){k(!Nf,"__referenceConstructor has already been defined"),Nf=n}function Al(n,e,t,s){let r=e.source.queryId;if(r!==null){let o=n.views.get(r);return k(o!=null,"SyncTree gave us an op for an invalid query."),Pf(o,e,t,s)}else{let o=[];for(let a of n.views.values())o=o.concat(Pf(a,e,t,s));return o}}function Cl(n,e){let t=null;for(let s of n.views.values())t=t||cE(s,e);return t}var kf;function dE(n){k(!kf,"__referenceConstructor has already been defined"),kf=n}var Ii=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new We(null),this.pendingWriteTree_=eE(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function fE(n,e,t,s,r){return jw(n.pendingWriteTree_,e,t,s,r),r?bi(n,new os(dp(),e,t)):[]}function Zn(n,e,t=!1){let s=zw(n.pendingWriteTree_,e);if(Gw(n.pendingWriteTree_,e)){let o=new We(null);return s.snap!=null?o=o.set(Y(),!0):ot(s.children,a=>{o=o.set(new J(a),!0)}),bi(n,new sl(s.path,o,t))}else return[]}function Si(n,e,t){return bi(n,new os(fp(),e,t))}function pE(n,e,t){let s=We.fromObject(t);return bi(n,new wi(fp(),e,s))}function mE(n,e,t,s){let r=Pp(n,s);if(r!=null){let o=Np(r),a=o.path,l=o.queryId,h=rt(a,e),d=new os(pp(l),h,t);return kp(n,a,d)}else return[]}function gE(n,e,t,s){let r=Pp(n,s);if(r){let o=Np(r),a=o.path,l=o.queryId,h=rt(a,e),d=We.fromObject(t),m=new wi(pp(l),h,d);return kp(n,a,m)}else return[]}function Ap(n,e,t){let r=n.pendingWriteTree_,o=n.syncPointTree_.findOnPath(e,(a,l)=>{let h=rt(a,e),d=Cl(l,h);if(d)return d});return wp(r,e,o,t,!0)}function bi(n,e){return Cp(e,n.syncPointTree_,null,yp(n.pendingWriteTree_,Y()))}function Cp(n,e,t,s){if(z(n.path))return Rp(n,e,t,s);{let r=e.get(Y());t==null&&r!=null&&(t=Cl(r,Y()));let o=[],a=K(n.path),l=n.operationForChild(a),h=e.children.get(a);if(h&&l){let d=t?t.getImmediateChild(a):null,m=Tp(s,a);o=o.concat(Cp(l,h,d,m))}return r&&(o=o.concat(Al(r,n,s,t))),o}}function Rp(n,e,t,s){let r=e.get(Y());t==null&&r!=null&&(t=Cl(r,Y()));let o=[];return e.children.inorderTraversal((a,l)=>{let h=t?t.getImmediateChild(a):null,d=Tp(s,a),m=n.operationForChild(a);m&&(o=o.concat(Rp(m,l,h,d)))}),r&&(o=o.concat(Al(r,n,s,t))),o}function Pp(n,e){return n.tagToQueryMap.get(e)}function Np(n){let e=n.indexOf("$");return k(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new J(n.substr(0,e))}}function kp(n,e,t){let s=n.syncPointTree_.get(e);k(s,"Missing sync point for query tag that we're tracking");let r=yp(n.pendingWriteTree_,e);return Al(s,t,r,null)}var dl=class n{constructor(e){this.node_=e}getImmediateChild(e){let t=this.node_.getImmediateChild(e);return new n(t)}node(){return this.node_}},fl=class n{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){let t=be(this.path_,e);return new n(this.syncTree_,t)}node(){return Ap(this.syncTree_,this.path_)}},_E=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},Df=function(n,e,t){if(!n||typeof n!="object")return n;if(k(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return yE(n[".sv"],e,t);if(typeof n[".sv"]=="object")return vE(n[".sv"],e);k(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},yE=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:k(!1,"Unexpected server value: "+n)}},vE=function(n,e,t){n.hasOwnProperty("increment")||k(!1,"Unexpected server value: "+JSON.stringify(n,null,2));let s=n.increment;typeof s!="number"&&k(!1,"Unexpected increment value: "+s);let r=e.node();if(k(r!==null&&typeof r<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return s;let a=r.getValue();return typeof a!="number"?s:a+s},wE=function(n,e,t,s){return Rl(e,new fl(t,n),s)},EE=function(n,e,t){return Rl(n,new dl(e),t)};function Rl(n,e,t){let s=n.getPriority().val(),r=Df(s,e.getImmediateChild(".priority"),t),o;if(n.isLeafNode()){let a=n,l=Df(a.getValue(),e,t);return l!==a.getValue()||r!==a.getPriority().val()?new rs(l,Le(r)):n}else{let a=n;return o=a,r!==a.getPriority().val()&&(o=o.updatePriority(new rs(r))),a.forEachChild(Ue,(l,h)=>{let d=Rl(h,e.getImmediateChild(l),t);d!==h&&(o=o.updateImmediateChild(l,d))}),o}}var tr=class{constructor(e="",t=null,s={children:{},childCount:0}){this.name=e,this.parent=t,this.node=s}};function Pl(n,e){let t=e instanceof J?e:new J(e),s=n,r=K(t);for(;r!==null;){let o=hn(s.node.children,r)||{children:{},childCount:0};s=new tr(r,s,o),t=se(t),r=K(t)}return s}function us(n){return n.node.value}function Dp(n,e){n.node.value=e,pl(n)}function xp(n){return n.node.childCount>0}function TE(n){return us(n)===void 0&&!xp(n)}function Ai(n,e){ot(n.node.children,(t,s)=>{e(new tr(t,n,s))})}function Op(n,e,t,s){t&&!s&&e(n),Ai(n,r=>{Op(r,e,!0,s)}),t&&s&&e(n)}function IE(n,e,t){let s=t?n:n.parent;for(;s!==null;){if(e(s))return!0;s=s.parent}return!1}function or(n){return new J(n.parent===null?n.name:or(n.parent)+"/"+n.name)}function pl(n){n.parent!==null&&SE(n.parent,n.name,n)}function SE(n,e,t){let s=TE(t),r=gt(n.node.children,e);s&&r?(delete n.node.children[e],n.node.childCount--,pl(n)):!s&&!r&&(n.node.children[e]=t.node,n.node.childCount++,pl(n))}var bE=/[\[\].#$\/\u0000-\u001F\u007F]/,AE=/[\[\].#$\u0000-\u001F\u007F]/,Ra=10*1024*1024,Mp=function(n){return typeof n=="string"&&n.length!==0&&!bE.test(n)},CE=function(n){return typeof n=="string"&&n.length!==0&&!AE.test(n)},RE=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),CE(n)};var Fp=function(n,e,t){let s=t instanceof J?new $a(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+En(s));if(typeof e=="function")throw new Error(n+"contains a function "+En(s)+" with contents = "+e.toString());if(Lf(e))throw new Error(n+"contains "+e.toString()+" "+En(s));if(typeof e=="string"&&e.length>Ra/3&&Ds(e)>Ra)throw new Error(n+"contains a string greater than "+Ra+" utf8 bytes "+En(s)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let r=!1,o=!1;if(ot(e,(a,l)=>{if(a===".value")r=!0;else if(a!==".priority"&&a!==".sv"&&(o=!0,!Mp(a)))throw new Error(n+" contains an invalid key ("+a+") "+En(s)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);vw(s,a),Fp(n,l,s),ww(s)}),r&&o)throw new Error(n+' contains ".value" child '+En(s)+" in addition to actual children.")}};var PE=function(n,e){let t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Mp(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!RE(t))throw new Error(eh(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var ml=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function NE(n,e){let t=null;for(let s=0;s<e.length;s++){let r=e[s],o=r.getPath();t!==null&&!ip(o,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:o}),t.events.push(r)}t&&n.eventLists_.push(t)}function Cn(n,e,t){NE(n,t),kE(n,s=>ht(s,e)||ht(e,s))}function kE(n,e){n.recursionDepth_++;let t=!0;for(let s=0;s<n.eventLists_.length;s++){let r=n.eventLists_[s];if(r){let o=r.path;e(o)?(DE(n.eventLists_[s]),n.eventLists_[s]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function DE(n){for(let e=0;e<n.events.length;e++){let t=n.events[e];if(t!==null){n.events[e]=null;let s=t.getEventRunner();In&&Ve("event: "+t.toString()),rr(s)}}}var xE="repo_interrupt",OE=25,gl=class{constructor(e,t,s,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=s,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new ml,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=vi(),this.transactionQueueTree_=new tr,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function ME(n,e,t){if(n.stats_=Tl(n.repoInfo_),n.forceRestClient_||Hv())n.server_=new Ja(n.repoInfo_,(s,r,o,a)=>{xf(n,s,r,o,a)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>Of(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{_e(t)}catch(s){throw new Error("Invalid authOverride provided: "+s)}}n.persistentConnection_=new Il(n.repoInfo_,e,(s,r,o,a)=>{xf(n,s,r,o,a)},s=>{Of(n,s)},s=>{VE(n,s)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(s=>{n.server_.refreshAuthToken(s)}),n.appCheckProvider_.addTokenChangeListener(s=>{n.server_.refreshAppCheckToken(s.token)}),n.statsReporter_=Yv(n.repoInfo_,()=>new nl(n.stats_,n.server_)),n.infoData_=new Za,n.infoSyncTree_=new Ii({startListening:(s,r,o,a)=>{let l=[],h=n.infoData_.getNode(s._path);return h.isEmpty()||(l=Si(n.infoSyncTree_,s._path,h),setTimeout(()=>{a("ok")},0)),l},stopListening:()=>{}}),Nl(n,"connected",!1),n.serverSyncTree_=new Ii({startListening:(s,r,o,a)=>(n.server_.listen(s,o,r,(l,h)=>{let d=a(l,h);Cn(n.eventQueue_,s._path,d)}),[]),stopListening:(s,r)=>{n.server_.unlisten(s,r)}})}function FE(n){let t=n.infoData_.getNode(new J(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function Vp(n){return _E({timestamp:FE(n)})}function xf(n,e,t,s,r){n.dataUpdateCount++;let o=new J(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let a=[];if(r)if(s){let h=ks(t,d=>Le(d));a=gE(n.serverSyncTree_,o,h,r)}else{let h=Le(t);a=mE(n.serverSyncTree_,o,h,r)}else if(s){let h=ks(t,d=>Le(d));a=pE(n.serverSyncTree_,o,h)}else{let h=Le(t);a=Si(n.serverSyncTree_,o,h)}let l=o;a.length>0&&(l=Dl(n,o)),Cn(n.eventQueue_,l,a)}function Of(n,e){Nl(n,"connected",e),e===!1&&UE(n)}function VE(n,e){ot(e,(t,s)=>{Nl(n,t,s)})}function Nl(n,e,t){let s=new J("/.info/"+e),r=Le(t);n.infoData_.updateSnapshot(s,r);let o=Si(n.infoSyncTree_,s,r);Cn(n.eventQueue_,s,o)}function LE(n){return n.nextWriteId_++}function UE(n){Lp(n,"onDisconnectEvents");let e=Vp(n),t=vi();el(n.onDisconnect_,Y(),(r,o)=>{let a=wE(r,o,n.serverSyncTree_,e);hp(t,r,a)});let s=[];el(t,Y(),(r,o)=>{s=s.concat(Si(n.serverSyncTree_,r,o));let a=jE(n,r);Dl(n,a)}),n.onDisconnect_=vi(),Cn(n.eventQueue_,Y(),s)}function BE(n){n.persistentConnection_&&n.persistentConnection_.interrupt(xE)}function Lp(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Ve(t,...e)}function Up(n,e,t){return Ap(n.serverSyncTree_,e,t)||ie.EMPTY_NODE}function kl(n,e=n.transactionQueueTree_){if(e||Ci(n,e),us(e)){let t=qp(n,e);k(t.length>0,"Sending zero length transaction queue"),t.every(r=>r.status===0)&&qE(n,or(e),t)}else xp(e)&&Ai(e,t=>{kl(n,t)})}function qE(n,e,t){let s=t.map(d=>d.currentWriteId),r=Up(n,e,s),o=r,a=r.hash();for(let d=0;d<t.length;d++){let m=t[d];k(m.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),m.status=1,m.retryCount++;let g=rt(e,m.path);o=o.updateChild(g,m.currentOutputSnapshotRaw)}let l=o.val(!0),h=e;n.server_.put(h.toString(),l,d=>{Lp(n,"transaction put response",{path:h.toString(),status:d});let m=[];if(d==="ok"){let g=[];for(let T=0;T<t.length;T++)t[T].status=2,m=m.concat(Zn(n.serverSyncTree_,t[T].currentWriteId)),t[T].onComplete&&g.push(()=>t[T].onComplete(null,!0,t[T].currentOutputSnapshotResolved)),t[T].unwatcher();Ci(n,Pl(n.transactionQueueTree_,e)),kl(n,n.transactionQueueTree_),Cn(n.eventQueue_,e,m);for(let T=0;T<g.length;T++)rr(g[T])}else{if(d==="datastale")for(let g=0;g<t.length;g++)t[g].status===3?t[g].status=4:t[g].status=0;else{Ze("transaction at "+h.toString()+" failed: "+d);for(let g=0;g<t.length;g++)t[g].status=4,t[g].abortReason=d}Dl(n,e)}},a)}function Dl(n,e){let t=Bp(n,e),s=or(t),r=qp(n,t);return $E(n,r,s),s}function $E(n,e,t){if(e.length===0)return;let s=[],r=[],a=e.filter(l=>l.status===0).map(l=>l.currentWriteId);for(let l=0;l<e.length;l++){let h=e[l],d=rt(t,h.path),m=!1,g;if(k(d!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),h.status===4)m=!0,g=h.abortReason,r=r.concat(Zn(n.serverSyncTree_,h.currentWriteId,!0));else if(h.status===0)if(h.retryCount>=OE)m=!0,g="maxretry",r=r.concat(Zn(n.serverSyncTree_,h.currentWriteId,!0));else{let T=Up(n,h.path,a);h.currentInputSnapshot=T;let C=e[l].update(T.val());if(C!==void 0){Fp("transaction failed: Data returned ",C,h.path);let A=Le(C);typeof C=="object"&&C!=null&&gt(C,".priority")||(A=A.updatePriority(T.getPriority()));let P=h.currentWriteId,F=Vp(n),U=EE(A,T,F);h.currentOutputSnapshotRaw=A,h.currentOutputSnapshotResolved=U,h.currentWriteId=LE(n),a.splice(a.indexOf(P),1),r=r.concat(fE(n.serverSyncTree_,h.path,U,h.currentWriteId,h.applyLocally)),r=r.concat(Zn(n.serverSyncTree_,P,!0))}else m=!0,g="nodata",r=r.concat(Zn(n.serverSyncTree_,h.currentWriteId,!0))}Cn(n.eventQueue_,t,r),r=[],m&&(e[l].status=2,function(T){setTimeout(T,Math.floor(0))}(e[l].unwatcher),e[l].onComplete&&(g==="nodata"?s.push(()=>e[l].onComplete(null,!1,e[l].currentInputSnapshot)):s.push(()=>e[l].onComplete(new Error(g),!1,null))))}Ci(n,n.transactionQueueTree_);for(let l=0;l<s.length;l++)rr(s[l]);kl(n,n.transactionQueueTree_)}function Bp(n,e){let t,s=n.transactionQueueTree_;for(t=K(e);t!==null&&us(s)===void 0;)s=Pl(s,t),e=se(e),t=K(e);return s}function qp(n,e){let t=[];return $p(n,e,t),t.sort((s,r)=>s.order-r.order),t}function $p(n,e,t){let s=us(e);if(s)for(let r=0;r<s.length;r++)t.push(s[r]);Ai(e,r=>{$p(n,r,t)})}function Ci(n,e){let t=us(e);if(t){let s=0;for(let r=0;r<t.length;r++)t[r].status!==2&&(t[s]=t[r],s++);t.length=s,Dp(e,t.length>0?t:void 0)}Ai(e,s=>{Ci(n,s)})}function jE(n,e){let t=or(Bp(n,e)),s=Pl(n.transactionQueueTree_,e);return IE(s,r=>{Pa(n,r)}),Pa(n,s),Op(s,r=>{Pa(n,r)}),t}function Pa(n,e){let t=us(e);if(t){let s=[],r=[],o=-1;for(let a=0;a<t.length;a++)t[a].status===3||(t[a].status===1?(k(o===a-1,"All SENT items should be at beginning of queue."),o=a,t[a].status=3,t[a].abortReason="set"):(k(t[a].status===0,"Unexpected transaction status in abort"),t[a].unwatcher(),r=r.concat(Zn(n.serverSyncTree_,t[a].currentWriteId,!0)),t[a].onComplete&&s.push(t[a].onComplete.bind(null,new Error("set"),!1,null))));o===-1?Dp(e,void 0):t.length=o+1,Cn(n.eventQueue_,or(e),r);for(let a=0;a<s.length;a++)rr(s[a])}}function zE(n){let e="",t=n.split("/");for(let s=0;s<t.length;s++)if(t[s].length>0){let r=t[s];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}e+="/"+r}return e}function GE(n){let e={};n.charAt(0)==="?"&&(n=n.substring(1));for(let t of n.split("&")){if(t.length===0)continue;let s=t.split("=");s.length===2?e[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):Ze(`Invalid query segment '${t}' in query '${n}'`)}return e}var Mf=function(n,e){let t=KE(n),s=t.namespace;t.domain==="firebase.com"&&xt(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!s||s==="undefined")&&t.domain!=="localhost"&&xt("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||Bv();let r=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new di(t.host,t.secure,s,r,e,"",s!==t.subdomain),path:new J(t.pathString)}},KE=function(n){let e="",t="",s="",r="",o="",a=!0,l="https",h=443;if(typeof n=="string"){let d=n.indexOf("//");d>=0&&(l=n.substring(0,d-1),n=n.substring(d+2));let m=n.indexOf("/");m===-1&&(m=n.length);let g=n.indexOf("?");g===-1&&(g=n.length),e=n.substring(0,Math.min(m,g)),m<g&&(r=zE(n.substring(m,g)));let T=GE(n.substring(Math.min(n.length,g)));d=e.indexOf(":"),d>=0?(a=l==="https"||l==="wss",h=parseInt(e.substring(d+1),10)):d=e.length;let C=e.slice(0,d);if(C.toLowerCase()==="localhost")t="localhost";else if(C.split(".").length<=2)t=C;else{let A=e.indexOf(".");s=e.substring(0,A).toLowerCase(),t=e.substring(A+1),o=s}"ns"in T&&(o=T.ns)}return{host:e,port:h,domain:t,subdomain:s,secure:a,scheme:l,pathString:r,namespace:o}};var _l=class n{constructor(e,t,s,r){this._repo=e,this._path=t,this._queryParams=s,this._orderByCalled=r}get key(){return z(this._path)?null:np(this._path)}get ref(){return new ls(this._repo,this._path)}get _queryIdentifier(){let e=Ef(this._queryParams),t=El(e);return t==="{}"?"default":t}get _queryObject(){return Ef(this._queryParams)}isEqual(e){if(e=de(e),!(e instanceof n))return!1;let t=this._repo===e._repo,s=ip(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return t&&s&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+yw(this._path)}};var ls=class n extends _l{constructor(e,t){super(e,t,new Xa,!1)}get parent(){let e=rp(this._path);return e===null?null:new n(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}};hE(ls);dE(ls);var WE="FIREBASE_DATABASE_EMULATOR_HOST",yl={},HE=!1;function QE(n,e,t,s){n.repoInfo_=new di(e,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0,t),s&&(n.authTokenProvider_=s)}function YE(n,e,t,s,r){let o=s||n.options.databaseURL;o===void 0&&(n.options.projectId||xt("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Ve("Using default host for project ",n.options.projectId),o=`${n.options.projectId}-default-rtdb.firebaseio.com`);let a=Mf(o,r),l=a.repoInfo,h,d;typeof process<"u"&&process.env&&(d=process.env[WE]),d?(h=!0,o=`http://${d}?ns=${l.namespace}`,a=Mf(o,r),l=a.repoInfo):h=!a.repoInfo.secure;let m=r&&h?new Ys(Ys.OWNER):new Ma(n.name,n.options,e);PE("Invalid Firebase Database URL",a),z(a.path)||xt("Database URL must point to the root of a Firebase Database (not including a child path).");let g=JE(l,n,m,new Oa(n,t));return new vl(g,n)}function XE(n,e){let t=yl[e];(!t||t[n.key]!==n)&&xt(`Database ${e}(${n.repoInfo_}) has already been deleted.`),BE(n),delete t[n.key]}function JE(n,e,t,s){let r=yl[e.name];r||(r={},yl[e.name]=r);let o=r[n.toURLString()];return o&&xt("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new gl(n,HE,t,s),r[n.toURLString()]=o,o}var vl=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(ME(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ls(this._repo,Y())),this._rootInternal}_delete(){return this._rootInternal!==null&&(XE(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&xt("Cannot call "+e+" on a deleted database.")}};function jp(n=Fe(),e){let t=Re(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){let s=zt("database");s&&zp(t,...s)}return t}function zp(n,e,t,s={}){n=de(n),n._checkNotDeleted("useEmulator");let r=`${e}:${t}`,o=n._repoInternal;if(n._instanceStarted){if(r===n._repoInternal.repoInfo_.host&&Kt(s,o.repoInfo_.emulatorOptions))return;xt("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let a;if(o.repoInfo_.nodeAdmin)s.mockUserToken&&xt('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),a=new Ys(Ys.OWNER);else if(s.mockUserToken){let l=typeof s.mockUserToken=="string"?s.mockUserToken:Bn(s.mockUserToken,n.app.options.projectId);a=new Ys(l)}QE(o,r,s,a)}function ZE(n){Vv(Ht),ve(new ye("database",(e,{instanceIdentifier:t})=>{let s=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return YE(s,r,o,t)},"PUBLIC").setMultipleInstances(!0)),V(nf,sf,n),V(nf,sf,"esm2017")}Il.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};Il.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};ZE();var ar=class{constructor(e){return e}},Gp="database",xl=class{constructor(){return Ee(Gp)}};var Ol=new me("angularfire2.database-instances");function eT(n,e){let t=we(Gp,n,e);return t&&new ar(t)}function tT(n){return(e,t)=>{let s=e.runOutsideAngular(()=>n(t));return new ar(s)}}var nT={provide:xl,deps:[[new $,Ol]]},sT={provide:ar,useFactory:eT,deps:[[new $,Ol],Ie]};function Kp(n,...e){return V("angularfire",fe.full,"rtdb"),ge([sT,nT,{provide:Ol,useFactory:tT(n),multi:!0,deps:[re,ue,Te,Se,[new $,Qt],[new $,yt],...e]}])}var Wp=he(jp,!0);var Yp="functions";var Ml=class{constructor(e,t,s,r){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,Pt(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=s.getImmediate({optional:!0}),this.auth||t.get().then(o=>this.auth=o,()=>{}),this.messaging||s.get().then(o=>this.messaging=o,()=>{}),this.appCheck||r?.get().then(o=>this.appCheck=o,()=>{})}getAuthToken(){return D(this,null,function*(){if(this.auth)try{let e=yield this.auth.getToken();return e?.accessToken}catch{return}})}getMessagingToken(){return D(this,null,function*(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return yield this.messaging.getToken()}catch{return}})}getAppCheckToken(e){return D(this,null,function*(){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){let t=e?yield this.appCheck.getLimitedUseToken():yield this.appCheck.getToken();return t.error?null:t.token}return null})}getContext(e){return D(this,null,function*(){let t=yield this.getAuthToken(),s=yield this.getMessagingToken(),r=yield this.getAppCheckToken(e);return{authToken:t,messagingToken:s,appCheckToken:r}})}};var Fl="us-central1";var Vl=class{constructor(e,t,s,r,o=Fl,a=(...l)=>fetch(...l)){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new Ml(e,t,s,r),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{let l=new URL(o);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=Fl}catch{this.customDomain=null,this.region=o}}_delete(){return this.deleteService()}_url(e){let t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}};function rT(n,e,t){n.emulatorOrigin=`http://${e}:${t}`}var Hp="@firebase/functions",Qp="0.12.3";var iT="auth-internal",oT="app-check-internal",aT="messaging-internal";function lT(n){let e=(t,{instanceIdentifier:s})=>{let r=t.getProvider("app").getImmediate(),o=t.getProvider(iT),a=t.getProvider(aT),l=t.getProvider(oT);return new Vl(r,o,a,l,s)};ve(new ye(Yp,e,"PUBLIC").setMultipleInstances(!0)),V(Hp,Qp,n),V(Hp,Qp,"esm2017")}function Xp(n=Fe(),e=Fl){let s=Re(de(n),Yp).getImmediate({identifier:e}),r=zt("functions");return r&&Jp(s,...r),s}function Jp(n,e,t){rT(de(n),e,t)}lT();var lr=class{constructor(e){return e}},Zp="functions",Ll=class{constructor(){return Ee(Zp)}};var Ul=new me("angularfire2.functions-instances");function cT(n,e){let t=we(Zp,n,e);return t&&new lr(t)}function uT(n){return(e,t)=>{let s=e.runOutsideAngular(()=>n(t));return new lr(s)}}var hT={provide:Ll,deps:[[new $,Ul]]},dT={provide:lr,useFactory:cT,deps:[[new $,Ul],Ie]};function em(n,...e){return V("angularfire",fe.full,"fn"),ge([dT,hT,{provide:Ul,useFactory:uT(n),multi:!0,deps:[re,ue,Te,Se,[new $,Qt],[new $,yt],...e]}])}var tm=he(Xp,!0);var fT="/firebase-messaging-sw.js",pT="/firebase-cloud-messaging-push-scope",lm="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",mT="https://fcmregistrations.googleapis.com/v1",cm="google.c.a.c_id",gT="google.c.a.c_l",_T="google.c.a.ts",yT="google.c.a.e",nm=1e4;var Ri=function(n){return n.PUSH_RECEIVED="push-received",n.NOTIFICATION_CLICKED="notification-clicked",n}(Ri||{});function Ot(n){let e=new Uint8Array(n);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function vT(n){let e="=".repeat((4-n.length%4)%4),t=(n+e).replace(/\-/g,"+").replace(/_/g,"/"),s=atob(t),r=new Uint8Array(s.length);for(let o=0;o<s.length;++o)r[o]=s.charCodeAt(o);return r}var Bl="fcm_token_details_db",wT=5,sm="fcm_token_object_Store";function ET(n){return D(this,null,function*(){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(o=>o.name).includes(Bl))return null;let e=null;return(yield go(Bl,wT,{upgrade:(s,r,o,a)=>D(this,null,function*(){var l;if(r<2||!s.objectStoreNames.contains(sm))return;let h=a.objectStore(sm),d=yield h.index("fcmSenderId").get(n);if(yield h.clear(),!!d){if(r===2){let m=d;if(!m.auth||!m.p256dh||!m.endpoint)return;e={token:m.fcmToken,createTime:(l=m.createTime)!==null&&l!==void 0?l:Date.now(),subscriptionOptions:{auth:m.auth,p256dh:m.p256dh,endpoint:m.endpoint,swScope:m.swScope,vapidKey:typeof m.vapidKey=="string"?m.vapidKey:Ot(m.vapidKey)}}}else if(r===3){let m=d;e={token:m.fcmToken,createTime:m.createTime,subscriptionOptions:{auth:Ot(m.auth),p256dh:Ot(m.p256dh),endpoint:m.endpoint,swScope:m.swScope,vapidKey:Ot(m.vapidKey)}}}else if(r===4){let m=d;e={token:m.fcmToken,createTime:m.createTime,subscriptionOptions:{auth:Ot(m.auth),p256dh:Ot(m.p256dh),endpoint:m.endpoint,swScope:m.swScope,vapidKey:Ot(m.vapidKey)}}}}})})).close(),yield xr(Bl),yield xr("fcm_vapid_details_db"),yield xr("undefined"),TT(e)?e:null})}function TT(n){if(!n||!n.subscriptionOptions)return!1;let{subscriptionOptions:e}=n;return typeof n.createTime=="number"&&n.createTime>0&&typeof n.token=="string"&&n.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}var IT="firebase-messaging-database",ST=1,cr="firebase-messaging-store",ql=null;function um(){return ql||(ql=go(IT,ST,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(cr)}}})),ql}function bT(n){return D(this,null,function*(){let e=hm(n),s=yield(yield um()).transaction(cr).objectStore(cr).get(e);if(s)return s;{let r=yield ET(n.appConfig.senderId);if(r)return yield zl(n,r),r}})}function zl(n,e){return D(this,null,function*(){let t=hm(n),r=(yield um()).transaction(cr,"readwrite");return yield r.objectStore(cr).put(e,t),yield r.done,e})}function hm({appConfig:n}){return n.appId}var AT={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},ze=new $n("messaging","Messaging",AT);function CT(n,e){return D(this,null,function*(){let t=yield Kl(n),s=dm(e),r={method:"POST",headers:t,body:JSON.stringify(s)},o;try{o=yield(yield fetch(Gl(n.appConfig),r)).json()}catch(a){throw ze.create("token-subscribe-failed",{errorInfo:a?.toString()})}if(o.error){let a=o.error.message;throw ze.create("token-subscribe-failed",{errorInfo:a})}if(!o.token)throw ze.create("token-subscribe-no-token");return o.token})}function RT(n,e){return D(this,null,function*(){let t=yield Kl(n),s=dm(e.subscriptionOptions),r={method:"PATCH",headers:t,body:JSON.stringify(s)},o;try{o=yield(yield fetch(`${Gl(n.appConfig)}/${e.token}`,r)).json()}catch(a){throw ze.create("token-update-failed",{errorInfo:a?.toString()})}if(o.error){let a=o.error.message;throw ze.create("token-update-failed",{errorInfo:a})}if(!o.token)throw ze.create("token-update-no-token");return o.token})}function PT(n,e){return D(this,null,function*(){let s={method:"DELETE",headers:yield Kl(n)};try{let o=yield(yield fetch(`${Gl(n.appConfig)}/${e}`,s)).json();if(o.error){let a=o.error.message;throw ze.create("token-unsubscribe-failed",{errorInfo:a})}}catch(r){throw ze.create("token-unsubscribe-failed",{errorInfo:r?.toString()})}})}function Gl({projectId:n}){return`${mT}/projects/${n}/registrations`}function Kl(t){return D(this,arguments,function*({appConfig:n,installations:e}){let s=yield e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":`FIS ${s}`})})}function dm({p256dh:n,auth:e,endpoint:t,vapidKey:s}){let r={web:{endpoint:t,auth:e,p256dh:n}};return s!==lm&&(r.web.applicationPubKey=s),r}var NT=7*24*60*60*1e3;function kT(n){return D(this,null,function*(){let e=yield xT(n.swRegistration,n.vapidKey),t={vapidKey:n.vapidKey,swScope:n.swRegistration.scope,endpoint:e.endpoint,auth:Ot(e.getKey("auth")),p256dh:Ot(e.getKey("p256dh"))},s=yield bT(n.firebaseDependencies);if(s){if(OT(s.subscriptionOptions,t))return Date.now()>=s.createTime+NT?DT(n,{token:s.token,createTime:Date.now(),subscriptionOptions:t}):s.token;try{yield PT(n.firebaseDependencies,s.token)}catch(r){console.warn(r)}return rm(n.firebaseDependencies,t)}else return rm(n.firebaseDependencies,t)})}function DT(n,e){return D(this,null,function*(){try{let t=yield RT(n.firebaseDependencies,e),s=Object.assign(Object.assign({},e),{token:t,createTime:Date.now()});return yield zl(n.firebaseDependencies,s),t}catch(t){throw t}})}function rm(n,e){return D(this,null,function*(){let s={token:yield CT(n,e),createTime:Date.now(),subscriptionOptions:e};return yield zl(n,s),s.token})}function xT(n,e){return D(this,null,function*(){let t=yield n.pushManager.getSubscription();return t||n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:vT(e)})})}function OT(n,e){let t=e.vapidKey===n.vapidKey,s=e.endpoint===n.endpoint,r=e.auth===n.auth,o=e.p256dh===n.p256dh;return t&&s&&r&&o}function im(n){let e={from:n.from,collapseKey:n.collapse_key,messageId:n.fcmMessageId};return MT(e,n),FT(e,n),VT(e,n),e}function MT(n,e){if(!e.notification)return;n.notification={};let t=e.notification.title;t&&(n.notification.title=t);let s=e.notification.body;s&&(n.notification.body=s);let r=e.notification.image;r&&(n.notification.image=r);let o=e.notification.icon;o&&(n.notification.icon=o)}function FT(n,e){e.data&&(n.data=e.data)}function VT(n,e){var t,s,r,o,a;if(!e.fcmOptions&&!(!((t=e.notification)===null||t===void 0)&&t.click_action))return;n.fcmOptions={};let l=(r=(s=e.fcmOptions)===null||s===void 0?void 0:s.link)!==null&&r!==void 0?r:(o=e.notification)===null||o===void 0?void 0:o.click_action;l&&(n.fcmOptions.link=l);let h=(a=e.fcmOptions)===null||a===void 0?void 0:a.analytics_label;h&&(n.fcmOptions.analyticsLabel=h)}function LT(n){return typeof n=="object"&&!!n&&cm in n}UT("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");function UT(n,e){let t=[];for(let s=0;s<n.length;s++)t.push(n.charAt(s)),s<e.length&&t.push(e.charAt(s));return t.join("")}function BT(n){if(!n||!n.options)throw $l("App Configuration Object");if(!n.name)throw $l("App Name");let e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=n;for(let s of e)if(!t[s])throw $l(s);return{appName:n.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}function $l(n){return ze.create("missing-app-config-values",{valueName:n})}var jl=class{constructor(e,t,s){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;let r=BT(e);this.firebaseDependencies={app:e,appConfig:r,installations:t,analyticsProvider:s}}_delete(){return Promise.resolve()}};function qT(n){return D(this,null,function*(){try{n.swRegistration=yield navigator.serviceWorker.register(fT,{scope:pT}),n.swRegistration.update().catch(()=>{}),yield $T(n.swRegistration)}catch(e){throw ze.create("failed-service-worker-registration",{browserErrorMessage:e?.message})}})}function $T(n){return D(this,null,function*(){return new Promise((e,t)=>{let s=setTimeout(()=>t(new Error(`Service worker not registered after ${nm} ms`)),nm),r=n.installing||n.waiting;n.active?(clearTimeout(s),e()):r?r.onstatechange=o=>{var a;((a=o.target)===null||a===void 0?void 0:a.state)==="activated"&&(r.onstatechange=null,clearTimeout(s),e())}:(clearTimeout(s),t(new Error("No incoming service worker found.")))})})}function jT(n,e){return D(this,null,function*(){if(!e&&!n.swRegistration&&(yield qT(n)),!(!e&&n.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw ze.create("invalid-sw-registration");n.swRegistration=e}})}function zT(n,e){return D(this,null,function*(){e?n.vapidKey=e:n.vapidKey||(n.vapidKey=lm)})}function GT(n,e){return D(this,null,function*(){if(!navigator)throw ze.create("only-available-in-window");if(Notification.permission==="default"&&(yield Notification.requestPermission()),Notification.permission!=="granted")throw ze.create("permission-blocked");return yield zT(n,e?.vapidKey),yield jT(n,e?.serviceWorkerRegistration),kT(n)})}function KT(n,e,t){return D(this,null,function*(){let s=WT(e);(yield n.firebaseDependencies.analyticsProvider.get()).logEvent(s,{message_id:t[cm],message_name:t[gT],message_time:t[_T],message_device_time:Math.floor(Date.now()/1e3)})})}function WT(n){switch(n){case Ri.NOTIFICATION_CLICKED:return"notification_open";case Ri.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function HT(n,e){return D(this,null,function*(){let t=e.data;if(!t.isFirebaseMessaging)return;n.onMessageHandler&&t.messageType===Ri.PUSH_RECEIVED&&(typeof n.onMessageHandler=="function"?n.onMessageHandler(im(t)):n.onMessageHandler.next(im(t)));let s=t.data;LT(s)&&s[yT]==="1"&&(yield KT(n,t.messageType,s))})}var om="@firebase/messaging",am="0.12.17";var QT=n=>{let e=new jl(n.getProvider("app").getImmediate(),n.getProvider("installations-internal").getImmediate(),n.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",t=>HT(e,t)),e},YT=n=>{let e=n.getProvider("messaging").getImmediate();return{getToken:s=>GT(e,s)}};function XT(){ve(new ye("messaging",QT,"PUBLIC")),ve(new ye("messaging-internal",YT,"PRIVATE")),V(om,am),V(om,am,"esm2017")}function fm(){return D(this,null,function*(){try{yield qn()}catch{return!1}return typeof window<"u"&&Gt()&&Ns()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})}function pm(n=Fe()){return fm().then(e=>{if(!e)throw ze.create("unsupported-browser")},e=>{throw ze.create("indexed-db-unsupported")}),Re(de(n),"messaging").getImmediate()}XT();var ur=class{constructor(e){return e}},mm="messaging",Wl=class{constructor(){return Ee(mm)}};var Hl=new me("angularfire2.messaging-instances");function JT(n,e,t){if(Fn(t))return null;let s=we(mm,n,e);return s&&new ur(s)}function ZT(n){return(e,t,s)=>{if(Fn(s))return null;let r=e.runOutsideAngular(()=>n(t));return new ur(r)}}var eI={provide:Wl,deps:[[new $,Hl]]},tI={provide:ur,useFactory:JT,deps:[[new $,Hl],Ie,nt]};function gm(n,...e){return V("angularfire",fe.full,"fcm"),ge([tI,eI,{provide:Hl,useFactory:ZT(n),multi:!0,deps:[re,ue,nt,Te,Se,...e]}])}var _m=he(pm,!0);var hr=class{constructor(e){return e}},ym="performance",Ql=class{constructor(){return Ee(ym)}};var Yl=new me("angularfire2.performance-instances");function nI(n,e,t){if(!Mn(t))return null;let s=we(ym,n,e);return s&&new hr(s)}function sI(n){return(e,t,s)=>{if(!Mn(t))return null;let r=e.runOutsideAngular(()=>n(s));return new hr(r)}}var rI={provide:Ql,deps:[[new $,Yl]]},iI={provide:hr,useFactory:nI,deps:[[new $,Yl],Ie,nt]};function vm(n,...e){return V("angularfire",fe.full,"perf"),ge([iI,rI,{provide:Yl,useFactory:sI(n),multi:!0,deps:[re,nt,ue,Te,Se,...e]}])}var wm=he(ph,!0);var Am="firebasestorage.googleapis.com",oI="storageBucket",aI=2*60*1e3,lI=10*60*1e3;var Tt=class n extends mt{constructor(e,t,s=0){super(Xl(e),`Firebase Storage: ${t} (${Xl(e)})`),this.status_=s,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,n.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Xl(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},Ft=function(n){return n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment",n}(Ft||{});function Xl(n){return"storage/"+n}function cI(){let n="An unknown error occurred, please check the error payload for server response.";return new Tt(Ft.UNKNOWN,n)}function uI(){return new Tt(Ft.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function hI(){return new Tt(Ft.CANCELED,"User canceled the upload/download.")}function dI(n){return new Tt(Ft.INVALID_URL,"Invalid URL '"+n+"'.")}function fI(n){return new Tt(Ft.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function Em(n){return new Tt(Ft.INVALID_ARGUMENT,n)}function Cm(){return new Tt(Ft.APP_DELETED,"The Firebase app was deleted.")}function pI(n){return new Tt(Ft.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}var Mt=class n{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let s;try{s=n.makeFromUrl(e,t)}catch{return new n(e,"")}if(s.path==="")return s;throw fI(e)}static makeFromUrl(e,t){let s=null,r="([A-Za-z0-9.\\-_]+)";function o(L){L.path.charAt(L.path.length-1)==="/"&&(L.path_=L.path_.slice(0,-1))}let a="(/(.*))?$",l=new RegExp("^gs://"+r+a,"i"),h={bucket:1,path:3};function d(L){L.path_=decodeURIComponent(L.path)}let m="v[A-Za-z0-9_]+",g=t.replace(/[.]/g,"\\."),T="(/([^?#]*).*)?$",C=new RegExp(`^https?://${g}/${m}/b/${r}/o${T}`,"i"),A={bucket:1,path:3},R=t===Am?"(?:storage.googleapis.com|storage.cloud.google.com)":t,P="([^?#]*)",F=new RegExp(`^https?://${R}/${r}/${P}`,"i"),B=[{regex:l,indices:h,postModify:o},{regex:C,indices:A,postModify:d},{regex:F,indices:{bucket:1,path:2},postModify:d}];for(let L=0;L<B.length;L++){let ke=B[L],Z=ke.regex.exec(e);if(Z){let w=Z[ke.indices.bucket],p=Z[ke.indices.path];p||(p=""),s=new n(w,p),ke.postModify(s);break}}if(s==null)throw dI(e);return s}},Jl=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function mI(n,e,t){let s=1,r=null,o=null,a=!1,l=0;function h(){return l===2}let d=!1;function m(...P){d||(d=!0,e.apply(null,P))}function g(P){r=setTimeout(()=>{r=null,n(C,h())},P)}function T(){o&&clearTimeout(o)}function C(P,...F){if(d){T();return}if(P){T(),m.call(null,P,...F);return}if(h()||a){T(),m.call(null,P,...F);return}s<64&&(s*=2);let B;l===1?(l=2,B=0):B=(s+Math.random())*1e3,g(B)}let A=!1;function R(P){A||(A=!0,T(),!d&&(r!==null?(P||(l=2),clearTimeout(r),g(0)):P||(l=1)))}return g(0),o=setTimeout(()=>{a=!0,R(!0)},t),R}function gI(n){n(!1)}function _I(n){return n!==void 0}function Tm(n,e,t,s){if(s<e)throw Em(`Invalid value for '${n}'. Expected ${e} or greater.`);if(s>t)throw Em(`Invalid value for '${n}'. Expected ${t} or less.`)}function yI(n){let e=encodeURIComponent,t="?";for(let s in n)if(n.hasOwnProperty(s)){let r=e(s)+"="+e(n[s]);t=t+r+"&"}return t=t.slice(0,-1),t}var Zl=function(n){return n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",n}(Zl||{});function vI(n,e){let t=n>=500&&n<600,r=[408,429].indexOf(n)!==-1,o=e.indexOf(n)!==-1;return t||r||o}var ec=class{constructor(e,t,s,r,o,a,l,h,d,m,g,T=!0){this.url_=e,this.method_=t,this.headers_=s,this.body_=r,this.successCodes_=o,this.additionalRetryCodes_=a,this.callback_=l,this.errorCallback_=h,this.timeout_=d,this.progressCallback_=m,this.connectionFactory_=g,this.retry=T,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((C,A)=>{this.resolve_=C,this.reject_=A,this.start_()})}start_(){let e=(s,r)=>{if(r){s(!1,new hs(!1,null,!0));return}let o=this.connectionFactory_();this.pendingConnection_=o;let a=l=>{let h=l.loaded,d=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(h,d)};this.progressCallback_!==null&&o.addUploadProgressListener(a),o.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&o.removeUploadProgressListener(a),this.pendingConnection_=null;let l=o.getErrorCode()===Zl.NO_ERROR,h=o.getStatus();if(!l||vI(h,this.additionalRetryCodes_)&&this.retry){let m=o.getErrorCode()===Zl.ABORT;s(!1,new hs(!1,null,m));return}let d=this.successCodes_.indexOf(h)!==-1;s(!0,new hs(d,o))})},t=(s,r)=>{let o=this.resolve_,a=this.reject_,l=r.connection;if(r.wasSuccessCode)try{let h=this.callback_(l,l.getResponse());_I(h)?o(h):o()}catch(h){a(h)}else if(l!==null){let h=cI();h.serverResponse=l.getErrorText(),this.errorCallback_?a(this.errorCallback_(l,h)):a(h)}else if(r.canceled){let h=this.appDelete_?Cm():hI();a(h)}else{let h=uI();a(h)}};this.canceled_?t(!1,new hs(!1,null,!0)):this.backoffId_=mI(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&gI(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},hs=class{constructor(e,t,s){this.wasSuccessCode=e,this.connection=t,this.canceled=!!s}};function wI(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function EI(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function TI(n,e){e&&(n["X-Firebase-GMPID"]=e)}function II(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function SI(n,e,t,s,r,o,a=!0){let l=yI(n.urlParams),h=n.url+l,d=Object.assign({},n.headers);return TI(d,e),wI(d,t),EI(d,o),II(d,s),new ec(h,n.method,d,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,r,a)}function bI(n){if(n.length===0)return null;let e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function AI(n){let e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}var nR=256*1024;var tc=class n{constructor(e,t){this._service=e,t instanceof Mt?this._location=t:this._location=Mt.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new n(e,t)}get root(){let e=new Mt(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return AI(this._location.path)}get storage(){return this._service}get parent(){let e=bI(this._location.path);if(e===null)return null;let t=new Mt(this._location.bucket,e);return new n(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw pI(e)}};function Im(n,e){let t=e?.[oI];return t==null?null:Mt.makeFromBucketSpec(t,n)}function CI(n,e,t,s={}){n.host=`${e}:${t}`,n._protocol="http";let{mockUserToken:r}=s;r&&(n._overrideAuthToken=typeof r=="string"?r:Bn(r,n.app.options.projectId))}var nc=class{constructor(e,t,s,r,o){this.app=e,this._authProvider=t,this._appCheckProvider=s,this._url=r,this._firebaseVersion=o,this._bucket=null,this._host=Am,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=aI,this._maxUploadRetryTime=lI,this._requests=new Set,r!=null?this._bucket=Mt.makeFromBucketSpec(r,this._host):this._bucket=Im(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Mt.makeFromBucketSpec(this._url,e):this._bucket=Im(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Tm("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Tm("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return D(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let t=yield e.getToken();if(t!==null)return t.accessToken}return null})}_getAppCheckToken(){return D(this,null,function*(){if(Pt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new tc(this,e)}_makeRequest(e,t,s,r,o=!0){if(this._deleted)return new Jl(Cm());{let a=SI(e,this._appId,s,r,t,this._firebaseVersion,o);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}makeRequestWithTokens(e,t){return D(this,null,function*(){let[s,r]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,s,r).getPromise()})}},Sm="@firebase/storage",bm="0.13.7";var Rm="storage";function Pm(n=Fe(),e){n=de(n);let s=Re(n,Rm).getImmediate({identifier:e}),r=zt("storage");return r&&Nm(s,...r),s}function Nm(n,e,t,s={}){CI(n,e,t,s)}function RI(n,{instanceIdentifier:e}){let t=n.getProvider("app").getImmediate(),s=n.getProvider("auth-internal"),r=n.getProvider("app-check-internal");return new nc(t,s,r,e,Ht)}function PI(){ve(new ye(Rm,RI,"PUBLIC").setMultipleInstances(!0)),V(Sm,bm,""),V(Sm,bm,"esm2017")}PI();var dr=class{constructor(e){return e}},km="storage",sc=class{constructor(){return Ee(km)}};var rc=new me("angularfire2.storage-instances");function NI(n,e){let t=we(km,n,e);return t&&new dr(t)}function kI(n){return(e,t)=>{let s=e.runOutsideAngular(()=>n(t));return new dr(s)}}var DI={provide:sc,deps:[[new $,rc]]},xI={provide:dr,useFactory:NI,deps:[[new $,rc],Ie]};function Dm(n,...e){return V("angularfire",fe.full,"gcs"),ge([xI,DI,{provide:rc,useFactory:kI(n),multi:!0,deps:[re,ue,Te,Se,[new $,Qt],[new $,yt],...e]}])}var xm=he(Pm,!0);var ic="@firebase/remote-config",Om="0.6.0";var Fm="remote-config",Mm=100;var OI={"already-initialized":"Remote Config already initialized","registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser","custom-signal-max-allowed-signals":"Setting more than {$maxSignals} custom signals is not supported."},He=new $n("remoteconfig","Remote Config",OI);function Vm(n=Fe(),e={}){var t,s;n=de(n);let r=Re(n,Fm);if(r.isInitialized()){let a=r.getOptions();if(Kt(a,e))return r.getImmediate();throw He.create("already-initialized")}r.initialize({options:e});let o=r.getImmediate();return e.initialFetchResponse&&(o._initializePromise=Promise.all([o._storage.setLastSuccessfulFetchResponse(e.initialFetchResponse),o._storage.setActiveConfigEtag(((t=e.initialFetchResponse)===null||t===void 0?void 0:t.eTag)||""),o._storageCache.setLastSuccessfulFetchTimestampMillis(Date.now()),o._storageCache.setLastFetchStatus("success"),o._storageCache.setActiveConfig(((s=e.initialFetchResponse)===null||s===void 0?void 0:s.config)||{})]).then(),o._isInitializationComplete=!0),o}function Lm(n){let e=de(n);return e._initializePromise||(e._initializePromise=e._storageCache.loadFromStorage().then(()=>{e._isInitializationComplete=!0})),e._initializePromise}var oc=class{constructor(e,t,s,r){this.client=e,this.storage=t,this.storageCache=s,this.logger=r}isCachedDataFresh(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;let s=Date.now()-t,r=s<=e;return this.logger.debug(`Config fetch cache check. Cache age millis: ${s}. Cache max age millis (minimumFetchIntervalMillis setting): ${e}. Is cache hit: ${r}.`),r}fetch(e){return D(this,null,function*(){let[t,s]=yield Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()]);if(s&&this.isCachedDataFresh(e.cacheMaxAgeMillis,t))return s;e.eTag=s&&s.eTag;let r=yield this.client.fetch(e),o=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return r.status===200&&o.push(this.storage.setLastSuccessfulFetchResponse(r)),yield Promise.all(o),r})}};function MI(n=navigator){return n.languages&&n.languages[0]||n.language}var ac=class{constructor(e,t,s,r,o,a){this.firebaseInstallations=e,this.sdkVersion=t,this.namespace=s,this.projectId=r,this.apiKey=o,this.appId=a}fetch(e){return D(this,null,function*(){let[t,s]=yield Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()]),o=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${this.projectId}/namespaces/${this.namespace}:fetch?key=${this.apiKey}`,a={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},l={sdk_version:this.sdkVersion,app_instance_id:t,app_instance_id_token:s,app_id:this.appId,language_code:MI(),custom_signals:e.customSignals},h={method:"POST",headers:a,body:JSON.stringify(l)},d=fetch(o,h),m=new Promise((P,F)=>{e.signal.addEventListener(()=>{let U=new Error("The operation was aborted.");U.name="AbortError",F(U)})}),g;try{yield Promise.race([d,m]),g=yield d}catch(P){let F="fetch-client-network";throw P?.name==="AbortError"&&(F="fetch-timeout"),He.create(F,{originalErrorMessage:P?.message})}let T=g.status,C=g.headers.get("ETag")||void 0,A,R;if(g.status===200){let P;try{P=yield g.json()}catch(F){throw He.create("fetch-client-parse",{originalErrorMessage:F?.message})}A=P.entries,R=P.state}if(R==="INSTANCE_STATE_UNSPECIFIED"?T=500:R==="NO_CHANGE"?T=304:(R==="NO_TEMPLATE"||R==="EMPTY_CONFIG")&&(A={}),T!==304&&T!==200)throw He.create("fetch-status",{httpStatus:T});return{status:T,eTag:C,config:A}})}};function FI(n,e){return new Promise((t,s)=>{let r=Math.max(e-Date.now(),0),o=setTimeout(t,r);n.addEventListener(()=>{clearTimeout(o),s(He.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function VI(n){if(!(n instanceof mt)||!n.customData)return!1;let e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}var lc=class{constructor(e,t){this.client=e,this.storage=t}fetch(e){return D(this,null,function*(){let t=(yield this.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return this.attemptFetch(e,t)})}attemptFetch(r,o){return D(this,arguments,function*(e,{throttleEndTimeMillis:t,backoffCount:s}){yield FI(e.signal,t);try{let a=yield this.client.fetch(e);return yield this.storage.deleteThrottleMetadata(),a}catch(a){if(!VI(a))throw a;let l={throttleEndTimeMillis:Date.now()+xs(s),backoffCount:s+1};return yield this.storage.setThrottleMetadata(l),this.attemptFetch(e,l)}})}};var LI=60*1e3,UI=12*60*60*1e3,cc=class{get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}constructor(e,t,s,r,o){this.app=e,this._client=t,this._storageCache=s,this._storage=r,this._logger=o,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:LI,minimumFetchIntervalMillis:UI},this.defaultConfig={}}};function Pi(n,e){let t=n.target.error||void 0;return He.create(e,{originalErrorMessage:t&&t?.message})}var tn="app_namespace_store",BI="firebase_remote_config",qI=1;function $I(){return new Promise((n,e)=>{try{let t=indexedDB.open(BI,qI);t.onerror=s=>{e(Pi(s,"storage-open"))},t.onsuccess=s=>{n(s.target.result)},t.onupgradeneeded=s=>{let r=s.target.result;switch(s.oldVersion){case 0:r.createObjectStore(tn,{keyPath:"compositeKey"})}}}catch(t){e(He.create("storage-open",{originalErrorMessage:t?.message}))}})}var Ni=class{getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(e){return this.set("last_fetch_status",e)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(e){return this.set("last_successful_fetch_timestamp_millis",e)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(e){return this.set("last_successful_fetch_response",e)}getActiveConfig(){return this.get("active_config")}setActiveConfig(e){return this.set("active_config",e)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(e){return this.set("active_config_etag",e)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(e){return this.set("throttle_metadata",e)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}getCustomSignals(){return this.get("custom_signals")}},uc=class extends Ni{constructor(e,t,s,r=$I()){super(),this.appId=e,this.appName=t,this.namespace=s,this.openDbPromise=r}setCustomSignals(e){return D(this,null,function*(){let s=(yield this.openDbPromise).transaction([tn],"readwrite"),r=yield this.getWithTransaction("custom_signals",s),o=Um(e,r||{});return yield this.setWithTransaction("custom_signals",o,s),o})}getWithTransaction(e,t){return D(this,null,function*(){return new Promise((s,r)=>{let o=t.objectStore(tn),a=this.createCompositeKey(e);try{let l=o.get(a);l.onerror=h=>{r(Pi(h,"storage-get"))},l.onsuccess=h=>{let d=h.target.result;s(d?d.value:void 0)}}catch(l){r(He.create("storage-get",{originalErrorMessage:l?.message}))}})})}setWithTransaction(e,t,s){return D(this,null,function*(){return new Promise((r,o)=>{let a=s.objectStore(tn),l=this.createCompositeKey(e);try{let h=a.put({compositeKey:l,value:t});h.onerror=d=>{o(Pi(d,"storage-set"))},h.onsuccess=()=>{r()}}catch(h){o(He.create("storage-set",{originalErrorMessage:h?.message}))}})})}get(e){return D(this,null,function*(){let s=(yield this.openDbPromise).transaction([tn],"readonly");return this.getWithTransaction(e,s)})}set(e,t){return D(this,null,function*(){let r=(yield this.openDbPromise).transaction([tn],"readwrite");return this.setWithTransaction(e,t,r)})}delete(e){return D(this,null,function*(){let t=yield this.openDbPromise;return new Promise((s,r)=>{let a=t.transaction([tn],"readwrite").objectStore(tn),l=this.createCompositeKey(e);try{let h=a.delete(l);h.onerror=d=>{r(Pi(d,"storage-delete"))},h.onsuccess=()=>{s()}}catch(h){r(He.create("storage-delete",{originalErrorMessage:h?.message}))}})})}createCompositeKey(e){return[this.appId,this.appName,this.namespace,e].join()}},hc=class extends Ni{constructor(){super(...arguments),this.storage={}}get(e){return D(this,null,function*(){return Promise.resolve(this.storage[e])})}set(e,t){return D(this,null,function*(){return this.storage[e]=t,Promise.resolve(void 0)})}delete(e){return D(this,null,function*(){return this.storage[e]=void 0,Promise.resolve()})}setCustomSignals(e){return D(this,null,function*(){let t=this.storage.custom_signals||{};return this.storage.custom_signals=Um(e,t),Promise.resolve(this.storage.custom_signals)})}};function Um(n,e){let t=Object.assign(Object.assign({},e),n),s=Object.fromEntries(Object.entries(t).filter(([r,o])=>o!==null).map(([r,o])=>typeof o=="number"?[r,o.toString()]:[r,o]));if(Object.keys(s).length>Mm)throw He.create("custom-signal-max-allowed-signals",{maxSignals:Mm});return s}var dc=class{constructor(e){this.storage=e}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}getCustomSignals(){return this.customSignals}loadFromStorage(){return D(this,null,function*(){let e=this.storage.getLastFetchStatus(),t=this.storage.getLastSuccessfulFetchTimestampMillis(),s=this.storage.getActiveConfig(),r=this.storage.getCustomSignals(),o=yield e;o&&(this.lastFetchStatus=o);let a=yield t;a&&(this.lastSuccessfulFetchTimestampMillis=a);let l=yield s;l&&(this.activeConfig=l);let h=yield r;h&&(this.customSignals=h)})}setLastFetchStatus(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}setLastSuccessfulFetchTimestampMillis(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}setActiveConfig(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}setCustomSignals(e){return D(this,null,function*(){this.customSignals=yield this.storage.setCustomSignals(e)})}};function jI(){ve(new ye(Fm,n,"PUBLIC").setMultipleInstances(!0)),V(ic,Om),V(ic,Om,"esm2017");function n(e,{options:t}){let s=e.getProvider("app").getImmediate(),r=e.getProvider("installations-internal").getImmediate(),{projectId:o,apiKey:a,appId:l}=s.options;if(!o)throw He.create("registration-project-id");if(!a)throw He.create("registration-api-key");if(!l)throw He.create("registration-app-id");let h=t?.templateId||"firebase",d=Gt()?new uc(l,s.name,h):new hc,m=new dc(d),g=new _t(ic);g.logLevel=Wt.ERROR;let T=new ac(r,Ht,h,o,a,l),C=new lc(T,d),A=new oc(C,d,m,g),R=new cc(s,A,m,d,g);return Lm(R),R}}jI();var fr=class{constructor(e){return e}},Bm="remote-config",fc=class{constructor(){return Ee(Bm)}};var pc=new me("angularfire2.remote-config-instances");function zI(n,e,t){if(Fn(t))return null;let s=we(Bm,n,e);return s&&new fr(s)}function GI(n){return(e,t,s)=>{if(Fn(s))return null;let r=e.runOutsideAngular(()=>n(t));return new fr(r)}}var KI={provide:fc,deps:[[new $,pc]]},WI={provide:fr,useFactory:zI,deps:[[new $,pc],Ie,nt]};function qm(n,...e){return V("angularfire",fe.full,"rc"),ge([WI,KI,{provide:pc,useFactory:GI(n),multi:!0,deps:[re,ue,nt,Te,Se,...e]}])}var $m=he(Vm,!0);var jm="@firebase/vertexai",zm="1.2.0";var Gm="vertexAI",Km="us-central1";var cP=180*1e3;var mc=class{constructor(e,t,s,r){var o;this.app=e,this.options=r;let a=s?.getImmediate({optional:!0}),l=t?.getImmediate({optional:!0});this.auth=l||null,this.appCheck=a||null,this.location=((o=this.options)===null||o===void 0?void 0:o.location)||Km}_delete(){return Promise.resolve()}};var uP=new _t("@firebase/vertexai");var gc=function(n){return n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n}(gc||{});var hP=[gc.RECITATION,gc.SAFETY];function Wm(n=Fe(),e){return n=de(n),Re(n,Gm).getImmediate({identifier:e?.location||Km})}function HI(){ve(new ye(Gm,(n,{instanceIdentifier:e})=>{let t=n.getProvider("app").getImmediate(),s=n.getProvider("auth-internal"),r=n.getProvider("app-check-internal");return new mc(t,s,r,{location:e})},"PUBLIC").setMultipleInstances(!0)),V(jm,zm),V(jm,zm,"esm2017")}HI();var pr=class{constructor(e){return e}},Hm="vertexai",_c=class{constructor(){return Ee(Hm)}};var yc=new me("angularfire2.vertexai-instances");function QI(n,e){let t=we(Hm,n,e);return t&&new pr(t)}function YI(n){return(e,t)=>{let s=e.runOutsideAngular(()=>n(t));return new pr(s)}}var XI={provide:_c,deps:[[new $,yc]]},JI={provide:pr,useFactory:QI,deps:[[new $,yc],Ie]};function Qm(n,...e){return V("angularfire",fe.full,"vertexai"),ge([JI,XI,{provide:yc,useFactory:YI(n),multi:!0,deps:[re,ue,Te,Se,[new $,yt],...e]}])}var Ym=he(Wm,!0);var ZI={projectId:"graduation-project-704b9",appId:"1:159614579205:web:c0dfd56cf057d7635ce26c",storageBucket:"graduation-project-704b9.appspot.com",apiKey:"AIzaSyCJhh6RhbGA52js5L1blEEU0EF_pTy1-JU",authDomain:"graduation-project-704b9.firebaseapp.com",messagingSenderId:"159614579205",measurementId:"G-K9DF60BE90"},Xm={providers:[ku({eventCoalescing:!0}),zu(gh),Gh(),nh(()=>rh(ZI)),ch(()=>hh()),hd(()=>ld()),ef(()=>tf()),Kp(()=>Wp()),em(()=>tm()),gm(()=>_m()),vm(()=>wm()),Dm(()=>xm()),qm(()=>$m()),Qm(()=>Ym()),oh(()=>{let n=new ih("your-site-key");return ah(sh(),{provider:n,isTokenAutoRefreshEnabled:!0})}),ud,sa]};Vu(Mr,Xm).catch(n=>console.error(n));
